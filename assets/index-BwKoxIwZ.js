import{r as A,j as o,R as rn,C as an,s as ln,p as I,i as et,a as Be,c as Z,b as D,d as re,T as U,F as le,m as pt,e as Qe,f as Pe,t as nt,g as Se,h as rt,k as ws,l as Dt,n as Tt,o as As,q as fe,u as cn,S as dn,v as bs,w as Ds,x as Ts,y as js,z as mn,A as un,B as hn,D as pn,E as Jt,G as Le,H as gn,I as Ps,J as B,K as fn,L as xn,M as Ns,N as yn,O as M,P as Cs,Q as Rn,U as Is,V as _s,W as En,X as Os,Y as Sn,Z as ks,_ as Ls,$ as vn,a0 as wn,a1 as Ms,a2 as An,a3 as bn,a4 as Dn,a5 as $s,a6 as gt,a7 as Tn,a8 as Fs,a9 as Us,aa as jn,ab as Pn,ac as Nn,ad as Gs,ae as Cn,af as jt,ag as In,ah as Vs,ai as Bs,aj as _n,ak as On,al as Zt,am as Pt,an as kn,ao as Ln,ap as Mn,aq as es,ar as it,as as dt,at as ts,au as $n,av as Fn,aw as Un,ax as Gn,ay as Vn,az as qs,aA as Bn,aB as Nt,aC as qn,aD as Kn,aE as Ks,aF as zn,aG as zs,aH as Hn,aI as Wn,aJ as ss,aK as os,aL as Yn,aM as Qn,aN as ns,aO as Hs,aP as Xn,aQ as rs,aR as Jn,aS as Zn,aT as er,aU as tr,aV as sr,aW as or}from"./vendor-DTPPfmPH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();const Ws=A.createContext({}),nr=({children:e})=>{const[t,s]=A.useState(!0),r={showNumbers:t,toggleShowNumbers:()=>s(!t)};return o.jsx(Ws.Provider,{value:r,children:e})},tt=()=>A.useContext(Ws),Ys=A.createContext({}),rr=({children:e})=>{const[t,s]=A.useState(!0),r={showNames:t,toggleShowNames:()=>s(!t)};return o.jsx(Ys.Provider,{value:r,children:e})},ve=()=>A.useContext(Ys),Qs=A.createContext({}),ar=({children:e})=>{const[t,s]=A.useState(!1),[n,r]=A.useState(""),d={showPvP:t,togglePvPPage:()=>{s(!t),r("")},userPage:n,setUserPage:(i="")=>{s(!1),r(i)},clearUserPage:()=>{s(!1),r("")}};return o.jsx(Qs.Provider,{value:d,children:e})},qe=()=>A.useContext(Qs),lr={theme:"dark",toggleTheme:()=>null},Xs=A.createContext(lr),cr=({children:e,defaultTheme:t="dark",storageKey:s="vite-ui-theme",...n})=>{const[r,a]=A.useState(()=>localStorage.getItem(s)||t);A.useEffect(()=>{const c=window.document.documentElement;c.classList.remove("light","dark"),c.classList.add(r)},[r]);const l={theme:r,toggleTheme:()=>{const c=r==="dark"?"light":"dark";localStorage.setItem(s,c),a(c)}};return o.jsx(Xs.Provider,{...n,value:l,children:e})},q=()=>{const e=A.useContext(Xs);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},ir=rn,dr=an,as=({setIsOpen:e,isOpen:t,expandText:s,qaId:n,className:r})=>o.jsx("a",{className:`text-base text-primary ${r}`,href:"#desc",...n&&{"data-qa-id":n},onClick:a=>{a.preventDefault(),e(!t)},children:t?"hide":s}),de=({title:e,intro:t,children:s,expandText:n="info",className:r="",expandQaId:a})=>{const[l,c]=A.useState(!1);return o.jsxs("div",{className:`w-full flex flex-grow flex-wrap ${r} ${t?"[&>*]:basis-full":""}`,children:[e&&typeof e=="string"?o.jsxs("h3",{children:[e,s&&o.jsx(as,{isOpen:l,setIsOpen:c,expandText:n,qaId:a,className:"ml-2"})]}):e,o.jsxs("p",{children:[t," ",t&&s&&o.jsx(as,{isOpen:l,setIsOpen:c,expandText:n,qaId:a})]}),o.jsx(ir,{open:l,onOpenChange:c,className:"wrapper basis-full",children:o.jsx(dr,{children:s})})]})},Y=({className:e="",children:t})=>o.jsx("div",{className:`paper ${e}`,children:t}),R={SET_TEAM_NAME:"SET_TEAM_NAME",CLEAR_TEAM_NAME:"CLEAR_TEAM_NAME",STORE_ORG:"STORE_ORG",CLEAR_ORG:"CLEAR_ORG",STORE_TOKEN:"STORE_TOKEN",STORE_FORM_UNTIL_DATE:"STORE_FORM_UNTIL_DATE",CLEAR_FORM_UNTIL_DATE:"CLEAR_FORM_UNTIL_DATE",STORE_UNTIL_DATE:"STORE_UNTIL_DATE",CLEAR_UNTIL_DATE:"CLEAR_UNTIL_DATE",SET_PR_PAGINATION:"SET_PR_PAGINATION",CLEAR_PR_PAGINATION:"CLEAR_PR_PAGINATION",SET_PR_REVIEWED_PAGINATION:"SET_PR_REVIEWED_PAGINATION",CLEAR_PR_REVIEWED_PAGINATION:"CLEAR_PR_REVIEWED_PAGINATION",SET_RELEASES_PAGINATION:"SET_RELEASES_PAGINATION",CLEAR_RELEASES_PAGINATION:"CLEAR_RELEASES_PAGINATION",SET_ISSUES_PAGINATION:"SET_ISSUES_PAGINATION",CLEAR_ISSUES_PAGINATION:"CLEAR_ISSUES_PAGINATION",SET_DESC:"SET_DESC",CLEAR_DESC:"CLEAR_DESC",FETCH_STATUS:"FETCH_STATUS",FETCH_START:"FETCH_START",PRE_FETCH_ERROR:"PRE_FETCH_ERROR",CLEAR_PRE_FETCH_ERROR:"CLEAR_PRE_FETCH_ERROR",FETCH_ERROR:"FETCH_ERROR",CLEAR_FETCH_ERROR:"CLEAR_FETCH_ERROR",FETCH_END:"FETCH_END",STORE_REPOS:"STORE_REPOS",STORE_REPO:"STORE_REPO",CLEAR_REPO:"CLEAR_REPO",STORE_AMOUNT:"STORE_AMOUNT",STORE_SORT:"STORE_SORT",STORE_ENT_URL:"STORE_ENT_URL",STORE_EX_IDS:"STORE_EX_IDS",CLEAR_EX_IDS:"CLEAR_EX_IDS",STORE_EVENTS:"STORE_EVENTS",CLEAR_EVENTS:"CLEAR_EVENTS",STORE_USERS_INFO:"STORE_USERS_INFO",CLEAR_USERS_INFO:"CLEAR_USERS_INFO",STORE_USER_IDS:"STORE_USER_IDS",CLEAR_USER_IDS:"CLEAR_USER_IDS",ADD_ITEMS_DATE_RANGE:"ADD_ITEMS_DATE_RANGE",CLEAR_ITEMS_DATE_RANGE:"CLEAR_ITEMS_DATE_RANGE",ADD_TRIMMED_ITEMS:"ADD_TRIMMED_ITEMS",CLEAR_TRIMMED_ITEMS:"CLEAR_TRIMMED_ITEMS",ADD_PRS:"ADD_PRS",ADD_FILTERED_PRS:"ADD_FILTERED_PRS",CLEAR_PRS:"CLEAR_PRS",CLEAR_FILTERED_PRS:"CLEAR_FILTERED_PRS",ADD_REVIEWED_PRS:"ADD_REVIEWED_PRS",ADD_REVIEWED_FILTERED_PRS:"ADD_REVIEWED_FILTERED_PRS",CLEAR_REVIEWED_PRS:"CLEAR_REVIEWED_PRS",CLEAR_REVIEWED_FILTERED_PRS:"CLEAR_REVIEWED_FILTERED_PRS",ADD_ISSUES:"ADD_ISSUES",ADD_FILTERED_ISSUES:"ADD_FILTERED_ISSUES",CLEAR_FILTERED_ISSUES:"CLEAR_FILTERED_ISSUES",CLEAR_ISSUES:"CLEAR_ISSUES",ADD_RELEASES:"ADD_RELEASES",CLEAR_RELEASES:"CLEAR_RELEASES",ADD_FILTERED_RELEASES:"ADD_FILTERED_RELEASES",CLEAR_FILTERED_RELEASES:"CLEAR_FILTERED_RELEASES",PREFETCHED_NAME:"PREFETCHED_NAME",CLEAR_PREFETCHED_NAME:"CLEAR_PREFETCHED_NAME",ADD_USERS_DATA:"ADD_USERS_DATA",CLEAR_USERS_DATA:"CLEAR_USERS_DATA"},Js=(e,t,s=[])=>new Promise((n,r)=>{const[a,...l]=e;Promise.all(a.map(c=>t(c))).then(c=>l&&l.length?Js(l,t,c).then(d=>n(s.concat(d))).catch(r):n(s.concat(c))).catch(r)}),Xe=(e=[],t,s=2)=>{const n=ln(s,e);return e.length?Js(n,t):[]},Gt=(e,t="DESC",s="")=>n=>{const r=I("",e,n),a=r&&new Date(r),l=s?new Date(s):new Date;return t==="DESC"?a&&et(a,l):a&&Be(a,l)},ft=e=>e?` after:"${e}" `:"",Vt=(e,{oldest:t,newest:s})=>{const n=e==="DESC"?t:s,a=n?` ${e==="DESC"?"after":"before"}:"${n}" `:"",l=a?100:10;return`
    ${e==="DESC"?`last: ${l}`:`first: ${l}`}
    ${a}
  `},Bt=e=>({oldest:t,newest:s})=>ft(e==="DESC"?t:s),xe="pageInfo { endCursor hasNextPage hasPreviousPage startCursor }",Ge=e=>`
    comments(first: ${e?100:10} ${ft(e)}) {
      totalCount
      edges {
        node {
          author {
            login
            url
          }
          publishedAt
          body
        }
      }
      ${xe}
    }
`,Zs=e=>t=>`
pullRequests(
  first: 50
  ${Bt(e)(t)}
  states: [MERGED]
  orderBy: {field: CREATED_AT direction: ${e}}
) {
  totalCount
  edges {
    node {
      id
      url
      author {
        login
        url
      }
      repository {
        name
        owner {
          login
        }
      }
      additions
      deletions
      mergedAt
      createdAt
      commits(first:1) {
        edges {
          node {
            commit {
              committedDate
            }
          }
        }
      }
      ${to(void 0)}
      ${Ge(void 0)}
    }
  }
  ${xe}
}`,eo=e=>t=>`
issues(
  ${Bt(e)(t)}
  first: 50
  orderBy: { field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      title
      url
      createdAt
      closedAt
      state
      labels(first:5) {
        edges {
          node {
            name
          }
        }
      }
    }
  }
  ${xe}
}`,mr=e=>t=>`
releases(
  ${Bt(e)(t)}
  first: 50
  orderBy:{ field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      id
      name
      createdAt
      tag {
        name
      }
    }
  }
  ${xe}
}`,to=e=>`
    reviews(first: ${e?100:10} ${ft(e)}) {
      edges {
        node {
          id
          state
          author {
            login
            url
          }
          ${Ge(void 0)}
        }
      }
      ${xe}
    }
`,so=(e={},t="",s={},n)=>r=>{const{hasNextPage:a=!1,startCursor:l,endCursor:c}=I({},["data","result",r,"pageInfo"],s),d=I([],["data","result",r,"edges"],s),i=r==="pullRequests"?"mergedAt":"createdAt",m=re(t)?d.filter(Gt(["node",i],n,t)):[],u={pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"},h=I(n==="DESC"?c:l,[u[r],"oldest"],e),x=I(n==="ASC"?c:l,[u[r],"newest"],e),y=m.length,f=Z([[D(a===!1),le],[D(!re(t)),D(a)],[D(y===0),le],[D(y>0&&d.length>y),le],[U,D(a)]])();return{newest:n==="ASC"&&c?c:x,oldest:n==="DESC"&&c?c:h,hasNextPage:a,hasNextPageForDate:f}},ur=(e={},t="",s={},n)=>r=>{const a=r==="usersReviews"?["data","result"]:["data","result",r],{hasNextPage:l=!1,hasPreviousPage:c=!1,startCursor:d,endCursor:i}=I({},[...a,"pageInfo"],s),m=I([],[...a,"edges"],s),u=["pullRequests","usersReviews"].includes(r)?"mergedAt":"createdAt",p=re(t)?m.filter(Gt(["node",u],n,t)):[],h={commitComments:"commitCommentsPagination",issueComments:"issueCommentsPagination",usersReviews:"usersReviewsPagination"},g=r==="usersReviews"||n==="ASC"?"right":"left",y=I(g==="right"?i:d,[h[r],"oldest"],e),S=I(g==="right"?d:i,[h[r],"newest"],e),w=g==="right"?l:c,E=p.length,v=Z([[D(w===!1),le],[D(!re(t)),D(w)],[D(E===0),le],[D(E>0&&m.length>E),le],[U,D(w)]])();return{newest:g==="right"&&i?i:S,oldest:g==="left"&&d?d:y,hasNextPage:w,hasNextPageForDate:v}},hr=(e={},t="",s={},n)=>{const{hasNextPage:r=!1,hasPreviousPage:a=!1,startCursor:l,endCursor:c}=I({},["data","result","pageInfo"],s),d=I([],["data","result","edges"],s),i=re(t)?d.filter(Gt(["node","mergedAt"],n,t)):[],u=I(n==="DESC"?c:l,["usersReviewsPagination","oldest"],e),h=I(n==="DESC"?l:c,["usersReviewsPagination","newest"],e),g=n==="DESC"?r:a,x=i.length,y=Z([[D(g===!1),le],[D(!re(t)),D(g)],[D(x===0),le],[U,D(g)]])();return{newest:n==="ASC"&&l?l:h,oldest:n==="DESC"&&c?c:u,hasNextPage:g,hasNextPageForDate:y}},qt=e=>{const t=["issues","pullRequests","releases"],[s]=t.map(n=>{var r,a,l;return((l=(a=(r=e==null?void 0:e.data)==null?void 0:r.result)==null?void 0:a[n])==null?void 0:l.totalCount)||0}).sort((n,r)=>r-n);return Math.ceil(s/50)-1},pr=e=>t=>`
    commitComments(
      ${Vt(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          commit {
            repository {
              nameWithOwner
            }
            url
            associatedPullRequests(last: 10) {
              edges {
                node {
                  number
                  url
                }
              }
            }
          }
          body
        }
      }
      ${xe}
    }
`,gr=e=>t=>`
    issueComments(
      ${Vt(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          url
          repository {
            nameWithOwner
          }
          issue {
            number
          }
          pullRequest {
            number
          }
          body
        }
      }
      ${xe}
    }
`,fr=e=>({user:t,sortDirection:s="DESC",amountOfData:n,usersReviewsPagination:r={}})=>({query:`{
    result: search(
      query: "type:pr state:closed reviewed-by:${t}"
      type: ISSUE
      ${Vt(s,r)}
    ) {
      issueCount
      ${xe}
      edges {
        node {
          ... on PullRequest {
            id
            number
            url
            author {
              login
              url
            }
            repository {
              name
              owner {
                login
              }
            }
            additions
            deletions
            mergedAt
            createdAt
            ${Ge(void 0)}
            reviews(last: 10 states: [COMMENTED,APPROVED,CHANGES_REQUESTED] author: "${t}") {
              ${xe}
              edges {
                node {
                  id
                  state
                  author {
                    login
                    url
                  }
                  ${Ge(void 0)}
                }
              }
            }
          }
        }
      }
    }
  }`,sortDirection:s,user:t,resultInfo:a=>{const l=hr({usersReviewsPagination:r,amountOfData:n},e,a,s),c=Z([[D(n==="all"),D(n)],[D(re(e)),D(n)],[D(Number.isInteger(n)),D(n-1)],[U,qt]])(a),d={usersReviewsPagination:Object.assign(l,{hasNextPage:!1})},i=re(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:d.usersReviewsPagination[i]===!0,nextPageInfo:{...d,amountOfData:c}}},fillerType:"pullRequests",hasMoreResults:[r.hasNextPage].some(a=>a!==!1)}),Me=e=>{const{hasNextPageForDate:t}=e;return t!==!1},oo=e=>({user:t,sortDirection:s="DESC",amountOfData:n,issuesPagination:r={},prPagination:a={},commitCommentsPagination:l={},issueCommentsPagination:c={}})=>({query:`{
    result: user(login: "${t}") {
      login
      ${Me(c)?gr(s)(c):""}
      ${Me(l)?pr(s)(l):""}
      ${Me(a)?Zs(s)(a):""}
      ${r[e?"hasNextPageForDate":"hasNextPage"]!==!1?eo(s)(r):""}
    }
  }`,sortDirection:s,user:t,resultInfo:d=>{const i=so({issuesPagination:r,prPagination:a,amountOfData:n},e,d,s),m=ur({commitCommentsPagination:l,issueCommentsPagination:c,amountOfData:n},e,d,s),u=Z([[D(n==="all"),D(n)],[D(re(e)),D(n)],[D(Number.isInteger(n)),D(n-1)],[U,qt]])(d);Object.assign(i("pullRequests"),{hasNextPage:!1});const p={prPagination:Object.assign(i("pullRequests"),{hasNextPage:!1}),issuesPagination:Object.assign(i("issues"),{hasNextPage:!1}),commitCommentsPagination:Object.assign(m("commitComments"),{hasNextPage:!1}),issueCommentsPagination:Object.assign(m("issueComments"),{hasNextPage:!1})},h=re(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(p).some(x=>x[h]===!0),nextPageInfo:{...p,amountOfData:u}}},hasMoreResults:[a.hasNextPage,r.hasNextPage,l.hasNextPage,c.hasNextPage].some(d=>d!==!1)}),no=e=>({org:t,repo:s,sortDirection:n="DESC",amountOfData:r,issuesPagination:a={},releasesPagination:l={},prPagination:c={}})=>({query:`{
      result: repository(name: "${s}" owner: "${t}") {
        id
        description
        name
        owner {
          org: login
        }
        ${Me(c)?Zs(n)(c):""}
        ${Me(a)?eo(n)(a):""}
        ${Me(l)?mr(n)(l):""}
      }
    }`,sortDirection:n,resultInfo:d=>{const i=so({issuesPagination:a,releasesPagination:l,prPagination:c},e,d,n),m=Z([[D(r==="all"),D(r)],[D(re(e)),D(r)],[D(Number.isInteger(r)),D(r-1)],[U,qt]])(d),u={prPagination:Object.assign({hasNextPage:!1},i("pullRequests")),issuesPagination:Object.assign({hasNextPage:!1},i("issues")),releasesPagination:Object.assign({hasNextPage:!1},i("releases"))},p=re(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(u).some(g=>g[p]===!0),nextPageInfo:{...u,amountOfData:m}}},fillerType:"batchedQuery",hasMoreResults:[c.hasNextPage,a.hasNextPage,l.hasNextPage].some(d=>d!==!1)}),xr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var n,r,a,l,c,d,i,m,u,p,h,g,x;return{rawData:s,results:((a=(r=(n=s==null?void 0:s.data)==null?void 0:n.node)==null?void 0:r.comments)==null?void 0:a.edges)||[],hasNextPage:((i=(d=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:d.pageInfo)==null?void 0:i.hasNextPage)||!1,nextArgs:{nodeId:((u=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:u.id)||"",cursor:((x=(g=(h=(p=s==null?void 0:s.data)==null?void 0:p.node)==null?void 0:h.comments)==null?void 0:g.pageInfo)==null?void 0:x.endCursor)||""}}},fillerType:""}),yr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${to(t)}
          }
        }
    }`,resultInfo:s=>{var n,r,a,l,c,d,i,m,u,p,h,g,x;return{rawData:s,results:((a=(r=(n=s==null?void 0:s.data)==null?void 0:n.node)==null?void 0:r.reviews)==null?void 0:a.edges)||[],hasNextPage:((i=(d=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.reviews)==null?void 0:d.pageInfo)==null?void 0:i.hasNextPage)||!1,nextArgs:{nodeId:((u=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:u.id)||"",cursor:((x=(g=(h=(p=s==null?void 0:s.data)==null?void 0:p.node)==null?void 0:h.reviews)==null?void 0:g.pageInfo)==null?void 0:x.endCursor)||""}}},fillerType:"pullRequestReviewComments"}),Rr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequestReview {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var n,r,a,l,c,d,i,m,u,p,h,g,x;return{rawData:s,results:((a=(r=(n=s==null?void 0:s.data)==null?void 0:n.node)==null?void 0:r.comments)==null?void 0:a.edges)||[],hasNextPage:((i=(d=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:d.pageInfo)==null?void 0:i.hasNextPage)||!1,nextArgs:{nodeId:((u=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:u.id)||"",cursor:((x=(g=(h=(p=s==null?void 0:s.data)==null?void 0:p.node)==null?void 0:h.comments)==null?void 0:g.pageInfo)==null?void 0:x.endCursor)||""}}},fillerType:""}),Er=({org:e,orgPagination:t={}})=>({query:`{
    organization(login: "${e}") {
      repositories(
        first:100
        ${ft(t==null?void 0:t.cursor)}
        orderBy: {field: NAME, direction: ASC}
      ) {
        edges {
          node {
            name
          }
          cursor
        }
        pageInfo {
          endCursor
          hasNextPage
        }
      }
    }
  }`,fillerType:"org",resultInfo:s=>{var a,l,c,d,i,m,u,p,h,g,x,y,f,S,w;const n=((d=(c=(l=(a=s==null?void 0:s.data)==null?void 0:a.organization)==null?void 0:l.repositories)==null?void 0:c.pageInfo)==null?void 0:d.hasNextPage)||!1,r=((p=(u=(m=(i=s==null?void 0:s.data)==null?void 0:i.organization)==null?void 0:m.repositories)==null?void 0:u.pageInfo)==null?void 0:p.endCursor)||"";return{rawData:s,results:((x=(g=(h=s==null?void 0:s.data)==null?void 0:h.organization)==null?void 0:g.repositories)==null?void 0:x.edges)||[],hasNextPage:((w=(S=(f=(y=s==null?void 0:s.data)==null?void 0:y.organization)==null?void 0:f.repositories)==null?void 0:S.pageInfo)==null?void 0:w.hasNextPage)||!1,nextPageInfo:{orgPagination:{cursor:r,hasNextPage:n,hasNextPageForDate:n},amountOfData:"all"}}}}),Sr=({org:e,team:t})=>({query:`{
    organization(login: "${e}") {
      team(slug:"${t}") {
        members(
          first:100
        ) {
          edges {
            node {
              name
              email
              login
              createdAt
            }
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
    }
  }`,fillerType:"team",resultInfo:s=>{var n,r,a,l,c;return{results:((c=(l=(a=(r=(n=s[0])==null?void 0:n.data)==null?void 0:r.organization)==null?void 0:a.team)==null?void 0:l.members)==null?void 0:c.edges)||[],hasNextPage:!1}}}),vr=(e,t)=>{const n={org:["data","organization","repositories","edges"],team:["data","organization","team","members","edges"]}[e];return n?I([],n,t):t},wr=e=>{const t=i=>{const u={pullRequests:[d,l],pullRequestReviewComments:[a],batchedQuery:[d,l]}[i]||[];return p=>u.length?Promise.all(u.map(h=>h(p))).then(h=>h.reduce((g,x)=>x(g),p)):vr(i,p)},s=i=>m=>async(u=[])=>{const{hasNextPage:p}=m,{query:h,resultInfo:g,fillerType:x}=i(m),y=p?await e(h):{},{results:f=[],hasNextPage:S,nextArgs:w}=g(y),E=[...u,...f];return S&&x?s(i)(w)(E):await t(x)(E)},n=i=>m=>u=>{const p=Object.assign(i.node,{[m]:u});return Object.assign(i,{node:p})},r=i=>m=>{var u,p,h,g,x,y,f;return{nodeId:((u=m==null?void 0:m.node)==null?void 0:u.id)||"",cursor:((g=(h=(p=m==null?void 0:m.node)==null?void 0:p[i])==null?void 0:h.pageInfo)==null?void 0:g.endCursor)||"",hasNextPage:((f=(y=(x=m==null?void 0:m.node)==null?void 0:x[i])==null?void 0:y.pageInfo)==null?void 0:f.hasNextPage)||!1}},a=async(i=[])=>{const u=await Xe(i,async p=>{var y,f;const h=((f=(y=p==null?void 0:p.node)==null?void 0:y.comments)==null?void 0:f.edges)||[],g=r("comments")(p),x=await s(Rr)(g)(h);return n(p)("comments")({edges:x})},5);return()=>u},l=async i=>{var h,g,x;const m=((x=(g=(h=i==null?void 0:i.data)==null?void 0:h.result)==null?void 0:g.pullRequests)==null?void 0:x.edges)||[],p=await Xe(m,async y=>{var E,v,b;const f=((v=(E=y==null?void 0:y.node)==null?void 0:E.reviews)==null?void 0:v.edges)||[],S=r("reviews")(y),w=await s(yr)(S)(f);return{nodeId:(b=y==null?void 0:y.node)==null?void 0:b.id,results:{edges:w}}},5);return y=>{const f=c(y)("reviews")(p);return{data:Object.assign((y==null?void 0:y.data)||{},{result:Object.assign(I({pullRequests:f},["data","result"],y))})}}},c=i=>m=>u=>{var x,y,f,S,w;const p=((y=(x=i==null?void 0:i.data)==null?void 0:x.result)==null?void 0:y.pullRequests)||{},g=(((w=(S=(f=i==null?void 0:i.data)==null?void 0:f.result)==null?void 0:S.pullRequests)==null?void 0:w.edges)||[]).map(E=>{var T;const v=((T=E==null?void 0:E.node)==null?void 0:T.id)||"",b=u.find(j=>j.nodeId===v);return b?n(E)(m)(b.results):E});return Object.assign(p,{edges:g})},d=async i=>{var h,g,x;const m=((x=(g=(h=i==null?void 0:i.data)==null?void 0:h.result)==null?void 0:g.pullRequests)==null?void 0:x.edges)||[],p=await Xe(m,async y=>{var E,v,b;const f=((v=(E=y==null?void 0:y.node)==null?void 0:E.comments)==null?void 0:v.edges)||[],S=r("comments")(y),w=await s(xr)(S)(f);return{nodeId:((b=y==null?void 0:y.node)==null?void 0:b.id)||"",results:{edges:w}}},5);return y=>{var S;const f=c(y)("comments")(p);return{data:Object.assign((y==null?void 0:y.data)||{},{result:Object.assign(((S=y==null?void 0:y.data)==null?void 0:S.result)||{pullRequests:f})})}}};return t},Ct=e=>(t=[])=>t.reduce((s,n)=>(n[e]||0)+s,0),Ar=e=>t=>e.reduce((s,n)=>s+(t&&t[n]||0),0),we=(e=[])=>(t,s)=>{const n=Ar(e),r=n(t);return n(s)-r},br=e=>(t,s)=>e==="DESC"?new Date(s).getTime()-new Date(t).getTime():new Date(t).getTime()-new Date(s).getTime(),Dr=e=>new Promise((t,s)=>{e.json().then(n=>e.status===200?t(n):s(Object.assign(n,{status:e.status}))).catch(n=>{console.log("-=-=--parseJSON error",n),n.status=e.status,s(n)})}),ls=({message:e=""})=>/(You have triggered an abuse detection mechanism|You have exceeded a secondary rate limit)/.test(e),Tr=({message:e=""})=>/Unexpected end of JSON input/.test(e),jr=e=>t=>fetch(e.enterpriseAPI||"https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({query:t})}).then(Dr),Pr=(e,{amountOfData:t})=>Z([[D(e===!1),le],[D(e&&Number.isInteger(t)&&t>=1),U],[D(e&&t==="all"),U],[U,le]])(),Nr=(e=3e4)=>new Promise(t=>setTimeout(()=>t(),e));let cs=0;const Cr=async(e,t)=>(console.log("-=-=--paused",Date.now()),await Nr(),console.log("-=-=--resume",Date.now()),++cs,cs<=10?ye(e,t):{errorMessage:{level:"error",message:"Hit rate limit over ten times"},fetchInfo:e.fetchInfo,results:t,reviewResults:[]}),vt=(e,t)=>t.reduce((n,r)=>{var l,c,d;const a=((d=(c=(l=r==null?void 0:r.data)==null?void 0:l.result)==null?void 0:c[e])==null?void 0:d.edges)||[];return n+a.length},0),Ir=e=>(t,s=[])=>{var i,m,u,p;const r=I(!1,[{pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"}[t],"hasNextPageForDate"],e),a=s[s.length-1]||{},l=((u=(m=(i=a==null?void 0:a.data)==null?void 0:i.result)==null?void 0:m[t])==null?void 0:u.edges)||[],c=l[l.length-1],d=t==="pullRequests"?"createdAt":"closedAt";return r&&((p=c==null?void 0:c.node)==null?void 0:p[d])||""},ye=async({fetchInfo:e,queryInfo:t,dispatch:s=()=>{}},n=[])=>{const{query:r,resultInfo:a,fillerType:l,user:c,sortDirection:d}=t(e),i=Ir(e),[m]=[i("pullRequests",n),i("issues",n),i("releases",n)].filter(Boolean).sort((p,h)=>br(d)(p,h));s({type:R.FETCH_STATUS,payload:{prCount:vt("pullRequests",n),issueCount:vt("issues",n),releasesCount:vt("releases",n),latestItemDate:m,user:c}});const u=jr(e);try{const p=await u(r);if(ls(p))throw new Error("Abuse rate triggered");const h=await wr(u)(l)(p),g=[...n,h],{hasNextPage:x,nextPageInfo:y={}}=a(p),f=pt(e,y);return Pr(x,f)?ye({fetchInfo:f,queryInfo:t,dispatch:s},g):{fetchInfo:f,results:g,reviewResults:[]}}catch(p){const h=p,g=Z([[ls,U],[Tr,U],[f=>f.status===500,U],[f=>f.status===502,U],[f=>f.message==="Abuse rate triggered",U],[Qe(nt(/ENOTFOUND|ECONNRESET/),Pe("","code")),U],[Qe(nt(/fetch/i),Pe("","message")),U],[U,le]]),y=Z([[g,D({level:"warn",message:"You may have triggered the api's abuse detection, please wait a minute before trying again"})],[Qe(nt(/50\d/i),Pe("","status")),D({level:"error",message:"GitHub API 500 error, could be CORS or rate limiting"})],[f=>f.status===401,D({level:"error",message:"GitHub token does not have correct settings, please see README"})],[Qe(nt(/40\d/i),Pe("","status")),f=>({level:"error",message:`Auth error: ${f.message||"UNKOWN"}`})],[f=>f.status===void 0,D({level:"error",message:"Error while processing data after, please check the console"})],[U,f=>({level:"error",message:`ERROR: ${f.message||"UNKOWN"}`})]])(h);if(g(h))return Cr({fetchInfo:e,queryInfo:t,dispatch:s},n);throw new Error(y.message)}},_r=async({fetchInfo:e,untilDate:t,dispatch:s})=>{try{const r=e.userIds.map(m=>({fetchInfo:{...e,issuesPagination:e.issuesPagination[m]||{hasNextPage:!0},prPagination:e.prPagination[m]||{hasNextPage:!0},user:m},queryInfo:oo(t),dispatch:s})),a=await Xe(r,ye,1),l={issuesPagination:{},prPagination:{}},c=[];return a.forEach(({fetchInfo:m,results:u})=>{c.push(u);const p=(m==null?void 0:m.user)||"";l.issuesPagination[p]=Se("issuesPagination",m),l.prPagination[p]=Se("prPagination",m)}),{fetchInfo:pt(e,l),results:c.flat(),reviewResults:[]}}catch(n){throw console.log("-=-=--getUsersData:error",n),n}},Or=async({fetchInfo:e,untilDate:t,dispatch:s})=>{var n;try{const[r]=e.userIds,a={fetchInfo:{...e,issuesPagination:e.issuesPagination[r]||{hasNextPage:!0},prPagination:e.prPagination[r]||{hasNextPage:!0},user:r},queryInfo:oo(t),dispatch:s},l=await ye(a),c=l.results,d={fetchInfo:{...e,usersReviewsPagination:((n=e.usersReviewsPagination)==null?void 0:n[r])||{hasNextPage:!0},user:r},queryInfo:fr(t),dispatch:s},i=await ye(d),m=i.results,u={issuesPagination:Se("issuesPagination",l.fetchInfo),prPagination:Se("prPagination",l.fetchInfo),usersReviewsPagination:Se("usersReviewsPagination",i.fetchInfo)};return{fetchInfo:pt(e,u),results:c.flat(),reviewResults:m.flat()}}catch(r){throw console.log("-=-=--getUserData:error",r),r}},kr=async({fetchInfo:e,untilDate:t,dispatch:s})=>{try{const n=await ye({fetchInfo:e,queryInfo:Er,dispatch:s}),a=((n==null?void 0:n.results.flat())||[]).filter(h=>{var g;return(g=h==null?void 0:h.node)==null?void 0:g.name}).map(h=>{var g;return(g=h==null?void 0:h.node)==null?void 0:g.name}),l=e.org,c=a.map(h=>({fetchInfo:{...e,issuesPagination:(e==null?void 0:e.issuesPagination[h])||{hasNextPage:!0},prPagination:(e==null?void 0:e.prPagination[h])||{hasNextPage:!0},org:l,repo:h},queryInfo:no(t),dispatch:s})),d=await Xe(c,ye,1),i={issuesPagination:{},releasesPagination:{},prPagination:{}},m=[];return d.forEach(({fetchInfo:h,results:g=[]})=>{m.push(g);const{repo:x,issuesPagination:y,releasesPagination:f,prPagination:S}=h;i.issuesPagination[x]=y,i.releasesPagination[x]=f,i.prPagination[x]=S}),{fetchInfo:pt(e,i),results:m.flat(),reviewResults:[]}}catch(n){throw console.log("-=-=--getOrgData:error",n),n}},Lr=(e,t=[])=>{var a;const s=e==="DESC"?0:-1,n=t.at(s),r=((a=n==null?void 0:n.node)==null?void 0:a.mergedAt)||(n==null?void 0:n.mergedAt);return new Date(r)},Mr=(e,t=[])=>{const{untilDate:s="",amountOfData:n=0,sortDirection:r="DESC"}=e,a={months:n},l=rt(ws(String),Se("amountOfData")),c=rt(u=>!(typeof u=="string"&&u.length>1),Se("untilDate")),d=rt(u=>Dt(u,a),u=>u?new Date(u):new Date,Se("untilDate")),i=rt(({prDate:u,sortDirection:p})=>p==="DESC"?Dt(u,a):Tt(u,a),u=>({prDate:Lr(u,t),sortDirection:u}),Pe("","sortDirection")),[,m]=[[l(e),""],[c(e)&&t.length>0,i(e)],[r==="DESC",d(e)],[r==="ASC",Tt(new Date(s),a)],[!0,""]].find(([u])=>u)||[];return m},$r=e=>t=>{const s={};return t.forEach(n=>{const r=cn(e,n);s[r]=(s[r]||0)+1}),s},ro=$r(["node","author","login"]),Fr=e=>{const t={};return e.forEach(({author:s="",score:n=0})=>{t[s]=(t[s]||0)+n}),t},is=(e=[])=>{const t=new dn,s=e.map(n=>{var l,c,d;const r=((l=n==null?void 0:n.node)==null?void 0:l.body)||"";return{author:((d=(c=n==null?void 0:n.node)==null?void 0:c.author)==null?void 0:d.login)||"",score:t.analyze(r).score}});return{sentimentScore:Ct("score")(s),sentiments:Fr(s)}},Ur=e=>{var n,r;const t=((r=(n=e==null?void 0:e.node)==null?void 0:n.reviews)==null?void 0:r.edges)||[],s=[];return t.forEach(a=>{var c,d;const l=((d=(c=a==null?void 0:a.node)==null?void 0:c.comments)==null?void 0:d.edges)||[];s.push(...l)}),s},ao=e=>t=>{var s,n;return e.includes((n=(s=t==null?void 0:t.node)==null?void 0:s.author)==null?void 0:n.login)},Gr=e=>t=>{var r,a;const s=!ao(e)(t);return!/\/apps\//.test(((a=(r=t==null?void 0:t.node)==null?void 0:r.author)==null?void 0:a.url)||"")&&s},wt=(e,t,s)=>{var g,x;const n=(x=(g=s==null?void 0:s.node)==null?void 0:g.author)==null?void 0:x.login,r=I([],["node","comments","edges"],s),a=Ur(s),c={general:r,code:a,all:[...a,...r]}[e]||[],d=c.filter(Gr([...t,n])),{sentimentScore:i=0,sentiments:m={}}=is(d),u=c.filter(ao([n])),{sentimentScore:p=0}=is(u),h=e==="all"?"c":`${e}C`;return{[`${h}omments`]:d.length,[`${h}ommenters`]:ro(d),[`${h}ommentSentimentScore`]:i,[`${h}ommentSentiments`]:m,[`${h}ommentsAuthor`]:u.length,[`${h}ommentAuthorSentimentScore`]:p,[`${h}ommentSentimentTotalScore`]:(p||0)+(i||0)}},Vr=(e,t)=>{const s=wt("general",e,t),n=wt("code",e,t),r=wt("all",e,t);return{...s,...n,...r}},Br=e=>{var r,a;const s=(((a=(r=e==null?void 0:e.node)==null?void 0:r.reviews)==null?void 0:a.edges)||[]).filter(l=>{var c;return((c=l==null?void 0:l.node)==null?void 0:c.state)==="APPROVED"}),n=ro(s);return{approvals:s.length,approvers:n}},qr=(e=[],t)=>{var f,S,w,E,v,b;const s=I("",["node","repository","owner","login"],t),n=I("",["node","repository","name"],t),r=I("",["node","author","login"],t),a=I("",["node","author","url"],t),l=I("",["node","url"],t),c=I(0,["node","additions"],t),d=I(0,["node","deletions"],t),i=I("",["node","createdAt"],t),m=I("",["node","mergedAt"],t),u=((b=(v=(E=(w=(S=(f=t==null?void 0:t.node)==null?void 0:f.commits)==null?void 0:S.edges)==null?void 0:w[0])==null?void 0:E.node)==null?void 0:v.commit)==null?void 0:b.committedDate)||"",p=Be(new Date(u),new Date(i))?u:i,h=Vr(e,t),{approvals:g,approvers:x}=Br(t);return{repo:n,org:s,author:/\/apps\//.test(a)?"GIT_APP_PR":r,url:l,additions:c,deletions:d,prSize:c+d,mergedAt:m,cycleTime:fe(new Date(m),new Date(p))||1,age:fe(new Date(m),new Date(i))||1,approvals:g,approvers:x,...h}},lo=(e,t)=>(s,n)=>{const r=s[e],a=n[e];return t==="DESC"?new Date(a).getTime()-new Date(r).getTime():new Date(r).getTime()-new Date(a).getTime()},ds=(e,t=[])=>{const{excludeIds:s=[]}=e;return t.map(r=>{var a,l,c,d,i;return((c=(l=(a=r==null?void 0:r.data)==null?void 0:a.result)==null?void 0:l.pullRequests)==null?void 0:c.edges)||((i=(d=r==null?void 0:r.data)==null?void 0:d.result)==null?void 0:i.edges)}).flat().map(r=>qr(s,r))},Kr=(e="")=>({startDate:t="",endDate:s=""}={})=>{const n=new Date(e),r=t?et(n,new Date(t)):!0,a=s?Be(n,new Date(s)):!0;return r&&a},zr=(e,t=[])=>{const s=e.usersInfo||{};return t.filter(r=>{const a=r.author,{dates:l=[]}=s[a]||{},c=Kr(r.mergedAt);return l.length>0?l.some(c):!0})},ms=({excludeIds:e=[]},{reportStartDate:t="",reportEndDate:s=""},n=[])=>{const r=[];return[n.filter(l=>{const c=Pe("","author",l),d=["GIT_APP_PR",...e].some(p=>p===c),i=l.mergedAt,u=et(new Date(i),new Date(t))&&Be(new Date(i),new Date(s))&&!d;return!u&&r.push(l),u}).sort(lo("mergedAt","ASC")),r]},co=e=>({reportStartDate:t="",reportEndDate:s=""},n=[])=>{const r=[];return[n.filter(l=>{const c=l==null?void 0:l[e],d=et(new Date(c),new Date(t))&&Be(new Date(c),new Date(s));return!d&&r.push(l),d}).sort(lo(e,"ASC")),r]},Hr=co("mergedAt"),Wr=co("date"),Yr=e=>{var l,c,d,i,m,u;const t=((l=e==null?void 0:e.node)==null?void 0:l.createdAt)||"",s=((c=e==null?void 0:e.node)==null?void 0:c.closedAt)||"",n=((d=e==null?void 0:e.node)==null?void 0:d.title)||"",r=((i=e==null?void 0:e.node)==null?void 0:i.url)||"",a=((u=(m=e==null?void 0:e.node)==null?void 0:m.labels)==null?void 0:u.edges)||[];return{mergedAt:t,createdAt:t,age:fe(new Date(s),new Date(t))||1,url:r,isBug:/bug/i.test(n)||a.some(p=>{var h;return/bug/i.test((h=p==null?void 0:p.node)==null?void 0:h.name)})}},Qr=(e=[])=>{const t=e.map(a=>{var l,c,d;return((d=(c=(l=a==null?void 0:a.data)==null?void 0:l.result)==null?void 0:c.issues)==null?void 0:d.edges)||[]});return As(t).filter(Boolean).map(a=>Yr(a))},Xr=e=>{var n,r,a;const t=((n=e==null?void 0:e.node)==null?void 0:n.createdAt)||"",s=((a=(r=e==null?void 0:e.node)==null?void 0:r.tag)==null?void 0:a.name)||"";return{date:t,description:s}},Jr=(e=[])=>{const t=e.map(a=>{var l,c,d;return((d=(c=(l=a==null?void 0:a.data)==null?void 0:l.result)==null?void 0:c.releases)==null?void 0:d.edges)||[]});return As(t).filter(Boolean).map(a=>Xr(a))},io=e=>typeof e=="string"&&e.length&&e||/^-?[\d.]+$/.test(`${e}`)&&/^-?[^0]/.test(`${e}`)&&e||Array.isArray(e)&&e.length&&Zr(e)||e&&Object.keys(e).length&&mo(e)||typeof e=="boolean"&&e,Zr=e=>{const t=[];return e.forEach(s=>{const n=io(s);n&&t.push(n)}),t.length&&t},mo=e=>{const t={};return Object.entries(e).forEach(([s,n])=>{const r=io(n);r&&(t[s]=r)}),Object.keys(t).length&&t},mt={author:"",approvalsGiven:0,approvalsByUser:{},commentsGiven:0,commentsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,totalPRs:0,uniquePRsContributedTo:0,commentsByUser:{},prSizes:[],prTotalAdditions:0,prTotalDeletions:0,prAdditions:[],prDeletions:[],prAges:[],sentimentTotalScores:[],orgs:new Set,repos:new Set,sentimentTotalPositiveScore:0,sentimentAveragePositiveScore:0,sentimentPositiveCount:0,sentimentTotalNegativeScore:0,sentimentNegativeCount:0,sentimentAverageNegativeScore:0},ze=(e,t,s,n)=>{const r={};return Object.entries(s).forEach(([a,l])=>{const c=e[a]||{},d={...mt,...c,user:a,[t]:(c[t]||0)+(n||l)};r[a]=d}),r},us=(e,t,s,n,r,a)=>{const l={};return Object.entries(s).filter(([c])=>a&&n!==a?c===a:!0).forEach(([c,d])=>{const i=e[c]||{},m=i[t]||{},u={...m,[n]:(m[n]||0)+(r||d||0)},p={...mt,...i,author:c,[t]:u};l[c]=p}),l},xt=(e=[],t={},s="")=>{const n=new Set,r={};e.forEach(d=>{var ne;const{org:i,repo:m,author:u,additions:p=0,deletions:h=0,age:g=0,approvals:x=0,approvers:y={},comments:f=0,commenters:S={},codeComments:w=0,codeCommenters:E={},generalComments:v=0,generalCommenters:b={},commentSentimentTotalScore:T=0,commentSentimentScore:j=0,commentAuthorSentimentScore:P=0}=d;n.add(u);const $=us(r,"commentsByUser",S,u,0,s);Object.assign(r,$);const K=us(r,"approvalsByUser",y,u,1,s);Object.assign(r,K);const ee=ze(r,"commentsGiven",S);Object.assign(r,ee);const be=ze(r,"codeCommentsGiven",E);Object.assign(r,be);const te=ze(r,"generalCommentsGiven",b);Object.assign(r,te);const me=ze(r,"approvalsGiven",y);Object.assign(r,me);const ce=ze(r,"uniquePRsApproved",y,1);Object.assign(r,ce),[...new Set([...Object.keys(E),...Object.keys(b),...Object.keys(y)])].forEach(X=>{const pe=r[X]||{},ke={...mt,...pe,author:X,uniquePRsContributedTo:(pe.uniquePRsContributedTo||0)+1};r[X]=ke}),r[u]||(r[u]={...mt}),r[u].orgs.add(i),r[u].repos.add(m);const z=T||j+P;r[u].sentimentTotalScores.push(z);const G=(X="",pe=0)=>(r[u][X]||0)+pe,ue=G("totalPRs",1),De=G("prTotalAge",g),he=Math.round(De/ue),ie=G("prTotalAdditions",p),Re=G("prTotalDeletions",h),ot=Math.round((ie+Re)/ue),Te=z>0?z:0,_e=z>0?1:0,je=G("sentimentTotalPositiveScore",Te),Oe=G("sentimentPositiveCount",_e),Ke=Oe?Math.round(je/Oe):0,N=z<0?z:0,O=z<0?1:0,F=G("sentimentNegativeCount",O),V=G("sentimentTotalNegativeScore",N),oe=F?Math.round(V/F):0,Q={author:u,name:((ne=t[u])==null?void 0:ne.name)||u,user:u,totalPRs:ue,age:he,prTotalAge:De,prSize:ot,prTotalAdditions:ie,prTotalDeletions:Re,approvalsReceived:G("approvalsReceived",x),commentsReceived:G("commentsReceived",f),codeCommentsReceived:G("codeCommentsReceived",w),generalCommentsReceived:G("generalCommentsReceived",v),commentSentimentTotalScore:G("commentSentimentTotalScore",z),sentimentPositiveCount:Oe,sentimentTotalPositiveScore:je,sentimentAveragePositiveScore:Ke,sentimentNegativeCount:F,sentimentTotalNegativeScore:V,sentimentAverageNegativeScore:oe,orgCount:r[u].orgs.size,repoCount:r[u].repos.size};Object.assign(r[u],Q)});const a=Object.values(r).filter(({author:d})=>n.has(d)).map((d={})=>bs(["author","user","name","approvalsGiven","approvalsByUser","uniquePRsApproved","commentsGiven","commentsReceived","codeCommentsGiven","codeCommentsReceived","generalCommentsGiven","generalCommentsReceived","totalPRs","uniquePRsContributedTo","commentsByUser","prTotalAdditions","prTotalDeletions","orgCount","repoCount","user","approvalsReceived","prSize","prTotalAge","age","sentimentAveragePositiveScore","sentimentTotalPositiveScore","sentimentAverageNegativeScore","sentimentTotalNegativeScore"],d)),l=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"];return a.filter(({author:d})=>Object.keys(t).length>0?t[d]:!0).sort(we(l))},ea=(e,t)=>{const s=(e==null?void 0:e.date)||"",n=(t==null?void 0:t.date)||"";return new Date(s).getTime()-new Date(n).getTime()},Je=e=>(e==null?void 0:e.description)||"",ta=(e,t)=>{let s;try{s=Ds.lt(Je(e),Je(t))?-1:1}catch{s=0}return s},uo=(e=[])=>{const t=e.filter(a=>/^v\d+\.\d+\.\d+$/.test(Je(a))).sort(ta),s=t.map((a,l)=>{const c=Je(a);let d="";try{const m=l>0?Je(t[l-1]):"v0.0.0",u=Ds.diff(m,c)||"EMPTY";d={minor:"MINOR",major:"MAJOR",patch:"PATCH",premajor:"PATCH",preminor:"PATCH",prepatch:"PATCH",prerelease:"PATCH",EMPTY:"PATCH"}[u]||"PATCH"}catch{d="PATCH"}return{...a,releaseType:d||"MAJOR"}}),n=s.length>70?a=>a.releaseType!=="PATCH":()=>!0;return s.filter(n).sort((a,l)=>ea(a,l))},ho=({usersInfo:e={},events:t=[]})=>{const s=[];Object.values(e).forEach(({name:l="",userId:c="",dates:d=[]})=>{d.forEach(i=>{const{startDate:m,endDate:u}=i;m&&s.push({date:m,description:l||c,releaseType:"MINOR"}),u&&s.push({date:u,description:l||c,releaseType:"PATCH"})})});const n=t.map(({date:l,name:c}={})=>({date:l,description:c,releaseType:"MAJOR"})),r=(l,c)=>{const d=(l==null?void 0:l.date)||"",i=(c==null?void 0:c.date)||"";return new Date(d).getTime()-new Date(i).getTime()};return[...s,...n].sort(r)},po=(e="")=>({type:R.STORE_TOKEN,payload:e}),sa=(e="")=>t=>t({type:R.STORE_ORG,payload:e}),oa=(e="")=>t=>t({type:R.STORE_ENT_URL,payload:e}),na=(e="")=>t=>t({type:R.SET_TEAM_NAME,payload:e}),Kt=Ts(hn(","),mn(un),js(Boolean)),go=(e={})=>t=>{const s=Object.keys(e);return t({type:R.STORE_USERS_INFO,payload:e}),t({type:R.STORE_USER_IDS,payload:s})},fo=(e="")=>t=>{const s=Kt(e);return t({type:R.STORE_EX_IDS,payload:s})},xo=(e="")=>t=>{const n=Kt(e).map((r="")=>{const[a,l]=r.split("=");return{name:a,date:l}});return t({type:R.STORE_EVENTS,payload:n})},ra=(e="")=>t=>t({type:R.STORE_REPO,payload:e}),yo=e=>t=>t({type:R.STORE_AMOUNT,payload:e||""}),Ro=e=>(t,s)=>{const{fetches:n,pullRequests:r=[]}=s(),a=Mr({...n,amountOfData:e||""},r);t({type:R.STORE_FORM_UNTIL_DATE,payload:a})},Eo=(e="DESC")=>t=>t({type:R.STORE_SORT,payload:e}),aa=(e={},t={})=>(s="")=>e[s]&&t[s]&&e[s]!==t[s],la=(e={},t={})=>(s="")=>{const n=Pe("",s,e),r=Kt(n),a=t[s];return a.length&&Ps(B(a,r))},ca=(e={},t={})=>{const s=e.userId,[n]=t.userIds,r=(e==null?void 0:e.usersInfo)||{},a=t.usersInfo||{},l=s&&n&&s!==n,c=Ps(B(r,a));return l||c},ia=e=>(t,s)=>{const{fetches:n={}}=s(),r=aa(e,n),a=la(e,n);(r("org")||r("repo")||r("teamName")||r("enterpriseAPI")||ca(e,n)||a("excludeIds"))&&yt(t)},yt=e=>{e({type:R.CLEAR_ORG}),e({type:R.CLEAR_REPO}),e({type:R.CLEAR_TRIMMED_ITEMS}),e({type:R.CLEAR_PRS}),e({type:R.CLEAR_FILTERED_PRS}),e({type:R.CLEAR_REVIEWED_PRS}),e({type:R.CLEAR_REVIEWED_FILTERED_PRS}),e({type:R.CLEAR_ITEMS_DATE_RANGE}),e({type:R.CLEAR_PR_PAGINATION}),e({type:R.CLEAR_PREFETCHED_NAME}),e({type:R.CLEAR_DESC}),e({type:R.CLEAR_UNTIL_DATE}),e({type:R.CLEAR_FORM_UNTIL_DATE}),e({type:R.CLEAR_USER_IDS}),e({type:R.CLEAR_USERS_INFO}),e({type:R.CLEAR_EX_IDS}),e({type:R.CLEAR_EVENTS}),e({type:R.CLEAR_USERS_DATA}),e({type:R.CLEAR_TEAM_NAME}),e({type:R.CLEAR_RELEASES}),e({type:R.CLEAR_RELEASES_PAGINATION}),e({type:R.CLEAR_ISSUES}),e({type:R.CLEAR_FILTERED_ISSUES}),e({type:R.CLEAR_ISSUES_PAGINATION}),e({type:R.CLEAR_FETCH_ERROR}),e({type:R.CLEAR_PRE_FETCH_ERROR})},da=yt,ma=e=>{const{fetches:{org:t="",repo:s="",token:n="",userIds:r=[]}={}}=e,a=r.length<1,l=[a&&!t&&"Organization",a&&!s&&"Repository",!n&&"GitHib token",!t&&!s&&a&&"GitHub Ids"].filter(Boolean),c=i=>{const m=l.length-1;return[i===0?"Missing ":"",i===m?" and ":"",i>0?", ":""].find(p=>p.length>0)||""};return l.reduce((i,m,u)=>i+c(u)+m,"")},ua=e=>{const{fetches:{org:t="",repo:s="",token:n="",userIds:r=[]}={}}=e,a=[n];t&&a.push(t),s&&a.push(s);const l=a.every(m=>typeof m=="string"&&m.length>0),d=(r.length?[r]:[]).every(m=>m.length>0),i=l&&d;return{isValid:i,error:i?null:{level:"error",message:ma(e)}}},ha=(e="",t="")=>(s="mergedAt",n=[])=>{const r=[],a=[],l=[],c=(d=[])=>d.forEach(i=>{const m=new Date(i[s]);Be(m,new Date(e))?r.push(i):et(m,new Date(t))?l.push(i):a.push(i)});return n.forEach(c),[r,a,l]},pa=(e="",t="")=>async(s,n)=>{const{fetches:{usersInfo:r={}}={},trimmedItems:{trimmedPRs:{trimmedLeftPrs:a=[],trimmedRightPrs:l=[]}={},trimmedReviewedPRs:{trimmedLeftReviewedPrs:c=[],trimmedRightReviewedPrs:d=[]}={},trimmedReleases:{trimmedLeftReleases:i=[],trimmedRightReleases:m=[]}={}}={},pullRequests:u=[],reviewedPullRequests:p=[],releases:h=[]}=n(),g=ha(e,t),x=[a,u,l],[y,f,S]=g("mergedAt",x);s({type:R.ADD_PRS,payload:f});const w=[c,p,d],[E,v,b]=g("mergedAt",w);s({type:R.ADD_REVIEWED_PRS,payload:v}),s({type:R.ADD_USERS_DATA,payload:xt(f.concat(v),r)});const T=[i,h,m],[j,P,$]=g("date",T);s({type:R.ADD_RELEASES,payload:P}),s({type:R.ADD_TRIMMED_ITEMS,payload:{trimmedPRs:{trimmedLeftPrs:y,trimmedRightPrs:S},trimmedReviewedPRs:{trimmedLeftReviewedPrs:E,trimmedRightReviewedPrs:b},trimmedReleases:{trimmedLeftReleases:j,trimmedRightReleases:$}}})},So=(e=[])=>{const{mergedAt:t=""}=e.at(0)||{mergedAt:""},{mergedAt:s=""}=e.at(-1)||{mergedAt:""};return[t,s]},vo=()=>async(e,t)=>{var r,a,l,c,d,i;const s=t(),{isValid:n}=ua(s);n&&e({type:R.CLEAR_FETCH_ERROR}),n&&e({type:R.FETCH_START});try{if(!n)throw new Error("Not a valid request");const{fetches:m,filteredPRs:u=[],pullRequests:p=[],filteredReviewedPRs:h=[],reviewedPullRequests:g=[],issues:x=[],filteredIssues:y=[],formUntilDate:f="",releases:S=[],filteredReleases:w=[]}=t(),{usersInfo:E}=m,v=(m==null?void 0:m.userIds)||[],b=(m==null?void 0:m.repo)||"",T=(m==null?void 0:m.org)||"",j=f,P=v.length===1&&"user"||v.length>1&&"team"||!b&&T&&"org"||"repo",$={user:()=>Or({fetchInfo:m,untilDate:j,dispatch:e}),team:()=>_r({fetchInfo:m,untilDate:j,dispatch:e}),repo:()=>ye({fetchInfo:m,queryInfo:no(j),dispatch:e}),org:()=>kr({fetchInfo:m,untilDate:j,dispatch:e})},{fetchInfo:K={},results:ee=[],reviewResults:be=[]}=await $[P](),te=ds(m,ee),me=zr(m,te),ce=p.concat(u).concat(me),se=(a=(r=p.at(-1))==null?void 0:r.mergedAt)==null?void 0:a.slice(0,10),z=(c=(l=p.at(0))==null?void 0:l.mergedAt)==null?void 0:c.slice(0,10),G=(i=(d=te.at(-1))==null?void 0:d.mergedAt)==null?void 0:i.slice(0,10),ue=new Date().toISOString().slice(0,10),{sortDirection:De="DESC"}=m,he=De==="DESC"?{reportStartDate:j||G,reportEndDate:se||ue}:{reportStartDate:z,reportEndDate:j||ue},[ie,Re]=ms(m,he,ce);e({type:R.ADD_PRS,payload:ie}),e({type:R.ADD_FILTERED_PRS,payload:Re});const Te=ds(m,be).filter(({author:Q="",mergedAt:ne=""})=>ne&&Q!==v[0]),_e=g.concat(h).concat(Te),[je=[],Oe=[]]=ms(m,he,_e);e({type:R.ADD_REVIEWED_PRS,payload:je}),e({type:R.ADD_REVIEWED_FILTERED_PRS,payload:Oe});const Ke=So(ie);if(e({type:R.ADD_ITEMS_DATE_RANGE,payload:Ke}),e({type:R.ADD_USERS_DATA,payload:xt(ie.concat(je),E)}),P==="repo"){const Q=Jr(ee),ne=uo([...w,...S,...Q]),[X,pe]=Wr(he,ne);e({type:R.ADD_RELEASES,payload:X}),e({type:R.ADD_FILTERED_RELEASES,payload:pe})}const N=Qr(ee),O=x.concat(y).concat(N),[F,V]=Hr(he,O);e({type:R.ADD_ISSUES,payload:F}),e({type:R.ADD_FILTERED_ISSUES,payload:V}),e({type:R.STORE_UNTIL_DATE,payload:f});const oe=(Q={})=>{const ne=bs(["newest","oldest"]),X={};return Object.entries(Q).filter(([,ke])=>ws(Object,ke)&&pn(ne(ke)).length>0).forEach(([ke,nn])=>{X[ke]=ne(nn)}),{...ne(Q),...X}};e({type:R.SET_PR_PAGINATION,payload:oe(K.prPagination)}),e({type:R.SET_PR_REVIEWED_PAGINATION,payload:oe(K.usersReviewsPagination)}),e({type:R.SET_ISSUES_PAGINATION,payload:oe(K.issuesPagination)}),e({type:R.SET_RELEASES_PAGINATION,payload:oe(K.releasesPagination)}),e({type:R.FETCH_END})}catch(m){const u=m;e({type:R.FETCH_ERROR,payload:{level:"error",message:u.message||"Unknown error"}}),e({type:R.FETCH_END})}},ga=(e,t)=>{const{fetches:s,preFetchedName:n="",reportDescription:r="",pullRequests:a=[],filteredPRs:l=[],reviewedPullRequests:c=[],filteredReviewedPRs:d=[],usersData:i=[],issues:m=[],filteredIssues:u=[],releases:p=[],filteredReleases:h=[]}=e,{teamName:g="",userIds:x=[],usersInfo:y={},excludeIds:f=[],events:S=[],repo:w="",org:E=""}=s;yt(t),[["token","STORE_TOKEN",""],["org","STORE_ORG",""],["repo","STORE_REPO",""],["enterpriseAPI","STORE_ENT_URL",""],["prPagination","SET_PR_PAGINATION",{}],["usersReviewsPagination","SET_PR_REVIEWED_PAGINATION",{}],["releasesPagination","SET_RELEASES_PAGINATION",{}],["issuesPagination","SET_ISSUES_PAGINATION",{}]].forEach(([j,P="",$])=>{t({type:R[P],payload:(s==null?void 0:s[j])||$})}),t({type:R.PREFETCHED_NAME,payload:n}),t({type:R.STORE_SORT,payload:"ASC"}),t({type:R.STORE_AMOUNT,payload:"all"}),t({type:R.SET_DESC,payload:r}),t({type:R.SET_TEAM_NAME,payload:g}),t({type:R.STORE_USER_IDS,payload:x}),t({type:R.STORE_USERS_INFO,payload:y}),t({type:R.STORE_EX_IDS,payload:f}),t({type:R.STORE_EVENTS,payload:S});const b=So(a);t({type:R.ADD_ITEMS_DATE_RANGE,payload:b}),t({type:R.ADD_PRS,payload:a}),t({type:R.ADD_FILTERED_PRS,payload:l}),t({type:R.ADD_REVIEWED_PRS,payload:c}),t({type:R.ADD_REVIEWED_FILTERED_PRS,payload:d}),t({type:R.ADD_USERS_DATA,payload:i.length?i:xt(a.concat(c),y)});const T=m.sort(({mergedAt:j=""},{mergedAt:P=""})=>new Date(j).getTime()-new Date(P).getTime());if(t({type:R.ADD_ISSUES,payload:T}),t({type:R.ADD_FILTERED_ISSUES,payload:u}),w&&E){const j=uo(p);t({type:R.ADD_RELEASES,payload:j}),t({type:R.ADD_FILTERED_RELEASES,payload:h})}t({type:R.FETCH_END})},fa=e=>new Promise((t,s)=>{e.json().then(n=>e.status===200?t(n):s(new Error(`Error status code ${e.status}`))).catch(n=>{const r=n;console.log("-=-=--parseJSON error",r),r.status=e.status,s(r)})}),xa=({fileName:e="",externalURL:t="",localData:s}={})=>async n=>{yt(n),n({type:R.CLEAR_PRE_FETCH_ERROR}),n({type:R.FETCH_START}),n({type:R.FETCH_STATUS,payload:{savedReportName:e}});const r=t?`${t}${e}.json`:`https://n07734.github.io/community-health/data/${e}.json`;try{const a=s||await fetch(r).then(fa);ga(a,n)}catch(a){const l=a;console.log("-=-=--api data error",l,l.status);const c=l.status!==200?`Error status code ${l.status} loading ${e}`:`${l.message} loading ${e}`;n({type:R.PRE_FETCH_ERROR,payload:{level:"error",message:c||"Unknown error"}}),n({type:R.FETCH_END})}},wo=(e,t)=>{const s=t(),{repo:n,org:r,teamName:a,userIds:l=[]}=(s==null?void 0:s.fetches)||{},c=(l==null?void 0:l.length)===1?l[0]:"",d=a||c||`${r}${n?`-${n}`:""}`,m=Ts(Jt("HOW_TO","1: Add this file to ./src/myReports 2: Run the app. If you want multiple reports you will need to edit ./src/myReports/myReportsConfig.js."),gn(["fetches","pullRequests","filteredPRs","reviewedPullRequests","filteredReviewedPRs","userData","issues","filteredIssues","releases","teamName"]),Le(["fetches","token"]),Le(["sortDirection"]),Le(["fetches","amountOfData"]),Le(["fetches","prPagination","hasNextPage"]),Le(["fetches","issuesPagination","hasNextPage"]),Le(["fetches","releasesPagination","hasNextPage"]),Jt("preFetchedName",d),mo)(s),u=JSON.stringify(m,null,2),p=new Blob([u],{type:"application/json"});return{href:URL.createObjectURL(p),download:`${d}.json`}},ya=(e="")=>(t,s)=>{const{fetches:{sortDirection:n=""}={}}=s();n!==e&&t({type:R.CLEAR_UNTIL_DATE})&&t({type:R.CLEAR_FORM_UNTIL_DATE})};function C(...e){return fn(xn(e))}const Ra=Ns("uppercase inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),k=A.forwardRef(({className:e,variant:t,size:s,asChild:n=!1,...r},a)=>{const l=n?yn:"button";return o.jsx(l,{className:C(Ra({variant:t,size:s,className:e})),ref:a,...r})});k.displayName="Button";const Ea={warn:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),error:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})},zt=({error:{level:e="error",message:t},className:s})=>{const n=e==="error"?"bg-error":"bg-warn";return o.jsxs("div",{className:`${n} p-3 flex items-center rounded-sm ${s}`,children:[Ea[e],o.jsx("p",{className:"m-0 ml-2 p-0",children:t})]})},It=[{name:"React",fileName:"facebook-react"},{name:"NextJS",fileName:"vercel-next.js"},{name:"Remix",fileName:"remix-run-remix"},{name:"Vue",fileName:"vuejs-core"},{name:"Svelte",fileName:"sveltejs-svelte"},{name:"Typescript",fileName:"microsoft-typescript"},{name:"Typescript 10th anniversary",fileName:"microsoft-typescript-10"},{name:"vscode",fileName:"microsoft-vscode"},{name:"Node",fileName:"nodejs-node"},{name:"Bluesky",fileName:"bluesky-social-social-app"}],_t=[{name:"Vite",fileName:"vitejs"},{name:"testing-library",fileName:"testing-library"}],Ot=[{name:"ReactCore",fileName:"ReactCore"},{name:"ViteCore",fileName:"ViteCore"},{name:"TypeScriptCore",fileName:"TypeScriptCore"}],Ao=[{name:"Vite",fileName:"vitejs"},{name:"Vitest",fileName:"vitest-dev-vitest"},{name:"Playwright",fileName:"microsoft-playwright"},{name:"PNPM",fileName:"pnpm-pnpm"},{name:"MSW",fileName:"mswjs-msw"},{name:"esbuild",fileName:"evanw-esbuild"},{name:"SWC",fileName:"swc-project-swc"},{name:"Testing Library",fileName:"testing-library"},{name:"Astro",fileName:"withastro-astro"}],Ee=[],Sa=e=>{var w,E;const{error:t,preFetchedName:s="",getPreFetchedReport:n}=e,{togglePvPPage:r,setUserPage:a}=qe(),l=(w=window==null?void 0:window.location)==null?void 0:w.search,c=new URLSearchParams(l),d=c.get("player1")||"",i=c.get("player2")||"",m=c.get("user")||"",u=[...Ee,...It,...Ot,..._t],p=c.get("report"),h=p||((E=Ee[0])==null?void 0:E.fileName)||"vitejs",g=u.some(v=>v.fileName===h),x=g?u.find(v=>v.fileName===(s||h)):{fileName:h};A.useEffect(()=>{n(x),d&&i?r():m&&a(m)},[n,d,i,m]);const y=(v,b=1)=>o.jsx(k,{className:"mr-2 mb-3","data-qa-id":`prefetch-${v.name}`,variant:s===v.fileName?void 0:"secondary",onClick:T=>{T.preventDefault(),n(v)},children:(v==null?void 0:v.name)||"Report"},`${b}`),[f,S]=A.useState(!1);return!g&&p?o.jsx("div",{}):o.jsxs("div",{className:"mb-4",children:[Ee.map(y),o.jsxs("div",{children:[o.jsxs("p",{children:[o.jsx("a",{className:"text-primary",href:"https://2023.stateofjs.com/en-US/libraries/#tier_list",children:"StateOfJS 23"})," S tier list"]}),Ao.map(y)]}),o.jsx("p",{children:"Other reports"}),Ee.length===0&&o.jsxs(o.Fragment,{children:[!f&&x&&Object.keys(x).length>0&&y(x),f&&o.jsxs(o.Fragment,{children:[o.jsx("p",{children:"Repository reports"}),It.map(y),o.jsx("p",{children:"Org reports"}),_t.map(y),o.jsx("p",{children:"Team reports"}),Ot.map(y)]}),t&&o.jsx(zt,{error:t,className:"col-span-full"})]}),o.jsx(k,{className:"mr-2 mb-3",variant:f?void 0:"secondary",onClick:v=>{v.preventDefault(),S(!f)},children:f?"Hide other reports":"Show more OSS reports..."})]})},va=e=>({preFetchedName:e.preFetchedName,error:e.preFetchedError}),wa=e=>({getPreFetchedReport:t=>e(xa(t))}),Aa=M(va,wa)(Sa),$e=An,Fe=bn,Ue=Dn,Ne=A.forwardRef(({className:e,children:t,...s},n)=>o.jsxs(Cs,{ref:n,className:C("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,o.jsx(Rn,{asChild:!0,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:o.jsx("path",{d:"m6 9 6 6 6-6"})})})]}));Ne.displayName=Cs.displayName;const bo=A.forwardRef(({className:e,...t},s)=>o.jsx(Is,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:o.jsx("path",{d:"m18 15-6-6-6 6"})})}));bo.displayName=Is.displayName;const Do=A.forwardRef(({className:e,...t},s)=>o.jsx(_s,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:o.jsx("path",{d:"m6 9 6 6 6-6"})})}));Do.displayName=_s.displayName;const Ce=A.forwardRef(({className:e,children:t,position:s="popper",...n},r)=>o.jsx(En,{children:o.jsxs(Os,{ref:r,className:C("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...n,children:[o.jsx(bo,{}),o.jsx(Sn,{className:C("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),o.jsx(Do,{})]})}));Ce.displayName=Os.displayName;const ba=A.forwardRef(({className:e,...t},s)=>o.jsx(ks,{ref:s,className:C("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));ba.displayName=ks.displayName;const J=A.forwardRef(({className:e,children:t,...s},n)=>o.jsxs(Ls,{ref:n,className:C("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(vn,{children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:o.jsx("path",{d:"M20 6 9 17l-5-5"})})})}),o.jsx(wn,{children:t})]}));J.displayName=Ls.displayName;const Da=A.forwardRef(({className:e,...t},s)=>o.jsx(Ms,{ref:s,className:C("-mx-1 my-1 h-px bg-muted",e),...t}));Da.displayName=Ms.displayName;const Ta=e=>{const{setValue:t,amountOfData:s,pullRequests:n=[],preFetchedName:r="",className:a=""}=e,l=!r&&n.length>0,c=d=>`Get ${d} ${d===1?"month":"months"} ${l?"more ":""}data`;return o.jsxs($e,{onValueChange:d=>t("amountOfData",d==="all"?d:Number(d)),value:`${s}`,children:[o.jsx(Ne,{className:`w-auto ${a}`,children:o.jsx(Ue,{children:s==="all"?"Get it all!":c(Number(s))})}),o.jsx(Ce,{children:o.jsxs(Fe,{children:[o.jsx(J,{value:"1",children:c(1)}),o.jsx(J,{value:"3",children:c(3)}),o.jsx(J,{value:"6",children:c(6)}),o.jsx(J,{value:"12",children:c(12)}),o.jsx(J,{value:"24",children:c(24)}),o.jsx(J,{value:"all",children:"Get it all!"})]})})]})},ja=e=>({pullRequests:e.pullRequests,preFetchedName:e.preFetchedName}),To=M(ja)(Ta),Pa=(e,t)=>[e&&"fetching",t.length&&"Get more data","Get data"].find(Boolean),Na=e=>{const{fetching:t,error:s,pullRequests:n=[],qaId:r}=e;return o.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2",children:[o.jsx(k,{className:"m-0 w-full col-span-full",type:"submit",disabled:t,color:"primary","data-qa-id":r,children:Pa(t,n)}),s&&o.jsx(zt,{error:s,className:"col-span-full"})]})},Ca=e=>({fetching:e.fetching,error:e.error,pullRequests:e.pullRequests}),jo=M(Ca)(Na),Po=Pn,Ia=Nn,No=jn,Ht=A.forwardRef(({className:e,...t},s)=>o.jsx($s,{ref:s,className:C("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Ht.displayName=$s.displayName;const Co=A.forwardRef(({className:e,children:t,...s},n)=>o.jsxs(No,{children:[o.jsx(Ht,{}),o.jsxs(gt,{ref:n,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,o.jsxs(Tn,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[o.jsx("path",{d:"M18 6 6 18"}),o.jsx("path",{d:"m6 6 12 12"})]}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Co.displayName=gt.displayName;const Io=A.forwardRef(({className:e,children:t,...s},n)=>o.jsxs(No,{children:[o.jsx(Ht,{}),o.jsx(gt,{ref:n,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:t})]}));Io.displayName=gt.displayName;const Wt=A.forwardRef(({className:e,...t},s)=>o.jsx(Fs,{ref:s,className:C("text-lg font-semibold leading-none tracking-tight",e),...t}));Wt.displayName=Fs.displayName;const _a=A.forwardRef(({className:e,...t},s)=>o.jsx(Us,{ref:s,className:C("text-sm text-muted-foreground",e),...t}));_a.displayName=Us.displayName;const _o=A.forwardRef(({className:e,type:t,...s},n)=>o.jsx("input",{type:t,"data-qa-id":`input-${t}`,className:C("flex mt-8 h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground  focus:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring  disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...s}));_o.displayName="Input";const Oa=Ns("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ze=A.forwardRef(({className:e,...t},s)=>o.jsx(Gs,{ref:s,className:C(Oa(),e),...t}));Ze.displayName=Gs.displayName;const Oo={org:"Organization",repo:"Repository",team:"Team name (from GitHub Org team url)",gitTeamUrl:"Org's team url",token:"Token",excludeIds:"Exclude GitHub users e.g. remove bot PRs and comments, ',' separated",enterpriseAPI:"Enterprise API full url",userIds:"Comma separated list GitHub users",userId:"GitHub user ID",startDate:"Joined yyyy/mm/dd",endDate:"Left yyyy/mm/dd",events:"Comma separated list of events (optional)",teamName:"Team name",name:"Name"},ka=({dates:e=[]})=>{const t=e.every(({startDate:a="",endDate:l=""})=>{const c=!a||jt(new Date(a)),d=!l||jt(new Date(l));return c&&d}),s=[];e.forEach(({startDate:a="",endDate:l=""})=>{a&&s.push(a),l&&s.push(l)});const n=In((a,l)=>new Date(a).getTime()-new Date(l).getTime(),s),r=B(s,n);return t&&r},La=(e={})=>{const t=Object.values(e).every(s=>ka(s));return Object.keys(e).length>0&&t},hs=(e="")=>!e||/^\d{4}[/-]\d{2}[/-]\d{2}$/.test(e)&&jt(new Date(e)),ko=({key:e,value:t})=>Z([[B("gitTeamUrl"),D(/^(https:\/\/.+\..+$)/.test(t))],[B("enterpriseAPI"),D(/^(https:\/\/.+\..+|^$)/.test(t))],[B("excludeIds"),D(/^([\w-.,\s]+|)$/.test(t))],[B("events"),D(/^([\w-.,&\s=]+|)$/.test(t))],[B("name"),D(/.?/.test(t))],[B("usersInfo"),()=>La(t)],[B("startDate"),()=>hs(t)],[B("endDate"),()=>hs(t)],[U,D(/^[\w-_.]+$/.test(t))]])(e),Ma=e=>t=>{const s=e[t];return!ko({key:t,value:s})},Lo=e=>{const t=Ma(e),s={};return Object.keys(e).forEach(r=>{s[r]=t(r)}),{isValid:Object.values(s).every(r=>!r),validationErrors:s}},kt=(e,t)=>{const s=e[t],n=typeof s=="object"?"":s;return Array.isArray(s)?Cn(", ",s):n},H=e=>{const{type:t,className:s="",inputError:n={},setInputError:r=()=>{},formInfo:a={},setValue:l}=e,c=n[t]?"border-red-500":"";return o.jsxs(Ze,{children:[o.jsx("p",{className:"mb-1 block",children:Oo[t]}),o.jsx(_o,{className:`${s} m-0 w-full ${c}`,value:kt(a,t),type:t,onBlur:d=>{const i=I("",["target","value"],d),m=ko({key:t,value:i});r({...n,[t]:!m}),m&&l(t,i)},onChange:d=>{const i=I("",["target","value"],d);r({...n,[t]:!1}),l(t,i)},onFocus:()=>r({...n,[t]:!1})}),o.jsx("p",{className:"text-red-500 text-xs",children:n[t]&&"Invalid input"})]})},$a=({onSubmit:e=()=>{},gitUsers:t=[],usersInfo:s={}})=>{const n=Object.entries(s).map(([f,{name:S="",dates:w=[]}])=>({userId:f,name:S,dates:w})),r=n.length>0?n:[{userId:"",name:"",dates:[]}],[a,l]=A.useState(r),c=f=>(S,w)=>{const E=[...a];E[f][S]=w,l(E)},d=(f,S)=>(w,E)=>{const v=[...a];v[f].dates[S][w]=E,l(v)},i=f=>{f.preventDefault();const S={};a.forEach(({userId:w,name:E,dates:v})=>{S[w]={userId:w,name:E,dates:v}}),e(S)},m=f=>{f.preventDefault(),l([...a,{userId:"",name:"",dates:[]}])},u=(f,S)=>{S.preventDefault();const w=[...a];w.splice(f,1),l(w)},p=(f,S)=>{S.preventDefault();const w=[...a],E={startDate:"",endDate:""};w[f].dates.push(E),l(w)},h=({userIndex:f,dateIndex:S})=>{const w=[...a],v=w[f].dates.filter((b,T)=>T!==S);w[f].dates=v,l(w)},[g,x]=A.useState({}),y=t.length>0&&"Edit Github Team members"||Object.keys(s).length>0&&"Edit team members"||"Or manually add team members";return o.jsxs("form",{children:[o.jsx("h4",{children:y}),a.map((f,S)=>o.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2 mb-8",children:[o.jsx(H,{type:"userId",formInfo:f,inputError:g,setInputError:x,setValue:c(S)}),o.jsx(H,{type:"name",formInfo:f,setValue:c(S),inputError:g,setInputError:x}),f.dates.map((w,E)=>o.jsxs("div",{className:"flex items-stretch gap-2 justify-between col-span-full",children:[o.jsx(H,{type:"startDate",formInfo:w,inputError:g,setInputError:x,setValue:d(S,E)}),o.jsx(H,{type:"endDate",inputError:g,formInfo:w,setInputError:x,setValue:d(S,E)}),o.jsx("svg",{onClick:()=>h({userIndex:S,dateIndex:E}),className:"w-6 fill-current min-h-12 rounded-sm bg-destructive test-[#CCC] px-0 py-2 h-auto",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"DeleteIcon",children:o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})})]},E)),o.jsx(k,{className:"min-h-12 m-0",color:"primary",onClick:w=>p(S,w),children:`Add ${f.dates.length>0?"more dates":"dates"}`}),o.jsx(k,{className:"bg-destructive text=[#CCC] min-h-12 m-0",onClick:w=>u(S,w),children:"Remove User"})]},S)),o.jsx(k,{className:"mr-0 w-full min-h-12",color:"primary",onClick:f=>m(f),children:"Create new user"}),o.jsx(k,{className:"mr-0 w-full min-h-12",color:"primary",onClick:f=>i(f),children:"Save and close"})]})},Fa=async({fetchInfo:e,setGitUsers:t,setInputError:s})=>{try{const{results:n=[]}=await ye({fetchInfo:e,queryInfo:Sr,dispatch:()=>{}}),r=[];n.flat().forEach(({node:a})=>{const{name:l,email:c,login:d}=a,i=l?l.replace(",",""):c.split(".")[0];r.push({userId:d,name:i})}),t(r)}catch(n){const r=n;s({level:"error",message:`Api call error: ${(r==null?void 0:r.message)||"unknown"}`})}},Ua=e=>{var i;const{setGitUsers:t}=e,[s,n]=A.useState({}),r={gitTeamUrl:"",token:""},[a,l]=A.useState(r),d={inputError:s,setInputError:n,formInfo:a,setValue:(m,u)=>l({...a,[m]:u})};return o.jsxs("form",{onSubmit:m=>{m.preventDefault();const{gitTeamUrl:u="",token:p=""}=a,h=u.split("/"),g=h.at(-2)||"",x=h.at(-2)||"";[g,x,p].every(f=>f&&f.length>0)?Fa({fetchInfo:{name:g,org:x,token:p},setGitUsers:t,setInputError:n}):n({level:"error",message:"Invalid inputs"})},children:[o.jsx("h4",{children:"Getting team members from a GitHub Org team page"}),o.jsx(H,{type:"gitTeamUrl",...d},"gitTeamUrl"),o.jsx(H,{type:"token",...d}),o.jsx(k,{className:"w-full mr-0 min-h-12",type:"submit",children:"Get team members"}),((i=s==null?void 0:s.message)==null?void 0:i.length)>0&&o.jsx(zt,{error:s})]})},Mo=({setParentValues:e,usersInfo:t={}})=>{const[s,n]=A.useState(!1),[r,a]=A.useState([]),l=r.length>0&&"Edit Github Team members"||Object.keys(t).length>0&&"Edit team members"||"Fill in team by:";return o.jsxs("div",{children:[o.jsxs("p",{className:"mb-1",children:["Team members: ",Object.values(t).map(({name:c,userId:d})=>c||d).join(", ")||"None"]}),o.jsxs(Po,{open:s,onOpenChange:n,children:[o.jsx(Ia,{asChild:!0,children:o.jsx(k,{className:"w-full",type:"button",children:Object.keys(t).length===0?"Add team members":"Edit team members"})}),o.jsxs(Co,{className:"overflow-scroll max-h-full w-4/5",children:[o.jsx(Wt,{children:l}),Object.keys(t).length===0&&o.jsx(Ua,{setGitUsers:a}),o.jsx($a,{gitUsers:r,usersInfo:t,onSubmit:c=>{const d=Object.keys(c).filter(Boolean).length>0;e(d?{usersInfo:c}:{usersInfo:{}}),n(!1)}})]})]})]})},Ga=({fetching:e,preFetchedName:t,pullRequests:s,getDownloadInfo:n})=>{const r=n();return!e&&!t&&s.length>0?o.jsx("p",{children:o.jsx("a",{className:"text-primary",...r,children:"Download report data"})}):null},Va=e=>({fetching:e.fetching,pullRequests:e.pullRequests,preFetchedName:e.preFetchedName}),Ba=e=>({getDownloadInfo:()=>e(wo)}),$o=M(Va,Ba)(Ga),qa=e=>{const{setValues:t,getData:s,fetching:n,reportType:r="repo"}=e,l={repo:"Get community data for any repo",team:"Get community data for any Team(list of users)",user:"Get data for an individual",org:"Get community data for any Org"}[r],i={sortDirection:"DESC",amountOfData:1,token:"",excludeIds:"",enterpriseAPI:"",...{repo:{org:"",repo:""},org:{org:""},team:{usersInfo:{},teamName:""},user:{userId:"",name:""}}[r]},[m,u]=A.useState({}),[p,h]=A.useState(i),g=(E={})=>{const v={...p,...E};h(v)};A.useEffect(()=>{h(i)},[r,h]);const x=(E,v)=>h({...p,[E]:v}),y={inputError:m,setInputError:u,formInfo:p,setValue:x},f=E=>{E.preventDefault();const{isValid:v,validationErrors:b}=Lo(p);u(b),v&&!n&&t(p),v&&!n&&s()},w={repo:[{type:"org"},{type:"repo"}],org:[{type:"org",className:"col-span-full"}],team:[{type:"teamName",className:"col-span-full"}],user:[{type:"userId"},{type:"name"}]}[r];return o.jsxs("div",{className:"mb-3",children:[o.jsx("h3",{children:l}),o.jsxs("form",{onSubmit:f,children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end",children:[w.map(E=>o.jsx(H,{className:E.className,type:E.type,...y},E.type)),r==="team"&&o.jsx(Mo,{usersInfo:p.usersInfo,setParentValues:g}),o.jsx(H,{className:"col-span-full",type:"events",...y}),o.jsx("p",{className:"col-span-full",children:"Key events can give context when viewing the data e.g. started using copilot, launched a feature. These events can help give more context while viewing the data. e.g.  Copilot adopted=2024-02-01,Feature A=2024-04-10."}),o.jsx(H,{type:"token",...y}),o.jsx(To,{className:"mb-3 max-mm:mb-0",setValue:x,amountOfData:p.amountOfData}),o.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",o.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]})]}),o.jsx(de,{className:"mb-0 col-span-full",expandText:"show",intro:"Advanced options",children:o.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end",children:[o.jsx(H,{type:"excludeIds",...y}),o.jsx(H,{type:"enterpriseAPI",...y})]})}),o.jsx(jo,{})]}),o.jsx($o,{})]})},Ka=e=>({fetching:e.fetching,error:e.error}),za=e=>({setValues:t=>{const{org:s,repo:n,token:r,amountOfData:a,sortDirection:l,teamName:c,usersInfo:d={},userId:i,name:m,enterpriseAPI:u,excludeIds:p,events:h}=t;i&&m&&(d[i]={userId:i,name:m,dates:[]}),e(ia({...t,usersInfo:d})),e(po(r)),e(yo(a)),e(Eo(l)),e(Ro(a)),s&&e(sa(s)),n&&e(ra(n)),Object.keys(d).length>0&&e(go(d)),c&&e(na(c)),e(oa(u)),e(fo(p)),h&&e(xo(h))},getData:()=>e(vo())}),at=M(Ka,za)(qa),Ha=({clearReport:e})=>{var y,f;const t=(y=window==null?void 0:window.location)==null?void 0:y.search,n=new URLSearchParams(t).get("report")||((f=Ee[0])==null?void 0:f.fileName)||"facebook-react",a=[...Ao,...It,..._t,...Ot,...Ee].some(S=>S.fileName===n),[l,c]=A.useState("oss"),d=S=>{S!==l&&e(),c(S)},i=Ee.length>0?"Saved and OSS Reports":"OSS Reports",m=Ee.length>0?"Saved Reports":i,u=[...a?[[m,"oss"]]:[],["Make individual report","user"],["Make team report","team"],["Make repo report","repo"],["Make org report","org"]],[p,h]=A.useState(!1),g=p||!a&&l==="oss"?u:[u.find(([,S])=>S===l)||[]],x=l==="oss"?"Make a report...":"Show all";return o.jsxs(Y,{className:"block",children:[o.jsxs("div",{children:[g.map(([S,w],E)=>o.jsx(k,{className:"text-xl normal-case mr-2 mb-3",variant:l===w?void 0:"secondary",onClick:v=>{v.preventDefault(),d(w)},children:S},`${E}`)),o.jsx(k,{className:"text-xl normal-case mr-2 mb-3",variant:p?void 0:"secondary",onClick:S=>{S.preventDefault(),h(!p)},children:p?"Hide unselected":x})]}),Z([[B("oss"),D(o.jsx(Aa,{}))],[B("repo"),D(o.jsx(at,{reportType:"repo"}))],[B("org"),D(o.jsx(at,{reportType:"org"}))],[B("team"),D(o.jsx(at,{reportType:"team"}))],[B("user"),D(o.jsx(at,{reportType:"user"}))]])(l)]})},Wa=e=>({clearReport:()=>e(da)}),Ya=M(()=>({}),Wa)(Ha),Ae=({children:e})=>o.jsx("div",{className:"w-full relative flex flex-col flex-wrap gap-0 items-center 3xl:flex-row 3xl:gap-0 3xl:gap-x-5 3xl:justify-center",children:e}),He='"Nunito", "Roboto", "Helvetica", "Arial", sans-serif',We=12,At={legendOrientation:"horizontal",legendPosition:"top-right",height:10,legendOffsetX:0,legendOffsetY:-4},st=(e="dark")=>{const t={light:"#232023",dark:"#eee"}[e],s={light:"#fff",dark:"#232023"}[e],n={light:"#077314",dark:"#077314"}[e],r={light:"#8b4ff0",dark:"#6b3dba"}[e],a={light:"#87cac6",dark:"#6b3dba"}[e];return{fontFamily:He,fontSize:We,textColor:t,crosshair:{line:{stroke:t}},axis:{legend:{text:{fill:t}},ticks:{text:{fill:t}}},legends:{hidden:{symbol:{fill:"#eee",opacity:1},text:{fill:"#eee",fontWeight:"400",opacity:1}},text:{fontWeight:"800"}},legendsTextFill:t,dotColor:t,tooltip:{container:{fontFamily:He,fontSize:We,background:s,color:t,boxShadow:`0 1px 2px ${t}`}},grid:{line:{stroke:"#999"}},markers:{primary:{lineStyle:{stroke:n,strokeWidth:1},textStyle:{fontFamily:He,fontSize:We,fill:n},...At},secondary:{lineStyle:{stroke:r,strokeWidth:1},textStyle:{fontFamily:He,fontSize:We,fill:r},...At},tertiary:{lineStyle:{stroke:a,strokeWidth:1,strokeDasharray:"2 6"},textStyle:{fontFamily:He,fontSize:We,fill:a},...At}}}},Ve=({className:e="",items:t=[],text:s="",type:n})=>{const r=m=>{const u=t.length-1,p={zero:"",max:" and ",more:", "},h=[m===0&&"zero",m===u&&"max",m>0&&"more"].find(Boolean);return p[h]},a=({color:m,label:u})=>o.jsx("span",{style:{color:m,borderBottomColor:m},className:"saved-line",children:u}),l=({color:m,label:u})=>o.jsx("span",{style:{color:m},children:u}),c={average:"Average",trimmedAverage:"Trimmed Average",sum:"Total",count:"Total",teamDistribution:"",median:"",percentWith:"",growth:"",averagePerDev:""},d=[...new Set(t.map(m=>m.groupMath))],i=(t.length>0&&n==="line"&&d.length<2?d[0]||"average":"")||"";return o.jsxs("h4",{className:e,children:[`${s} `,i&&`${c[i]} `,t.map((m,u)=>o.jsxs(A.Fragment,{children:[r(u),n==="line"?o.jsx(a,{...m}):o.jsx(l,{...m})]},u))]})},Fo=A.forwardRef(({className:e,...t},s)=>o.jsx(Vs,{className:C("grid gap-2",e),...t,ref:s}));Fo.displayName=Vs.displayName;const Lt=A.forwardRef(({className:e,...t},s)=>o.jsx(Bs,{ref:s,className:C("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:o.jsx(_n,{className:"flex items-center justify-center",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-2.5 w-2.5 fill-current text-current",children:o.jsx("circle",{cx:"12",cy:"12",r:"10"})})})}));Lt.displayName=Bs.displayName;const _=["#E82573","#8b4ff0","#1F77B4","#4ECC7A","#DBD523","#EB9830","#D14B41"],L={dark:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#E2E2E2"},light:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#777"}},ae=["average","trimmedAverage","sum","median"],Yt=[{label:"Comments",dataKey:"comments",groupMaths:[...ae,"percentWith","teamDistribution"]},{label:"Code comments",dataKey:"codeComments",groupMaths:[...ae,"percentWith"]},{label:"Review comments",dataKey:"generalComments",groupMaths:[...ae,"percentWith"]},{label:"Approvals",dataKey:"approvals",groupMaths:[...ae,"percentWith","teamDistribution"]},{label:"Additions",dataKey:"additions",groupMaths:ae},{label:"Deletions",dataKey:"deletions",groupMaths:ae},{label:"PR size (additions + deletions)",dataKey:"prSize",groupMaths:ae},{label:"Codebase change (additions - deletions)",dataKey:"growth",groupMaths:["growth"]},{label:"PR count",dataKey:"author",groupMaths:["count","averagePerDev"]},{label:"PR Age(days)",dataKey:"age",groupMaths:ae},{label:"Sentiment",dataKey:"commentSentimentTotalScore",groupMaths:ae},{label:"Sentiment to team",dataKey:"commentSentimentScore",groupMaths:ae},{label:"Sentiment from team",dataKey:"commentAuthorSentimentScore",groupMaths:ae},{label:"Bug count",dataKey:"isBug",groupMaths:["count"]},{label:"Feature count",dataKey:"isFeature",groupMaths:["count"]}],Qa={average:"Average",trimmedAverage:"*Trimmed Average",sum:"Total",count:"Total",median:"Median",teamDistribution:"Team's % spread of",percentWith:"% of PRs with",growth:"",averagePerDev:"Average per Dev"},ps=e=>({color:t,label:s="",dataKey:n,groupMath:r="average"},a)=>o.jsxs("div",{style:{color:t},children:[o.jsx("p",{className:"saved-line text-xl",children:s}),o.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",onClick:l=>{l.preventDefault(),e(n,r)},children:o.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})})]},`${a}`),Uo=e=>[...e.left||[],...e.right||[]],Mt=e=>{const t=Uo(e),s=[];return Yt.forEach(({label:n="",dataKey:r,groupMaths:a=[]})=>{const l=t.filter(d=>(d==null?void 0:d.dataKey)===r),c=a.filter(d=>l.every(i=>(i==null?void 0:i.groupMath)!==d));c.length>0&&s.push({label:n,dataKey:r,groupMaths:c})}),s},Xa=e=>{const s=Uo(e).map(r=>r==null?void 0:r.dataKey);return Yt.find(({dataKey:r})=>!s.includes(r))},Ja=(e,t)=>{const s=Mt(t),n=e.dataKey,r=s.findIndex(a=>a.dataKey===n);return s[r+1]||s[0]||Yt[0]},gs={average:()=>"Average",trimmedAverage:()=>"Trimmed Average",sum:()=>"Total",median:()=>"Median",growth:()=>"Growth",percentWith:({label:e=""}={})=>`% of PRs with ${e}`,teamDistribution:({label:e=""}={})=>`Team's % spread of ${e}`,count:()=>"Total",averagePerDev:({label:e=""}={})=>`Average ${e} per DEV`},Go=({graphInfo:e,setGraph:t=()=>{},graphs:s=[]})=>{var p;const n=Xa(e),[r,a]=A.useState({label:(n==null?void 0:n.label)||"Comments",dataKey:(n==null?void 0:n.dataKey)||"comments",color:s.length>1?_[0]:_[1],lineSide:"left",groupMath:(p=n==null?void 0:n.groupMaths)==null?void 0:p[0]}),l=(h={})=>{a({...r,...h})},c=h=>{h.preventDefault();const{lineSide:g,label:x,groupMath:y}=r,f=e[g]||[];f.push({...r,label:`${Qa[y]} ${x}`,groupMath:y,.../teamDistribution|percentWith/.test(y)&&{yMax:100}});const S={...e,[g]:f},w=s.map(b=>S.graphId===b.graphId?S:b);t(w);const E=Ja(r,S),v=_.findIndex(b=>b===r.color);a({label:E.label,dataKey:E.dataKey,color:_[(v+1)%_.length],lineSide:"left",groupMath:E==null?void 0:E.groupMaths[0]})},d=h=>(g,x)=>{const f=(e[h]||[]).filter(v=>!(v.dataKey===g&&v.groupMath===x)),S={...e,[h]:f},w=s.map(v=>S.graphId===v.graphId?S:v);t(w);const[E]=Mt(S);a({label:E.label,dataKey:E.dataKey,color:_[0],lineSide:"left",groupMath:E.groupMaths[0]})},i=Mt(e),m=i.find(h=>h.dataKey===r.dataKey),u=((m==null?void 0:m.groupMaths)||[]).filter(h=>!/growth/.test(h));return o.jsxs("div",{className:"w-full max-w-mw",children:[i.length>0&&o.jsxs("form",{className:"flex flex-wrap rounded-2xl justify-center paper pt-2 gap-4 mb-3",onSubmit:c,children:[o.jsxs($e,{onValueChange:h=>{const g=i.find(x=>x.dataKey===h);l({dataKey:h,groupMath:g.groupMaths[0],label:g.label})},value:m==null?void 0:m.dataKey,children:[o.jsx(Ne,{className:"w-auto",children:o.jsx(Ue,{children:m==null?void 0:m.label})}),o.jsx(Ce,{children:o.jsx(Fe,{children:i.map(({label:h,dataKey:g})=>o.jsx(J,{value:g,children:h},`${m==null?void 0:m.dataKey}${g}${h}`))})})]}),u.length>0&&o.jsxs($e,{onValueChange:h=>l({groupMath:h}),value:r.groupMath,children:[o.jsx(Ne,{className:"w-auto",children:o.jsx(Ue,{children:gs[r.groupMath](r)})}),o.jsx(Ce,{children:o.jsx(Fe,{children:u.map(h=>o.jsx(J,{value:h,children:gs[h](r)},`${r.dataKey}${h}`))})})]}),o.jsx(Fo,{defaultValue:r.lineSide,onValueChange:h=>l({lineSide:h}),children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Lt,{value:"left",id:"r1"}),o.jsx(Ze,{htmlFor:"r1",children:"Axis: Left"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Lt,{value:"right",id:"r2"}),o.jsx(Ze,{htmlFor:"r2",children:"Right"})]})]})}),o.jsxs($e,{onValueChange:h=>l({color:h}),value:r.color,children:[o.jsx(Ne,{className:"w-auto",children:o.jsx(Ue,{placeholder:o.jsx("div",{style:{backgroundColor:r.color,width:"70px",height:"10px"}})})}),o.jsx(Ce,{children:o.jsx(Fe,{children:_.map(h=>o.jsx(J,{value:h,children:o.jsx("div",{style:{backgroundColor:h,width:"70px",height:"10px"}})},h))})})]}),o.jsx(k,{color:"primary",type:"submit",children:"Add to graph"})]}),o.jsxs("div",{className:"custom-lines",children:[o.jsx("div",{children:(e.left||[]).map(ps(d("left")))}),o.jsx("div",{children:(e.right||[]).map(ps(d("right")))})]})]})},Vo=A.forwardRef(({className:e,...t},s)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:s,className:C("w-full caption-bottom text-sm",e),...t})}));Vo.displayName="Table";const Bo=A.forwardRef(({className:e,...t},s)=>o.jsx("thead",{ref:s,className:C("[&_tr]:border-b",e),...t}));Bo.displayName="TableHeader";const qo=A.forwardRef(({className:e,...t},s)=>o.jsx("tbody",{ref:s,className:C("[&_tr:last-child]:border-0",e),...t}));qo.displayName="TableBody";const Za=A.forwardRef(({className:e,...t},s)=>o.jsx("tfoot",{ref:s,className:C("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Za.displayName="TableFooter";const ct=A.forwardRef(({className:e,...t},s)=>o.jsx("tr",{ref:s,className:C("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ct.displayName="TableRow";const Ko=A.forwardRef(({className:e,...t},s)=>o.jsx("th",{ref:s,className:C("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Ko.displayName="TableHead";const $t=A.forwardRef(({className:e,...t},s)=>o.jsx("td",{ref:s,className:C("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));$t.displayName="TableCell";const el=A.forwardRef(({className:e,...t},s)=>o.jsx("caption",{ref:s,className:C("mt-4 text-sm text-muted-foreground",e),...t}));el.displayName="TableCaption";const tl=({sort:e})=>({asc:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[o.jsx("path",{d:"m5 12 7-7 7 7"}),o.jsx("path",{d:"M12 19V5"})]}),desc:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[o.jsx("path",{d:"M12 5v14"}),o.jsx("path",{d:"m19 12-7 7-7-7"})]}),none:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[o.jsx("path",{d:"m21 16-4 4-4-4"}),o.jsx("path",{d:"M17 20V4"}),o.jsx("path",{d:"m3 8 4-4 4 4"}),o.jsx("path",{d:"M7 4v16"})]})})[e],Ye=e=>({column:t})=>{const s=t.getIsSorted()||"none";return o.jsxs(k,{variant:"link",className:"p-0",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[e,o.jsx(tl,{sort:s})]})},sl=[{accessorKey:"age",header:Ye("PR Age (days)")},{accessorKey:"prSize",header:Ye("PR Size")},{accessorKey:"author",header:Ye("Author")},{accessorKey:"mergedAt",header:Ye("Date"),cell:({row:e})=>{const t=e.getValue("mergedAt");return Pt(new Date(t),"do MMM yy")}},{accessorKey:"url",header:Ye("Link"),cell:({row:e})=>{const t=e.getValue("url"),s=t.split("/").at(-1);return o.jsx("a",{className:"text-primary",href:t,children:s})}}],ol=({dataKeys:e,data:t,addClass:s=""})=>{var m;const[n,r]=A.useState([]),[a,l]=A.useState({pageIndex:0,pageSize:4}),c=[...e,"mergedAt","url"],d=sl.filter(u=>c.includes(u.accessorKey)),i=On({data:t,columns:d,getCoreRowModel:kn(),getPaginationRowModel:Ln(),onSortingChange:r,getSortedRowModel:Mn(),onPaginationChange:l,state:{sorting:n,pagination:a}});return o.jsxs("div",{className:`rounded-md border-2 border-primary mx-50 ${s}`,children:[o.jsxs(Vo,{children:[o.jsx(Bo,{children:i.getHeaderGroups().map(u=>o.jsx(ct,{children:u.headers.map(p=>o.jsx(Ko,{children:p.isPlaceholder?null:Zt(p.column.columnDef.header,p.getContext())},p.id))},u.id))}),o.jsx(qo,{children:(m=i.getRowModel().rows)!=null&&m.length?i.getRowModel().rows.map(u=>o.jsx(ct,{"data-state":u.getIsSelected()&&"selected",children:u.getVisibleCells().map(p=>o.jsx($t,{children:Zt(p.column.columnDef.cell,p.getContext())},p.id))},u.id)):o.jsx(ct,{children:o.jsx($t,{colSpan:d.length,className:"h-24 text-center",children:"No results."})})})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4",children:[o.jsxs("p",{children:[a.pageIndex+1," of ",i.getPageCount()]}),o.jsx(k,{variant:"ghost",size:"sm",onClick:()=>i.previousPage(),disabled:!i.getCanPreviousPage(),children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:o.jsx("path",{d:"m15 18-6-6 6-6"})})}),o.jsx(k,{variant:"ghost",size:"sm",onClick:()=>i.nextPage(),disabled:!i.getCanNextPage(),children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:o.jsx("path",{d:"m9 18 6-6-6-6"})})})]})]})},zo=()=>o.jsx("svg",{className:"w-[22px] h-[22px] fill-background inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:o.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})}),nl=()=>o.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:o.jsx("path",{d:"M15.5 29.5c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM21.938 15.938c0-0.552-0.448-1-1-1h-4v-4c0-0.552-0.447-1-1-1h-1c-0.553 0-1 0.448-1 1v4h-4c-0.553 0-1 0.448-1 1v1c0 0.553 0.447 1 1 1h4v4c0 0.553 0.447 1 1 1h1c0.553 0 1-0.447 1-1v-4h4c0.552 0 1-0.447 1-1v-1z"})}),rl=({showTable:e=!1})=>e?o.jsx(nl,{}):o.jsx(zo,{}),al=({dataKeys:e,data:t,tableOpenedByDefault:s=!1})=>{var h;const[n,r]=A.useState(t.length-1),[a,l]=A.useState(s),c=t.flat(),i=c.length>30?t:[c],m=n===0?"rounded-tl-none":"",u=n===t.length-1?"rounded-tr-none":"",p=m||u||"";return o.jsxs("div",{className:"mb-4",children:[i.length>0&&o.jsx("div",{className:"px-50 flex flex-row justify-stretch gap-x-1",children:i.map((g,x)=>o.jsx(k,{className:`rounded-lg relative w-full px-0 py-1 h-full ${n===x&&a?"slice rounded-t-lg rounded-b-none border-b-4 border-primary hover:bg-primary":"mb-1 bg-secondary hover:bg-secondary"}`,onClick:()=>{n===x&&l(!a),n!==x&&!a&&l(!0),r(x)},children:n===x?o.jsx(rl,{showTable:a}):o.jsx(zo,{})},x))}),((h=i[n])==null?void 0:h.length)>0&&a&&o.jsx(ol,{data:i[n],dataKeys:e,addClass:p})]})},ll=(e,t)=>{const s=e&&es(new Date(e))+1,n=t&&es(new Date(t))+1;return!!(s&&n&&s!==n)},cl=(e,t)=>{const s=e&&it(new Date(e)),n=t&&it(new Date(t));return!!(s&&n&&s!==n)},fs=e=>(t,s)=>{const n=t&&it(new Date(t)),r=s&&it(new Date(s));return!!(n&&r&&n%e>0&&r%e===0)},il=(e,t)=>{const s=e&&dt(new Date(e))+1,n=t&&dt(new Date(t))+1;return!!(s&&n&&s!==n)},dl=e=>(t,s)=>{const n=t&&dt(new Date(t))+1,r=s&&dt(new Date(s))+1;return!!(n&&r&&n%e>0&&r%e===0)},ml=(e,t)=>{const s=e&&ts(new Date(e)),n=t&&ts(new Date(t));return!!(s&&n&&s!==n)},ul={"1day":ll,"1week":cl,"2week":fs(2),"3week":fs(3),"1month":il,"1quarter":dl(3),"1year":ml},hl=(e,t,s=[])=>{const n=[];return s.forEach(r=>{const l=(n.at(-1)||[]).at(-1)||{};!l[e]||ul[t](l[e],r[e])?n.push([r]):n.at(-1).push(r)}),n},pl=(e=[])=>{const{mergedAt:t}=e.at(0),{mergedAt:s}=e.at(-1),n=fe(new Date(s),new Date(t)),r=[{batchType:"1year",maxPoints:Math.ceil(n/365)},{batchType:"1quarter",maxPoints:Math.ceil(n/89)},{batchType:"1month",maxPoints:Math.ceil(n/30)},{batchType:"2week",maxPoints:Math.ceil(n/14)},{batchType:"1week",maxPoints:Math.ceil(n/7)},{batchType:"1day",maxPoints:n}],{batchType:a}=r.reduce((l,c)=>!l.maxPoints||Math.abs(c.maxPoints-15)<Math.abs(l.maxPoints-15)?c:l,{});return hl("mergedAt",a,e)},Ft=(e=[])=>e.length<1?[]:pl(e),Ho=e=>{const t=[];return e.forEach(({data:s})=>{const n=s.map(r=>r.y);t.push(...n)}),t.sort((s,n)=>s-n)},xs=e=>{const t=Ho(e),s=Math.round(t.length*.95),n=t[s]||0,r=t.at(-1)||0,a=n&&Math.round(n/r*100)||0;return n&&a<30?n:r},ys=e=>{const t=Ho(e),s=t.length>0?$n(Math.min,t):0;return s>0?0:s},gl=e=>{const t=new Date(e),s=t.getMonth()+1,n=t.getDate();return`${t.getFullYear()}-${s<10?`0${s}`:s}-${n<10?`0${n}`:n}`},fl=({filteredBatch:e=[]})=>{const t={};return e.forEach(s=>t[s.author]=1),Math.round(e.length/Object.keys(t).length)},xl=({filteredBatch:e=[],dataKey:t="comments"})=>{const s=t,n=e.sort(we([s])),r=n.length,a=r>4?n.slice(Math.ceil(r*.05),Math.floor(r*.95)):n,l=a.reduce((c,d)=>c+(s&&d[s]||0),0)/a.length;return Math.round(l)},yl=({filteredBatch:e=[],dataKey:t="comments"})=>{const s=new Set([]),n={};e.forEach(g=>{const{teamApprovers:x={},teamCommenters:y={}}=g,f=/approvals/i.test(t)?x:y;Object.entries(f).forEach(([w,E])=>{n[w]=(n[w]||0)+E});const S=[...Object.keys(x)||[],...Object.keys(y)||[]];S.length>0&&S.map(w=>s.add(w))});const r={};s.forEach(g=>r[g]=0);const a={...r,...n},l=Object.values(a),c=l.length,d=l.reduce((g,x)=>g+x,0),i=d/c,m=i*(c-1)+(d-i),u=l.reduce((g,x)=>g+Math.abs(x-i),0),p=m-u,h=Math.round(100/m*p);return isNaN(h)?0:h},Rl=({filteredBatch:e=[],dataKey:t="comments"})=>{const s=e.length,r=e.filter(l=>!l[t]).length;return r>0?Math.round((s-r)/s*100):0},El=({filteredBatch:e,dataKey:t="comments"})=>{const s=e.length;return e.sort(we([t]))[Math.floor(s/2)][t]||0},Sl=({filteredBatch:e})=>e.reduce((s=0,{additions:n=0,deletions:r=0})=>s+(n-r),0),vl=({filterForKey:e=!1,dataKey:t,groupMath:s="average"})=>(n=[])=>{const r=[];return n.forEach(a=>{const l=a.filter(d=>t&&e?/\d+/.test(`${d[t]}`):!0),c=l.length;if(!e||c>0){const d={average:()=>c>0?Math.round(Ct(t)(l)/c):0,trimmedAverage:xl,sum:()=>Ct(t)(l),count:()=>c,averagePerDev:fl,median:El,percentWith:Rl,teamDistribution:yl,growth:Sl};r.push({y:d[s]({filteredBatch:l,dataKey:t}),x:gl(a[0].mergedAt)})}}),r},Rs=({lines:e=[],data:t})=>{const s=t&&t.length>0?Ft(t):[],n=[];return e.forEach(r=>{const{label:a,color:l,data:c}=r,d=c&&c.length>0?Ft(c):s,i=vl(r)(d);i.length&&n.push({id:a,color:l,data:i})}),n},wl=(e,t,s)=>{let n,r;s.forEach(({data:d=[]})=>{const i=d[0].x,m=d[d.length-1].x;(!n||new Date(i)<n)&&(n=new Date(i)),(!r||new Date(m)>r)&&(r=new Date(m))});const a={MAJOR:"primary",MINOR:"secondary",PATCH:"tertiary"},l=[0,18,36,54,72,90];return e.filter(({date:d})=>{const i=new Date(d);return i>n&&i<r}).map((d,i)=>({axis:"x",value:new Date(d.date).getTime(),legend:d.description,...t.markers[a[d.releaseType]]||{},legendOffsetY:l[i%l.length]}))},Al=e=>{const t=`${e}`,s=Math.ceil(t.length*.4),[n]=t.split("").reduceRight(([a=[],l=!1],c,d)=>{const i=parseInt(c),m=l?i+1:i,u=d!==0&&(m>9||d>s&&m>4),p=u||d>s?0:m;return[[...a,p],u]},[[],!1]);return n.reverse().join("")},Ie=(e=[])=>{var d,i,m,u;const t=Ft(e),s=t.at(0)||[],n=t.at(-1)||[],r=s.at(0)&&new Date(((d=s.at(0))==null?void 0:d.mergedAt)||((i=s.at(0))==null?void 0:i.createdAt)),a=n.at(0)&&new Date(((m=n.at(0))==null?void 0:m.mergedAt)||((u=n.at(0))==null?void 0:u.createdAt)),l=r&&a?fe(a,r):0,c=[];return t.forEach((p=[])=>{const h=c.length,g=new Date((p.at(0)||{}).mergedAt||(p.at(0)||{}).createdAt),x=fe(g,r),y=Math.floor(x/l*100),f=10*h;h<1||y>=f&&h<10?c.push(p):c.at(-1).push(...p)}),c},bl=(e=[])=>{const t=[];return e.forEach(({data:s=[]})=>{t.push(new Date(s.at(0).x)),t.push(new Date(s.at(-1).x))}),t},Dl=(e=[],t=[])=>{const s=bl([...e,...t]),n=Fn(s),r=Un(s);return Gn(r,n)},Wo=({pullRequests:e=[],showNames:t=!0,usersInfo:s={}})=>{const n={};return e.forEach(l=>{const{author:c}=l,d=n[c]||[];d.push(l),n[c]=d}),[{lines:Object.entries(n).map(([l="",c=[]],d)=>{var m;const i=c.map(u=>({value:1,mergedAt:u.mergedAt}));return{label:t?((m=s[l])==null?void 0:m.name)||l:`${Array(d).fill(" ").join("")}Spartacus`,color:_[d%_.length],dataKey:"value",groupMath:"count",data:i}}),xAxis:"left"}]},Yo=(e="repo",t={})=>{const s=Object.entries(t).sort(([,d],[,i])=>d-i),n=s.slice(-20),r=s.length>19?n.map(([d])=>d):Object.keys(t),a=n.map(([d,i],m)=>({id:d,label:d,color:_[m%_.length],value:i})),l=s.length>r.length?`PR rainbow split by top 20 ${e}s out of ${s.length}`:`PR ${e} rainbow (${r.length})`;return{pieData:a,reportItems:r,pieTitle:`PR by ${e} rainbow`,sectionTitle:l}},Tl=e=>{var n;const t=r=>{const a=r.data.yFormatted,l=r.data.originalY;return/[\d.]/.test(l)?l:a},s=((n=e==null?void 0:e.slice)==null?void 0:n.points)||[];return o.jsx(qs,{rows:s.map((r,a)=>[o.jsx("span",{style:{display:"block",width:"12px",height:"12px",background:r.serieColor}},a),r.serieId,o.jsx("strong",{children:t(r)},a)])})},jl=(e=[])=>({series:t,lineGenerator:s,xScale:n,yScale:r})=>t.map((a={})=>{const{id:l,data:c,color:d}=a,{lineStyles:i={strokeWidth:2}}=e.find(m=>m.label===l)||{};return o.jsx("path",{d:s(c.map(m=>({x:n(m.data.x),y:r(m.data.y)}))),fill:"none",stroke:d,style:i},l)}),Es=(e=[])=>e.filter(t=>t.yMax).map(t=>t.yMax),Ss=(e,t)=>t-e,W=({title:e,combineTitles:t=!1,blockHeading:s=!1,data:n=[],markers:r=[],showLegends:a=!1,tableData:l=[],tableKeys:c=[],graphInfo:d,setGraph:i=()=>{},graphs:m=[],tableOpenedByDefault:u=!1}={})=>{const{theme:p}=q(),h=st(p),{showNumbers:g}=tt(),x=n.find(({xAxis:N})=>N==="left")||{data:[],lines:[],xAxis:"left"},y=Es(x.lines),f=Rs(x),[S]=[...y,xs(f)].sort(Ss),w=ys(f),E=n.find(({xAxis:N})=>N==="right")||{data:[],lines:[],xAxis:"right"},v=Es(E.lines),b=Rs(E),[T]=[...v,xs(b)].sort(Ss),j=ys(b),P=S||T,$=w>j?j:w,K=[];b.forEach(N=>{const O=N.data.map(F=>({y:F.y<0?F.y:Math.round(F.y*(P/T)),x:F.x,originalY:F.y}));O.length&&K.push({...N,data:O})});const ee=x.lines,be=!t&&e||s?[]:ee,te=E.lines,me=[...x.lines,...E.lines],ce=me.map(N=>({label:N.label,default:N.color,current:N.color,clicked:!1})),[se=[],z]=A.useState(ce);(ce.length!==se.length||se.length===1&&se[0].color!==ce[0].color)&&z(ce);const G="rgba(120, 119, 120, 0.27)",ue=(N={})=>{const O=ce.findIndex(F=>F.label===N.label);z(se.map((F,V)=>({...F,current:V===O||F.clicked?F.default:G})))},De=()=>{const N=se.some(O=>O.clicked);z(se.map(O=>({...O,current:N&&O.clicked||!N?O.default:G})))},he=(N={})=>{const O=ce.findIndex(V=>V.label===N.label),F=se.map((V,oe)=>{const Q=oe===O&&!V.clicked;return{...V,current:Q||oe!==O&&V.clicked?V.default:G,clicked:oe===O?Q:V.clicked}});z(F)},ie={anchor:"top-right",direction:"column",justify:!1,translateX:-10,translateY:10,itemsSpacing:0,itemDirection:"right-to-left",itemWidth:80,itemHeight:20,itemOpacity:1,symbolSize:12,symbolShape:"square",symbolBorderColor:"rgba(0, 0, 0, .9)",itemTextColor:h.textColor},Re=[];if(E.lines.length<1&&ee.length>10){const N=[],O=[],F=Math.ceil(ee.length/2);ee.forEach(({label:V,color:oe},Q)=>{const{current:ne}=se.find(pe=>pe.label===V)||{},X={label:V,color:ne||oe};Q<F?N.push(X):O.push(X)}),Re.push({...ie,data:N,anchor:"top-left",direction:"column",translateX:10,itemDirection:"left-to-right"},{...ie,data:O})}const ot=Re.length>0?Re.map(N=>({...N,onMouseEnter:ue,onMouseLeave:De,onClick:he})):[{...ie,onMouseEnter:ue,onMouseLeave:De,onClick:he}],Te=f.concat(K),_e=wl(r,h,Te),je=N=>N.some(O=>((O==null?void 0:O.data)||[]).length),Ke=Dl(f,b)>90?"%Y":"%y/%m";return je(Te)&&o.jsxs("div",{className:"z-10 w-full max-w-mw",children:[d&&m.length>0&&o.jsx(Go,{graphInfo:d,setGraph:i,graphs:m}),o.jsxs("div",{className:"flex flex-wrap justify-between",children:[o.jsx(Ve,{type:"line",text:e,items:be}),!s&&te.length>0&&o.jsx(Ve,{type:"line",items:te})]}),o.jsx("div",{className:"chart-wrap",children:o.jsx(Vn,{margin:{top:14,right:50,bottom:50,left:50},data:Te,colors:se.map(N=>N.current),lineWidth:2,curve:"monotoneX",animate:!1,isInteractive:g,xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:$,max:P},axisBottom:{format:Ke,tickSize:0,tickPadding:10,tickRotation:-45},legends:a?ot:[],axisLeft:{...!g&&{renderTick:void 0},tickSize:0,tickValues:8},pointLabelYOffset:0,..._e.length&&{markers:_e},...K.length&&{axisRight:{...!g&&{renderTick:void 0},tickSize:0,tickValues:8,format:N=>{const O=Math.round(N*(T/P));return N<0?N:Al(O)}}},enableGridX:!1,enableSlices:"x",sliceTooltip:Tl,theme:h,layers:["grid","markers","areas",jl(me),"slices","points","axes","legends"]})}),l.length>0&&o.jsx(al,{data:l,dataKeys:c,tableOpenedByDefault:u})]})},Pl=(e=[],t=[])=>s=>{const n=i=>{const m=i.dataKey;return["isBug","isFeature"].includes(m)?t.filter(({isBug:h=!1})=>h&&m==="isBug"||!h&&m==="isFeature"):e},{left:r=[],right:a=[]}=s,l={lines:r.map(i=>({...i,data:n(i)})),xAxis:"left"},c={lines:a.map(i=>({...i,data:n(i)})),xAxis:"right"};return[...r.length>0?[l]:[],...a.length>0?[c]:[]]},Nl=e=>{const t=[...(e==null?void 0:e.left)||[],...(e==null?void 0:e.right)||[]].map(n=>n.dataKey);return t.length>0?[...t,"author"]:["comments","approvals","age","prSize","author"]};let Cl=1;const Il=()=>++Cl,_l=(e=[])=>{const t=[];return e.forEach(({left:s=[],right:n=[]})=>{s.forEach(r=>(r==null?void 0:r.groupMath)&&t.push(r.groupMath)),n.forEach(r=>(r==null?void 0:r.groupMath)&&t.push(r.groupMath))}),t},Ol=(e=[])=>_l(e).includes("trimmedAverage"),kl=({chunkyData:e=[],pullRequests:t=[],issues:s=[],releases:n=[],tableOpenedByDefault:r=!1})=>{const{theme:a}=q(),l=L[a].secondary,c=L[a].primary,d=[{graphId:1,left:[{label:"*Trimmed Average PR Age (days)",color:l,dataKey:"age",groupMath:"trimmedAverage"}],right:[{label:"*Trimmed Average PR Size",color:c,dataKey:"prSize",groupMath:"trimmedAverage"}]}],[i,m]=A.useState(d),u=Ol(i),p=Pl(t,s);return t.length>0&&o.jsxs(Y,{children:[o.jsxs(de,{title:"Build your own graphs",expandText:"guidance",children:[o.jsx("p",{children:"You can build multiple graphs with data you want to see to help you find insights and track trends."}),o.jsx("p",{children:"Questions worth asking (with team context):"}),o.jsxs("ul",{children:[o.jsx("li",{children:"What metrics do you want to look and and compare against?"}),o.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"}),o.jsx("li",{children:"This graph initially had PR age and size as they are often impactful metrics, what do you think about the trends of these metrics?"})]})]}),o.jsxs(Ae,{children:[i.map((h,g)=>{var y,f;const x=p(h);return((y=h==null?void 0:h.left)==null?void 0:y.length)<1&&((f=h==null?void 0:h.right)==null?void 0:f.length)<1?o.jsx(Go,{graphInfo:h,setGraph:m,graphs:i},g):o.jsx(W,{graphInfo:h,setGraph:m,graphs:i,blockHeading:!0,markers:n,showLegends:!1,data:x,tableKeys:Nl(h),tableData:e,tableOpenedByDefault:g===0&&r},g)}),u&&o.jsx("p",{children:"*Trimmed average is the average after the top and bottom 5% is trimmed."})]}),o.jsxs("div",{className:"flex flex-nowrap basis-full justify-center gap-x-3 mb-08",children:[i.length>1&&o.jsx(k,{variant:"secondary",onClick:h=>{h.preventDefault(),m(i.slice(0,-1))},children:"Remove above graph"}),o.jsx(k,{onClick:h=>{h.preventDefault(),m([...i,{graphId:Il(),left:[],right:[]}])},children:"Add another custom graph"})]})]})},Ll=e=>({issues:e.issues}),Rt=M(Ll)(kl),Qo=(e,t)=>t.some(s=>e.some(n=>n[s])),ut=({data:e=[],bars:t=[],sortBy:s="",indexBy:n="user",max:r=20,title:a=""})=>{const{theme:l}=q(),c=st(l),{showNumbers:d}=tt(),i=js(g=>t.some(x=>g[x.dataKey]),e),m=g=>(x,y)=>+((x[g]||0)<(y[g]||0))||+((x[g]||0)===(y[g]||0))-1,u=s?i.sort(m(s)):i,p=r?u.slice(0,r):u,h=t.map(g=>g.dataKey);return Qo(e,h)&&o.jsxs("div",{className:"w-full max-w-mw mb-4",children:[o.jsx(Ve,{text:a,items:t}),o.jsx("div",{className:"chart-wrap",children:o.jsx(Bn,{data:p,keys:h,indexBy:n,margin:{top:5,right:50,bottom:60,left:50},padding:.3,groupMode:"grouped",layout:"vertical",valueFormat:g=>`${g}`,colors:t.map(g=>g.color),axisBottom:{tickSize:0,tickRotation:-45},axisLeft:{...!d&&{renderTick:void 0},tickSize:0},isInteractive:d,enableLabel:!1,animate:!1,theme:c})})]})},Ml=(e,t,s=!1)=>{const n={},r={};e.forEach(u=>{const p=u.author,h=u[t]||{},g=Nt(Object.values(h));n[p]=g,r[p]=u.name||p});const a=Object.entries(n).sort(([,u],[,p])=>p-u),l=Nt(Object.values(n)),c=u=>{const p=100/l;return u*p},d=[];a.forEach(([u,p])=>{const h=c(p);p>0&&h>5&&d.push(u)});const i=d.length===e.length-1?a.map(([u])=>u):d,m=s?e.filter(u=>i.includes(u.author)).map(u=>u.author):i;return[m,m.map(u=>r[u]||u)]},$l=(e=[],t)=>{const s=Object.entries(t).filter(([r])=>!e.some(a=>a===r));return Nt(s.map(r=>r[1]))},Fl=(e=[],t,s=[],n=!1)=>{const r=c=>[...s.map(d=>{var i;return((i=c==null?void 0:c[t])==null?void 0:i[d])||0}),...n?[$l(s,c[t])]:[]],a=s.map(c=>{const d=e.find(i=>i.author===c);return r(d)});let l=[];return e.forEach(c=>{if(!s.some(d=>d===c.author)){const i=r(c).map((m,u)=>m+(l[u]||0));l=[...i.slice(0,i.length-1),0]}}),[...a,...l.length?[l]:[]]},Ul=({data:e,dataKey:t,preSorted:s,showNames:n=!0})=>{const[r,a]=Ml(e,t,s),l=a.length<e.length,c=Fl(e,t,r,l),d=[...a,...l?["Others"]:[]];return{names:n?d:d.map((i,m)=>`Spartacus${Array(m).fill(" ").join("")}`),matrix:c}},ht=({title:e,data:t=[],preSorted:s=!1,dataKey:n})=>{const{theme:r}=q(),a=st(r),{showNumbers:l}=tt(),{showNames:c}=ve(),{names:d,matrix:i}=Ul({data:t,dataKey:n,preSorted:s,showNames:c});return(u=>u.some(p=>p.some(Boolean)))(i)&&o.jsxs("div",{children:[o.jsx(Ve,{text:e,className:"text-center"}),o.jsx("div",{className:"chord-wrap",children:o.jsx(qn,{label:"id",data:i,keys:d,margin:{top:0,right:10,bottom:10,left:10},arcBorderColor:{from:"color",modifiers:[["darker",.4]]},ribbonOpacity:.5,ribbonBorderWidth:.5,ribbonBorderColor:{from:"color",modifiers:[["darker",.4]]},innerRadiusRatio:.85,labelRotation:0,padAngle:.06,innerRadiusOffset:.03,labelOffset:-23,labelTextColor:{from:"color",modifiers:[["darker",2]]},colors:_,isInteractive:l,activeArcOpacity:1,inactiveArcOpacity:1,activeRibbonOpacity:.75,inactiveRibbonOpacity:.25,animate:!1,motionConfig:"stiff",theme:a})})]})},Xo=({title:e="",data:t=[]})=>{const{theme:s}=q(),n=st(s),{showNumbers:r}=tt();return t.length&&o.jsxs("div",{className:"z-10 w-full max-w-mw",children:[o.jsx("div",{className:"flex flex-wrap justify-between",children:o.jsx(Ve,{type:"line",text:e})}),o.jsx("div",{className:"pie-wrap",children:o.jsx(Kn,{data:t,colors:{datum:"data.color"},margin:{top:15,right:80,bottom:0,left:80},animate:!1,innerRadius:.65,padAngle:1,cornerRadius:4,activeOuterRadiusOffset:5,borderWidth:1,startAngle:-90,endAngle:90,enableArcLabels:!1,arcLinkLabelsSkipAngle:4,arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLinkLabelsDiagonalLength:10,arcLinkLabelsStraightLength:15,arcLinkLabelsTextColor:n.textColor,theme:n,isInteractive:r})})]})},Gl=({pullRequests:e=[],releases:t=[],chunkyData:s=[],usersData:n=[],allRepos:r={},userIds:a=[],usersInfo:l={}})=>{var E,v;const{theme:c}=q(),d=L[c].secondary,i=L[c].primary,{showNames:m}=ve(),u=a.length||15,p=["commentsGiven","approvalsGiven"],h=n.sort(we(p)),g=h.map((b,T)=>{var j;return{commentsGiven:b.commentsGiven,commentsReceived:b.commentsReceived,uniquePRsApproved:b.uniquePRsApproved,totalPRs:b.totalPRs,author:m?b.author:`${Array(T).fill(" ").join("")}Spartacus`,name:m?((j=l[b.author])==null?void 0:j.name)||b.author:`${Array(T).fill(" ").join("")}Spartacus`}}),x=h.map(b=>{var T;return{...b,name:((T=l[b.author])==null?void 0:T.name)||b.author}}),y=Yo("repo",r),f=Wo({pullRequests:e,showNames:m,usersInfo:l}),S=x.filter(b=>b.approvalsGiven>0).length,w=x.filter(b=>b.commentsGiven>0).length;return n.length>0&&o.jsxs(Y,{children:[o.jsxs(de,{title:"Contributions",expandText:"guidance",children:[o.jsx("p",{children:"Questions worth asking (with team context):"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Is there a bus factor risk?"}),o.jsx("li",{children:"Are there any data points that stand out?"}),o.jsx("li",{children:"How do the given and received metrics look?"}),o.jsx("li",{children:"How well spread are the collaboration metrics?"}),o.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),o.jsxs(Ae,{children:[o.jsxs("div",{className:"flex flex-wrap justify-center w-full",children:[o.jsxs("div",{className:"w-1/2 max-mm:w-full",children:[o.jsx(ut,{data:g,indexBy:"name",title:"Comments",sortBy:"commentsGiven",max:u,bars:[{dataKey:"commentsGiven",color:d,label:"given"},{dataKey:"commentsReceived",color:i,label:"*received"}]}),o.jsx("p",{children:"*Received comments can also come from out of team so can be higher."})]}),o.jsx("div",{className:"w-1/2 max-mm:w-full",children:o.jsx(ut,{data:g,indexBy:"name",title:"PRs",sortBy:"uniquePRsApproved",max:u,bars:[{dataKey:"uniquePRsApproved",color:d,label:"approved"},{dataKey:"totalPRs",color:i,label:"opened"}]})})]}),(w>0||S>0)&&o.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[w>0&&o.jsx(ht,{data:x,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),S>0&&o.jsx(ht,{data:x,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),o.jsx("p",{children:"These chord charts show how contributions are given and received, the dominant colour indicates more contribution"}),f.length>0&&((v=(E=f==null?void 0:f[0])==null?void 0:E.lines)==null?void 0:v.length)<21&&o.jsx(W,{title:"PRs by author",markers:t,showLegends:!0,data:f,tableData:s,tableKeys:["author","repo"]}),y.pieData.length>0&&o.jsx(Xo,{data:y.pieData,title:y.sectionTitle})]})]})},Vl=e=>({usersData:e.usersData,userIds:e.fetches.userIds,usersInfo:e.fetches.usersInfo}),Qt=M(Vl)(Gl),Jo=A.forwardRef(({className:e,...t},s)=>o.jsx(Ks,{className:C("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:s,children:o.jsx(zn,{className:C("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Jo.displayName=Ks.displayName;const Bl=e=>{const{setValues:t,getData:s,fetches:n,fetching:r}=e,{repo:a,org:l,excludeIds:c=[],userIds:d=[],usersInfo:i={},events:m=[]}=n,u=d.length>1&&"team"||d.length===1&&"user"||!a&&l&&"org"||"repo",p=m.map(({name:P,date:$})=>`${P}=${$}`).join(", "),h=c.join(", "),[g,x]=A.useState({sortDirection:n.sortDirection,amountOfData:n.amountOfData||"all",token:n.token,...p&&{events:p},...h&&{excludeIds:h},...n.org&&{org:n.org},...n.repo&&{repo:n.repo}}),[y,f]=A.useState({}),S=(P,$)=>x({...g,[P]:$}),w=(P={})=>{const $={...g,...P};x($)},E={inputError:y,setInputError:f,formInfo:g,setValue:S},v=P=>{P.preventDefault();const{isValid:$,validationErrors:K}=Lo(g);f(K),$&&!r&&t(g),$&&!r&&s()},j=[...{repo:["org","repo"],org:["org"],team:["teamName"],user:["userId","name"]}[u],"enterpriseAPI"];return o.jsx(de,{className:"mb-0 col-span-full",title:"",expandText:"here",intro:"Top up this report's data",expandQaId:"expand-prefetch-form",children:o.jsxs("div",{className:"mb-3",children:[o.jsxs("form",{onSubmit:v,children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end mb-4",children:[o.jsxs("div",{className:"col-span-full",children:[j.filter(P=>kt(n,P)).map(P=>o.jsxs("p",{children:[Oo[P],": ",o.jsx("b",{children:kt(n,P)})]},P)),u==="team"&&o.jsx(Mo,{usersInfo:i,setParentValues:w})]}),o.jsx(H,{type:"events",className:"col-span-full",...E}),o.jsx("p",{className:"col-span-full",children:"Key events can impact the data e.g. starting or launching a new feature or major version. These events can help give more context while viewing the data. e.g. ProjectA=2013-12-01."}),o.jsx(H,{type:"excludeIds",...E}),o.jsx(H,{type:"token",...E}),o.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",o.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]}),o.jsxs($e,{onValueChange:P=>S("sortDirection",P),value:g.sortDirection,children:[o.jsx(Ne,{className:"w-auto",children:o.jsx(Ue,{children:g.sortDirection==="DESC"?"Prepend data":"Append data"})}),o.jsx(Ce,{children:o.jsxs(Fe,{children:[o.jsx(J,{value:"DESC",children:"Prepend data"}),o.jsx(J,{value:"ASC",children:"Append data"})]})})]}),o.jsx(To,{setValue:S,amountOfData:g.amountOfData})]}),o.jsx(jo,{qaId:"prefetch-top-up"})]}),o.jsx($o,{})]})})},ql=e=>({fetches:e.fetches,fetching:e.fetching,error:e.error,pullRequests:e.pullRequests}),Kl=e=>({setValues:t=>{const{token:s,amountOfData:n,sortDirection:r,excludeIds:a,events:l,userId:c,usersInfo:d={},name:i}=t;c&&i&&(d[c]={userId:c,name:i}),e(ya(r)),e(po(s)),e(fo(a)),e(yo(n)),e(Eo(r)),e(Ro(n)),e(xo(l)),Object.keys(d).length>0&&e(go(d))},getData:()=>e(vo()),getDownloadInfo:()=>e(wo)}),zl=M(ql,Kl)(Bl),Zo=A.forwardRef(({className:e,...t},s)=>o.jsxs(zs,{ref:s,className:C("relative flex w-full touch-none select-none items-center",e),...t,children:[o.jsx(Hn,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:o.jsx(Wn,{className:"absolute h-full bg-primary"})}),o.jsx(ss,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}),o.jsx(ss,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Zo.displayName=zs.displayName;const Hl=({pullRequests:e=[],itemsDateRange:t=["",""],issues:s=[],usersInfo:n,trim:r})=>{const[a,l]=t,c=a?fe(new Date(l),new Date(a)):0,d=c/100,[[i,m],u]=A.useState([0,100]),p=Math.floor(d*i),h=Math.ceil(d*m),g=a?os(Tt(new Date(a),{days:p}),{representation:"date"}):"",x=l?os(Dt(new Date(l),{days:c-h}),{representation:"date"}):"",y=v=>{Array.isArray(v)&&v.length===2&&u(v)},f=()=>{r(g,x)},S=Object.keys(n).length,w=S>1?`by ${S} contributors`:"",E=s.length>0?`and ${s.length} issues`:"";return e.length>0&&g&&o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"w-full",children:[o.jsxs("b",{children:["Showing ",e.length," PRs ",w," ",E]}),". Drag the points to change the date range of the report."]}),o.jsxs("div",{className:"w-full flex justify-between",children:[o.jsx("p",{className:"text-2xl mb-1",children:Pt(new Date(g),"do MMM yy")}),o.jsx("p",{className:"text-2xl mb-1",children:Pt(new Date(x),"do MMM yy")})]}),o.jsx(Zo,{value:[i,m],onValueChange:y,onValueCommit:f,className:"pb-08"})]})},Wl=e=>({pullRequests:e.pullRequests,issues:e.issues,itemsDateRange:e.itemsDateRange,usersInfo:e.fetches.usersInfo}),Yl=e=>({trim:(t,s)=>e(pa(t,s))}),Ql=M(Wl,Yl)(Hl),Xl=e=>{const{repo:t="",org:s="",teamName:n="",usersInfo:r={},userIds:a=[],colorA:l="",colorB:c=""}=e,{userId:d="",name:i=""}=r[a[0]]||{},m=s||n||i||d,u=!n&&i&&d||t&&s!==t&&t||"",p=u?l:c;return o.jsxs(o.Fragment,{children:[o.jsx("span",{style:{color:p},children:m}),u&&o.jsxs(o.Fragment,{children:["/",o.jsx("span",{style:{color:c},children:u})]})]})},Jl=({fetches:e,preFetchedName:t="",pullRequests:s=[],issues:n=[],userIds:r=[],reportDescription:a=""})=>{const{theme:l}=q(),c=L[l].secondary,d=L[l].primary,{showNames:i,toggleShowNames:m}=ve();return(s.length>0||n.length>0)&&o.jsxs(Y,{children:[o.jsx("h2",{"data-qa-id":"report-title",children:o.jsx(Xl,{...e,colorA:c,colorB:d})}),a&&o.jsx("p",{children:a}),r.length>1&&o.jsxs("p",{children:["Team's GitHub IDs: ",r.join(", ")]}),o.jsxs("div",{className:"flex items-center space-x-2 pb-08",children:[o.jsx(Jo,{id:"spartacus-mode",onCheckedChange:m,checked:!i,name:"checkedA",className:"dark:data-[state=unchecked]:bg-white"}),o.jsx(Ze,{htmlFor:"spartacus-mode",children:"Hide GitHub ids/names, this can help look for trends."})]}),o.jsx(Ql,{}),t.length>0&&o.jsx(zl,{})]})},Zl=e=>({fetches:e.fetches,preFetchedName:e.preFetchedName,pullRequests:e.pullRequests,issues:e.issues,userIds:e.fetches.userIds,reportDescription:e.reportDescription}),Et=M(Zl)(Jl),ec=({chunkyData:e=[],pullRequests:t=[],releases:s=[],userIds:n=[],usersInfo:r={}})=>{const{theme:a}=q(),l=L[a].secondary,c=L[a].primary,d=L[a].tertiary,{showNames:i}=ve(),m=n.length>0,u=m?Wo({pullRequests:t,showNames:i,usersInfo:r}):[];return t.length>0&&o.jsxs(Y,{children:[o.jsx(de,{title:"Pull Request trends",children:s.length>1&&o.jsx("div",{children:o.jsx("p",{children:"Vertical lines are releases: Green is a Major release, solid purple is Minor and dotted purple is Patch or Alpha"})})}),o.jsxs(Ae,{children:[m&&o.jsx(o.Fragment,{children:o.jsx(W,{title:"PRs by author",markers:s,showLegends:!0,data:u,tableData:e,tableKeys:["author","repo"]})}),o.jsx(W,{markers:s,data:[{lines:[{label:"PRs over time",color:l,dataKey:"url",groupMath:"count"}],xAxis:"left",data:t}],tableData:e,tableKeys:["author"]}),o.jsx(W,{markers:s,data:[{lines:[{label:"Comments",color:l,dataKey:"comments"},{label:"Approvals",color:c,dataKey:"approvals"}],xAxis:"left",data:t},{lines:[{label:"PR Size",color:d,dataKey:"prSize"}],xAxis:"right",data:t}],tableData:e,tableKeys:["comments","approvals","prSize","author"]}),o.jsx(W,{markers:s,data:[{lines:[{label:"Age (days)",color:c,dataKey:"age"}],xAxis:"left",data:t},{lines:[{label:"PR Size",color:d,dataKey:"prSize"}],xAxis:"right",data:t}],tableData:e,tableKeys:["age","prSize","author"]})]})]})},tc=e=>({releases:e.releases,userIds:e.fetches.userIds,usersInfo:e.fetches.usersInfo}),en=M(tc)(ec),sc=({pullRequests:e=[],events:t=[]})=>{const s={},n=e.map((l={},c)=>(s[l.repo]=(s[l.repo]||0)+1,{...l,id:`${c}-${l.repo}-${l.number}`,[`repo-${l.repo}`]:1,commentSentimentTotalScore:(l.commentSentimentScore||0)+(l.commentAuthorSentimentScore||0)})),r=Ie(n),a=ho({events:t});return o.jsxs(o.Fragment,{children:[o.jsx(Et,{}),o.jsx(Qt,{pullRequests:n,chunkyData:r,releases:a,allRepos:s}),o.jsx(Rt,{pullRequests:n,chunkyData:r,releases:a,tableOpenedByDefault:!0}),o.jsx(en,{pullRequests:n,chunkyData:r})]})},oc=e=>({pullRequests:e.pullRequests,events:e.fetches.events}),nc=M(oc)(sc),rc=(e=[])=>e.map(t=>({mergedAt:t.mergedAt,...t.isBug?{bug:1}:{issue:1}})),ac=({issues:e=[],releases:t=[]})=>{const{theme:s}=q(),n=L[s].secondary,r=L[s].primary,a=rc(e),l=Ie(e);return a&&a.length>0&&o.jsxs(Y,{children:[o.jsx(de,{title:"Feature and bug trends"}),o.jsx(Ae,{children:o.jsx(W,{markers:t,data:[{lines:[{label:"Issues",color:n,filterForKey:!0,dataKey:"issue",groupMath:"count"},{label:"Bugs*",color:r,filterForKey:!0,dataKey:"bug",groupMath:"count"}],xAxis:"left",data:a}],tableKeys:["isBug"],tableData:l})}),o.jsx("p",{className:"w-full text-center",children:"*Bugs in this graph are issues that have a title or a label that contains the word 'bug'"})]})},lc=e=>({issues:e.issues,releases:e.releases}),Xt=M(lc)(ac),cc=({chunkyData:e=[],pullRequests:t=[],releases:s=[],userIds:n=[]})=>{const{showNames:r}=ve(),a=n.map((l,c)=>{const d=r?l:`Spartacus${Array(c).fill(" ").join("")}`;return[{label:`To ${d}`,color:_[c%_.length],filterForKey:!0,dataKey:`${l}-commentsSentimentScore`},{label:`From ${d}`,color:_[c%_.length],filterForKey:!0,dataKey:`${l}-commentAuthorSentimentScore`}]}).flat();return t.length>0&&o.jsx(o.Fragment,{children:o.jsxs(Y,{children:[o.jsx(de,{title:"Sentiment analysis*",children:o.jsxs("div",{children:[o.jsx("p",{children:"*Adding this is an experiment to see if it can provide useful insights."}),o.jsxs("p",{children:["Uses npm package ",o.jsx("a",{className:"text-primary",href:"https://github.com/thisandagain/sentiment",children:"sentiment"})," which uses AFINN-165 word list and Emoji ranking to perform sentiment analysis."]})]})}),o.jsxs(Ae,{children:[o.jsx(W,{markers:s,showLegends:!0,title:"Sentiment in PRs between team and reviewers",data:[{lines:[{label:"To team",color:_[0],dataKey:"commentSentimentScore"},{label:"From team",color:_[2],dataKey:"commentAuthorSentimentScore"}],xAxis:"left",data:t}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e}),n.length>0&&o.jsx(o.Fragment,{children:o.jsx(W,{showLegends:!0,title:"Sentiment in PRs between authors and reviewers",data:[{lines:a,xAxis:"left",data:t}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e})})]})]})})},ic=e=>({releases:e.releases,userIds:e.fetches.userIds}),dc=M(ic)(cc),mc=e=>({index:t,data:s})=>{const n=e.find(a=>a.area===t),r=s.map(({id:a,color:l})=>[o.jsx(Qn,{color:l},a),a,n[`${a}Original`]]);return o.jsx(qs,{title:o.jsx("strong",{children:t}),rows:r})},uc=({title:e="",showTitle:t=!0,data:s=[],keys:n=[],colors:r=[],width:a=410,height:l=300})=>{const{theme:c}=q(),d=st(c),i=L[c].secondary,m=L[c].primary,u=r.length>0?r:[i,m],{showNumbers:p}=tt();return Qo(s,n)&&o.jsxs("div",{children:[t&&o.jsx(Ve,{className:"text-center",items:[{label:e,color:m}]}),o.jsx(Yn,{width:a,height:l,margin:{top:0,bottom:0,right:100,left:100},dotSize:8,dotBorderColor:d.dotColor,dotBorderWidth:2,colors:u,gridShape:"linear",enableDotLabel:!1,gridLabelOffset:10,gridLevels:3,animate:!1,indexBy:"area",keys:n,data:s,maxValue:100,theme:d,sliceTooltip:mc(s),isInteractive:p})]})},hc=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0},n=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],a=e.filter(p=>n.some(x=>p[x]>1)).sort(we(n)),l=Math.ceil(a.length/100*10),c=l>10?a.slice(0,l):a,d={};c.filter(p=>!t).forEach(p=>{Object.entries(p).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,g])=>{const x=d[h]||0;d[h]=+g+x})});const i=c.length,m={...s,user:"Peers",userCount:i};Object.entries(d).forEach(([p,h])=>{m[p]=Math.round(h/i)}),e.find(p=>p.author===t);const u=s;return e.forEach(p=>{Object.entries(p).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,g])=>{const x=u[h]||0,y=+g;u[h]=x>y?x:y})}),{averagedData:m,maxValues:u,users:e,user:{}}},pc=({maxValues:e={},users:t=[]},s)=>{const n=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],r=s?t:t.sort(we(n)).slice(0,6),a=[{area:"Comments received",dataKey:"commentsReceived"},{area:"Comments given",dataKey:"commentsGiven"},{area:"Approved PRs",dataKey:"uniquePRsApproved"},{area:"PR count",dataKey:"totalPRs"},{area:"PR size",dataKey:"prSize"}];return r.map(c=>{const d=a.map(({area:i,dataKey:m})=>{const u=c[m]||0,p=e[m]||0;return{area:i,value:u&&p?u/p*100:0,valueOriginal:u}});return{title:c.author,data:d,keys:["value"]}})},gc=({usersData:e=[],userIds:t=[],usersInfo:s={}})=>{const{theme:n}=q(),{togglePvPPage:r,setUserPage:a}=qe(),l=L[n].secondary,c=L[n].primary,{showNames:d}=ve(),i=hc(e),m=pc(i,t.length>0),u=t.length>0,p=u?"Team members":"Top contributors";return m.length>0&&o.jsxs(Y,{className:"flex flex-wrap flex-row justify-center",children:[o.jsx(de,{title:p}),m.map((h,g)=>{var f;const x=h.title,y=((f=s[x])==null?void 0:f.name)||x;return o.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[o.jsx(uc,{showTitle:!1,height:240,colors:[(g+1)%2===0?l:c],...h}),o.jsx(k,{variant:(g+1)%2===0?"secondary":void 0,onClick:S=>{S.preventDefault(),a(x),window&&window.scrollTo(0,0)},children:d?y:"Spartacus"})]},g)}),u&&o.jsx(k,{className:"w-full mb-4",color:"primary",onClick:h=>{h.preventDefault(),r(),window&&window.scrollTo(0,0)},children:"PvP arena"})]})},fc=e=>({usersData:e.usersData,userIds:e.fetches.userIds,usersInfo:e.fetches.usersInfo}),tn=M(fc)(gc),xc=({usersData:e=[]})=>{const{showNames:t}=ve(),{togglePvPPage:s,setUserPage:n}=qe();return e.length>0&&o.jsx(o.Fragment,{children:o.jsxs(Y,{className:"justify-between",children:[o.jsx(k,{className:"w-full mb-4",color:"primary",onClick:r=>{r.preventDefault(),s(),window&&window.scrollTo(0,0)},children:"PvP arena"}),o.jsx("h3",{className:"w-full",children:"User pages"}),o.jsx("div",{className:"flex flex-wrap justify-between gap-2",children:e.map(({author:r,user:a},l)=>o.jsx(k,{className:"flex-grow",variant:"secondary",onClick:c=>{c.preventDefault(),n(a),window&&window.scrollTo(0,0)},children:t?r:"Spartacus"},`${l}`))})]})})},yc=e=>({usersData:e.usersData}),Rc=M(yc)(xc),Ec=({pullRequests:e=[],releases:t=[]})=>{const s=e.map((r,a)=>({...r,id:`${a}-${r.repo}-${r.number}`,commentSentimentTotalScore:(r.commentSentimentScore||0)+(r.commentAuthorSentimentScore||0),[`${r.author}-commentsSentimentScore`]:r.commentSentimentScore,[`${r.author}-commentAuthorSentimentScore`]:r.commentAuthorSentimentScore})),n=Ie(s);return o.jsxs(o.Fragment,{children:[o.jsx(Et,{}),o.jsx(Qt,{pullRequests:s,chunkyData:n}),o.jsx(Rt,{pullRequests:s,chunkyData:n,releases:t,tableOpenedByDefault:!0}),o.jsx(dc,{pullRequests:s,chunkyData:n}),o.jsx(en,{pullRequests:s,chunkyData:n}),o.jsx(Xt,{}),o.jsx(tn,{}),o.jsx(Rc,{})]})},Sc=e=>({pullRequests:e.pullRequests,releases:e.releases}),vc=M(Sc)(Ec),vs=({player:e="",className:t="",otherPlayer:s,setPlayerId:n,players:r=[]})=>o.jsxs($e,{value:e,onValueChange:a=>n(a),children:[o.jsx(Ne,{className:`text-3xl w-auto ${t}`,children:o.jsx(Ue,{children:e})}),o.jsx(Ce,{children:o.jsx(Fe,{children:r.filter(({author:a})=>a!==s).map(({author:a,name:l})=>o.jsx(J,{value:a,children:l},a))})})]}),sn=({player1:e,player2:t,setPlayer1Id:s=()=>({}),setPlayer2Id:n=()=>({}),players:r=[]})=>{const{theme:a}=q(),l=L[a].secondary,c=L[a].primary,i=[{title:"Total Merged",id:"totalPRs"},{title:"Total approved",id:"uniquePRsApproved"},{title:"Comments given",id:"commentsGiven"},{title:"Comments received",id:"commentsReceived"},{title:"Average positive sentiment",id:"sentimentAveragePositiveScore"},{title:"Average negative sentiment",id:"sentimentAverageNegativeScore"},{title:"Average size",id:"prSize"},{title:"Total additions",id:"prTotalAdditions"},{title:"Total deletions",id:"prTotalDeletions"},{title:"Average days open",id:"age"},{title:"Orgs contributed to",id:"orgCount"},{title:"Repos contributed to",id:"repoCount"}].filter(({id:m})=>Number.isInteger(e[m])&&Number.isInteger(t[m])&&(!["orgCount","repoCount"].includes(m)||["orgCount","repoCount"].includes(m)&&e[m]!==1&&t[m]!==1)).map(m=>{const u=m.id,p=e[u],h=t[u],g=l,x=c,y=Math.ceil(100*p/(p+h)),f=100-y;return{...m,lValue:p,lColor:g,lPercent:y,rValue:h,rColor:x,rPercent:f}});return o.jsxs("div",{className:"w-full flex flex-col items-center basis-full",children:[o.jsx("div",{className:"w-full flex flex-nowrap justify-between mb-4 max-w-mw",children:r.length>0?o.jsxs(o.Fragment,{children:[o.jsx(vs,{player:e.author,className:"text-secondary",otherPlayer:t.author,setPlayerId:s,players:r}),o.jsx(vs,{player:t.author,className:"text-primary",otherPlayer:e.author,setPlayerId:n,players:r})]}):o.jsxs(o.Fragment,{children:[o.jsx("h3",{style:{color:l,margin:0},children:e.name}),o.jsx("h3",{style:{color:c,margin:0},children:t.name})]})}),i.map((m,u)=>o.jsxs("div",{className:"w-full relative max-w-mw mb-2",children:[o.jsx("p",{className:"z-[1] absolute w-full top-2 text-center m-0",children:m.title}),o.jsxs("div",{className:"w-full flex flex-nowrap content-stretch justify-between",children:[o.jsx("div",{className:"relative h-9",style:{width:`${m.lPercent}%`,backgroundColor:`${m.lColor}`},children:o.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 left-2 text-left m-0",children:m.lValue})}),o.jsx("div",{className:"relative h-9",style:{width:`${m.rPercent}%`,backgroundColor:`${m.rColor}`},children:o.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 right-2 text-right m-0",children:m.rValue})})]},m.id)]},`${m.id}${u}`))]})},wc=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,prTotalAdditions:0,prTotalDeletions:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0,sentimentAveragePositiveScore:0,sentimentAverageNegativeScore:0,orgCount:0,repoCount:0},n=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"],a=e.filter(h=>{const g=h.author!==t,x=n.some(y=>h[y]>1);return g&&x}).sort(we(n)),l=Math.ceil(a.length/100*10),c=l>10?a.slice(0,l):a,d={};c.filter(h=>h.author!==t).forEach(h=>{Object.entries(h).filter(([,g])=>!Array.isArray(g)&&/^\d+$/.test(g)&&g>0).forEach(([g,x])=>{const y=d[g]||0;d[g]=+x+y})});const i=c.length,m={...s};Object.entries(d).forEach(([h,g])=>{m[h]=Math.round(g/i)});const u={...m,user:"Peers",name:"Peers"},p=e.find(h=>h.author===t)||{approvalsGivenByTeam:{}};return[{...p,user:p.author,name:p.name||p.author},u,i]},Ac=(e=[],t=[],s,n,r)=>{const a=[],l=[],c=new Set;e.forEach(u=>{const{author:p,repo:h}=u;c.add(h),u[`repo-${h}`]=1,p===s?l.push(u):a.push(u)});const d=[];Array.from(c).forEach((u,p)=>{d.push({label:u,color:_[p%_.length],groupMath:"count",filterForKey:!0,dataKey:`repo-${u}`,data:l})});const m=Ie(l);return[{markers:t,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${s} received`,color:_[2],dataKey:"commentSentimentScore",data:l},{label:`${s} given`,color:_[1],dataKey:"commentAuthorSentimentScore",data:l},{label:"Peer received",color:_[4],dataKey:"commentSentimentScore",data:a},{label:"Peer given",color:_[5],dataKey:"commentAuthorSentimentScore",data:a}],xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore"],tableData:m},{markers:t,data:[{lines:[{label:"User PR size",color:n,dataKey:"prSize",data:l},{label:"Peer PR size",color:r,dataKey:"prSize",data:a}],xAxis:"left"}],tableKeys:["prSize"],tableData:m},{markers:t,data:[{lines:[{label:"User PR age",color:n,dataKey:"age",data:l},{label:"Peer PR age",color:r,dataKey:"age",data:a}],xAxis:"left"}],tableKeys:["age"],tableData:m}]},bc=({pullRequests:e=[],releases:t=[],usersData:s=[]})=>{const{userPage:n,clearUserPage:r}=qe(),{theme:a}=q(),l=L[a].secondary,c=L[a].primary,d=Ac(e,t,n,l,c),[i,m,u]=wc(s,n),p=i.name||n;return o.jsxs(Y,{children:[o.jsx(k,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),r(),window&&window.scrollTo(0,0)},children:"Back to main view"}),o.jsxs("p",{className:"w-full text-center",children:["A collection metrics showing ",p,"'s data and average data from the top ",u," peers"]}),o.jsx(sn,{player1:i,player2:m}),d.length&&d.map((h,g)=>o.jsx(W,{...h},`${g}-${n}`)),o.jsx(k,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),r(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})},Dc=e=>({pullRequests:e.pullRequests,releases:e.releases,usersData:e.usersData}),Tc=M(Dc)(bc),jc=I("",["location","search"],window),on=new URLSearchParams(jc),Pc=(e=[])=>{var t;return on.get("player1")||((t=e[0])==null?void 0:t.author)},Nc=(e=[])=>{var t;return on.get("player2")||((t=e[1])==null?void 0:t.author)},Cc=({pullRequests:e=[],releases:t=[],usersData:s=[]})=>{const{togglePvPPage:n}=qe(),{theme:r}=q(),a=L[r].secondary,l=L[r].primary,[c,d]=A.useState(Pc(s)),[i,m]=A.useState(Nc(s)),u=s.find(f=>f.author===c),p=s.find(f=>f.author===i),h=[],g=[],x=[];e.forEach(f=>{const S=f.author;S===c?(h.push(f),x.push(f)):S===i&&(g.push(f),x.push(f))});const y=Ie(x);return s.length>0&&o.jsx(o.Fragment,{children:o.jsxs(Y,{children:[o.jsx(k,{className:"w-full mr-0 mb-4",color:"secondary",onClick:f=>{f.preventDefault(),n()},children:"Back to main view"}),o.jsx("p",{className:"w-full text-center",children:"This page is just for fun, a bigger or smaller number could be good, bad or not mean much, it depends on context."}),o.jsx(sn,{player1:u,player2:p,setPlayer1Id:d,setPlayer2Id:m,players:s}),o.jsx("p",{className:"w-full text-center",children:"And the winner is.... Both! Thanks for your great work!"}),o.jsxs(Ae,{children:[o.jsx(W,{markers:t,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${u.name} received`,color:_[0],dataKey:"commentSentimentScore",data:h},{label:`${u.name} given`,color:_[2],dataKey:"commentAuthorSentimentScore",data:h},{label:`${p.name} received`,color:_[0],dataKey:"commentSentimentScore",data:g},{label:`${p.name} given`,color:_[2],dataKey:"commentAuthorSentimentScore",data:g}],xAxis:"left"}],tableData:y,tableKeys:["author","commentSentimentScore","commentAuthorSentimentScore"]}),o.jsx(W,{markers:t,data:[{lines:[{label:`${u.name} PR size`,color:a,dataKey:"prSize",data:h},{label:`${p.name} PR size`,color:l,dataKey:"prSize",data:g}],xAxis:"left"}],tableKeys:["author","prSize"],tableData:y}),o.jsx(W,{markers:t,data:[{lines:[{label:`${u.name} PR age`,color:a,dataKey:"age",data:h},{label:`${p.name} PR age`,color:l,dataKey:"age",data:g}],xAxis:"left"}],tableKeys:["author","age"],tableData:y})]}),o.jsx(k,{className:"w-full mr-0 mb-4",color:"secondary",onClick:f=>{f.preventDefault(),n(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})})},Ic=e=>({pullRequests:e.pullRequests,releases:e.releases,usersData:e.usersData}),_c=M(Ic)(Cc),Oc=({pullRequests:e=[],releases:t=[]})=>{const{theme:s}=q(),n=L[s].secondary,r=L[s].primary;return e.length>0&&o.jsxs(Y,{children:[o.jsxs(de,{title:"Team's contribution spread",expandText:"guidance",children:[o.jsx("p",{children:"Questions worth asking (with team context):"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Is there a healthy percentage spread?"}),o.jsx("li",{children:"Are the Approval and comments spreads similar?"}),o.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),o.jsx("p",{children:"Y axis is the percentage spread of approvals and comments within the active team*, 100% is an EVEN spread across the team, 0% is contribution from only ONE engineer."}),o.jsx(Ae,{children:o.jsx(W,{title:"Percentage spread within team for ",markers:t,data:[{lines:[{label:"Comments given",color:n,dataKey:"comments",groupMath:"teamDistribution",yMax:100},{label:"Approvals given",color:r,dataKey:"approvals",groupMath:"teamDistribution",yMax:100}],xAxis:"left",data:e}]})}),o.jsx("p",{children:"*Active team per data point are those who have approved, commented or raised a PR within that time frame."})]})},kc=({pullRequests:e=[],userIds:t=[],events:s=[],usersInfo:n={}})=>{const r=i=>{const m={};return t.forEach(u=>{const p=i==null?void 0:i[u];p&&(m[u]=p)}),m},a={},l=e.map((i,m)=>(a[i.repo]=(a[i.repo]||0)+1,{...i,id:`${m}-${i.repo}-${i.number}`,teamApprovers:r(i.approvers),teamCommenters:r(i.commenters),[`repo-${i.repo}`]:1,commentSentimentTotalScore:(i.commentSentimentScore||0)+(i.commentAuthorSentimentScore||0),[`${i.author}-commentsSentimentScore`]:i.commentSentimentScore,[`${i.author}-commentAuthorSentimentScore`]:i.commentAuthorSentimentScore})),c=Ie(l),d=ho({events:s,usersInfo:n});return o.jsxs(o.Fragment,{children:[o.jsx(Et,{}),o.jsx(Oc,{pullRequests:l,releases:d}),o.jsx(Rt,{pullRequests:l,chunkyData:c,releases:d,tableOpenedByDefault:!0}),o.jsx(Qt,{pullRequests:l,chunkyData:c,releases:d,allRepos:a}),o.jsx(Xt,{}),o.jsx(tn,{})]})},Lc=e=>({pullRequests:e.pullRequests,userIds:e.fetches.userIds,events:e.fetches.events,usersInfo:e.fetches.usersInfo}),Mc=M(Lc)(kc),$c=({pullRequests:e=[],reviewedPullRequests:t=[],userIds:s=[],usersInfo:n={}})=>{const[r]=s,{showNames:a}=ve(),{theme:l}=q(),c=L[l].secondary,d=L[l].primary,i={},m={},u={},p=e.map(E=>{const v=E.commenters||{};Object.keys(v).forEach(T=>{const j=v[T]||0;u[T]||(u[T]={}),u[T].commentsReceived=(u[T].commentsReceived||0)+j});const b=E.approvers||{};return Object.keys(b).forEach(T=>{const j=b[T]||0;u[T]||(u[T]={}),u[T].approvalsReceived=(u[T].approvalsReceived||0)+j}),i[E.repo]=(i[E.repo]||0)+1,m[E.org]=(m[E.org]||0)+1,{...E,[`repo-${E.repo}`]:1,commentSentimentTotalScore:(E.commentSentimentScore||0)+(E.commentAuthorSentimentScore||0),[`${E.author}-commentsSentimentScore`]:E.commentSentimentScore,[`${E.author}-commentAuthorSentimentScore`]:E.commentAuthorSentimentScore}}),h={...n};t.map(E=>{var j,P;const v=E.author;h[v]={userId:v};const b=((j=E==null?void 0:E.commenters)==null?void 0:j[r])||0,T=((P=E==null?void 0:E.approvers)==null?void 0:P[r])||0;u[v]||(u[v]={}),u[v].commentsGiven=(u[v].commentsGiven||0)+b,u[v].approvalsGiven=(u[v].approvalsGiven||0)+T});const g=Object.entries(u).map(([E,v],b)=>{var T;return{...v,author:a?E:`${Array(b).fill(" ").join("")}Spartacus`,name:a?((T=n[E])==null?void 0:T.name)||E:`${Array(b).fill(" ").join("")}Spartacus`}}),x=xt(e.concat(t),h,r),y=["commentsGiven","approvalsGiven"],f=x.sort(we(y)),S=Ie(p),w=Yo("repo",i);return o.jsxs(o.Fragment,{children:[o.jsx(Et,{}),o.jsx(Y,{children:o.jsxs(Ae,{children:[o.jsxs("div",{className:"flex flex-wrap justify-center w-full",children:[o.jsx(ut,{data:g,indexBy:"name",title:"Comments",sortBy:"commentsGiven",bars:[{dataKey:"commentsGiven",color:c,label:"given"},{dataKey:"commentsReceived",color:d,label:"received"}]}),o.jsx(ut,{data:g,indexBy:"name",title:"Approvals",sortBy:"approvalsGiven",bars:[{dataKey:"approvalsGiven",color:c,label:"given"},{dataKey:"approvalsReceived",color:d,label:"received"}]})]}),o.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[o.jsx(ht,{data:f,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),o.jsx(ht,{data:f,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),w.pieData.length>0&&o.jsx(Xo,{data:w.pieData,title:w.sectionTitle})]})}),o.jsx(Rt,{pullRequests:p,chunkyData:S,tableOpenedByDefault:!0}),o.jsx(Xt,{})]})},Fc=e=>({pullRequests:e.pullRequests,reviewedPullRequests:e.reviewedPullRequests,userIds:e.fetches.userIds,usersInfo:e.fetches.usersInfo}),Uc=M(Fc)($c),Gc=e=>{const{showPvP:t,userPage:s}=qe(),n=!!(s&&s.length>0);return o.jsx("div",{children:Z([[D(t),D(o.jsx(_c,{}))],[D(n),D(o.jsx(Tc,{}))],[ns(Boolean,"teamName"),D(o.jsx(Mc,{}))],[ns(r=>r.length===1,"userIds"),D(o.jsx(Uc,{}))],[({repo:r,org:a})=>r===""&&a&&a.length>0,D(o.jsx(nc,{}))],[U,D(o.jsx(vc,{}))]])(e)})},Vc=e=>({userIds:e.fetches.userIds,teamName:e.fetches.teamName,repo:e.fetches.repo,org:e.fetches.org}),Bc=M(Vc)(Gc),qc=()=>{const{toggleTheme:e}=q();return o.jsxs("div",{className:"absolute z-[1] top-2 right-2 flex flex-nowrap gap-x-2",children:[o.jsx("a",{className:"hover:text-primary",href:"https://twitter.com/chris_07734",children:o.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"TwitterIcon",children:o.jsx("path",{d:"M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"})})}),o.jsx("a",{className:"hover:text-primary",href:"https://github.com/n07734/community-health",children:o.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"GitHubIcon",children:o.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"})})}),o.jsxs("a",{href:"#theme",onClick:t=>{t.preventDefault(),e()},className:"theme-icon hover:text-primary",children:[o.jsx("svg",{className:"h-6 w-6 sun fill-current dark:display-none",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"SunnyIcon",children:o.jsx("path",{d:"m6.76 4.84-1.8-1.79-1.41 1.41 1.79 1.79zM4 10.5H1v2h3zm9-9.95h-2V3.5h2zm7.45 3.91-1.41-1.41-1.79 1.79 1.41 1.41zm-3.21 13.7 1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5v2h3v-2zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6m-1 16.95h2V19.5h-2zm-7.45-3.91 1.41 1.41 1.79-1.8-1.41-1.41z"})}),o.jsx("svg",{className:"h-6 w-6 moon fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"MoonIcon",children:o.jsx("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54 0 4.48-2.94 8.27-7 9.54.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2"})})]})]})},Kc=()=>o.jsxs("div",{className:"p-0 overflow-auto",children:[o.jsxs(Y,{className:"bg-none",children:[o.jsx(qc,{}),o.jsx(de,{title:o.jsx("h1",{children:"Code Health"})}),o.jsx("p",{children:"Coding is a team activity, healthy collaboration produces better code. This tool gives in depth collaboration and contribution metrics for teams to analyze their code health."}),o.jsx("p",{children:"You can create your own reports for individuals, teams, repos and orgs from public or enterprise GitHub."})]}),o.jsxs(o.Fragment,{children:[o.jsx(Ya,{}),o.jsx(Bc,{})]})]}),Ut=A.forwardRef(({className:e,value:t,...s},n)=>o.jsx(Hs,{ref:n,className:C("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:o.jsx(Xn,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ut.displayName=Hs.displayName;const zc=Z([[B(1),e=>`${e} day remaining`],[e=>e>1,e=>`${e} days remaining`],[e=>e<0,D("Wrapping up")],[U,D("")]]),Hc=({fetches:e,fetching:t=!1,fetchStatus:s={},pullRequests:n=[],formUntilDate:r=""})=>{const{userIds:a=[],sortDirection:l=""}=e,{user:c="",prCount:d=0,latestItemDate:i="",issueCount:m=0,savedReportName:u="",reviewCount:p=0,repoCount:h=0}=s,g=a.length>1,x=(te,me)=>l==="DESC"?fe(te,me):fe(me,te),y=l==="DESC"?0:-1,f=n.length>0?new Date(n.at(y).mergedAt):new Date,S=i?new Date(i):f,w=new Date(r),E=x(f,w),v=x(f,S),b=E-v,T=zc(b),j=100/(E||10),P=v*j,$=c?a.findIndex(te=>te===c):0,K=$>0?a.slice(0,$):[],ee=100/(a.length||10),be=$*ee;return t&&o.jsxs(Po,{open:!0,children:[o.jsx(Wt,{children:"Loading..."}),o.jsxs(Io,{"data-qa-id":"loader",className:"overflow-scroll max-h-full w-4/5",children:[g&&o.jsxs(o.Fragment,{children:[o.jsxs("h2",{children:["Loading ",$+1," of ",a.length," ",a.length===1?"user":"users"]}),o.jsx(Ut,{value:be})]}),T&&o.jsx("h2",{children:T}),u&&o.jsxs("h2",{children:["Fetching ",u]}),o.jsx(Ut,{value:P}),h>0&&o.jsxs("h2",{children:[h," Repos"]}),!u&&!g&&o.jsxs(o.Fragment,{children:[o.jsxs("h2",{children:[d," Pull Requests"]}),o.jsxs("h2",{children:[m," Issues"]})]}),p>0&&o.jsxs("h2",{children:[p," Reviews"]}),g&&K.length>0&&o.jsxs("p",{children:["Loaded users: ",K.join(", ")]})]})]})},Wc=e=>({fetches:e.fetches,fetching:e.fetching,fetchStatus:e.fetchStatus,pullRequests:e.pullRequests,formUntilDate:e.formUntilDate}),Yc=M(Wc)(Hc),Qc=()=>o.jsxs(cr,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[o.jsx(Yc,{}),o.jsx(Kc,{})]}),St=e=>(t,s)=>(n=e,r)=>{const a={[R[t]]:()=>r.payload,[R[s]]:()=>e}[r.type];return a?a():n},ge=St(""),bt=St([]),Xc=St({}),lt=St({hasNextPage:!0}),Jc=rs({fetches:rs({token:(e="",t)=>t.type===R.STORE_TOKEN?t.payload:e,org:ge("STORE_ORG","CLEAR_ORG"),repo:ge("STORE_REPO","CLEAR_REPO"),teamName:ge("SET_TEAM_NAME","CLEAR_TEAM_NAME"),untilDate:ge("STORE_UNTIL_DATE","CLEAR_UNTIL_DATE"),amountOfData:(e=1,t)=>t.type===R.STORE_AMOUNT?t.payload:e,sortDirection:(e="DESC",t)=>t.type===R.STORE_SORT?t.payload:e,enterpriseAPI:(e="",t)=>t.type===R.STORE_ENT_URL?t.payload:e,userIds:bt("STORE_USER_IDS","CLEAR_USER_IDS"),usersInfo:Xc("STORE_USERS_INFO","CLEAR_USERS_INFO"),excludeIds:bt("STORE_EX_IDS","CLEAR_EX_IDS"),events:bt("STORE_EVENTS","CLEAR_EVENTS"),prPagination:lt("SET_PR_PAGINATION","CLEAR_PR_PAGINATION"),usersReviewsPagination:lt("SET_PR_REVIEWED_PAGINATION","CLEAR_PR_REVIEWED_PAGINATION"),releasesPagination:lt("SET_RELEASES_PAGINATION","CLEAR_RELEASES_PAGINATION"),issuesPagination:lt("SET_ISSUES_PAGINATION","CLEAR_ISSUES_PAGINATION")}),reportDescription:ge("SET_DESC","CLEAR_DESC"),formUntilDate:ge("STORE_FORM_UNTIL_DATE","CLEAR_FORM_UNTIL_DATE"),fetching:(e=!1,t)=>{const{FETCH_START:s,FETCH_END:n}=R,r={[s]:!0,[n]:!1};return[s,n].includes(t.type)?r[t.type]:e},fetchStatus:(e={},t)=>t.type===R.FETCH_STATUS?t.payload:e,error:ge("FETCH_ERROR","CLEAR_FETCH_ERROR"),preFetchedError:ge("PRE_FETCH_ERROR","CLEAR_PRE_FETCH_ERROR"),preFetchedName:ge("PREFETCHED_NAME","CLEAR_PREFETCHED_NAME"),pullRequests:(e=[],t)=>[t.type===R.ADD_PRS&&t.payload,t.type===R.CLEAR_PRS&&[],e].find(Boolean),reviewedPullRequests:(e=[],t)=>[t.type===R.ADD_REVIEWED_PRS&&t.payload,t.type===R.CLEAR_REVIEWED_PRS&&[],e].find(Boolean),itemsDateRange:(e=["",""],t)=>[t.type===R.ADD_ITEMS_DATE_RANGE&&t.payload,t.type===R.CLEAR_ITEMS_DATE_RANGE&&["",""],e].find(Boolean),trimmedItems:(e={},t)=>[t.type===R.ADD_TRIMMED_ITEMS&&t.payload,t.type===R.CLEAR_TRIMMED_ITEMS&&{},e].find(Boolean),filteredPRs:(e=[],t)=>[t.type===R.ADD_FILTERED_PRS&&t.payload,t.type===R.CLEAR_FILTERED_PRS&&[],e].find(Boolean),filteredReviewedPRs:(e=[],t)=>[t.type===R.ADD_REVIEWED_FILTERED_PRS&&t.payload,t.type===R.CLEAR_REVIEWED_FILTERED_PRS&&[],e].find(Boolean),usersData:(e=[],t)=>[t.type===R.ADD_USERS_DATA&&t.payload,t.type===R.CLEAR_USERS_DATA&&[],e].find(Boolean),issues:(e=[],t)=>[t.type===R.ADD_ISSUES&&t.payload,t.type===R.CLEAR_ISSUES&&[],e].find(Boolean),filteredIssues:(e=[],t)=>[t.type===R.ADD_FILTERED_ISSUES&&t.payload,t.type===R.CLEAR_FILTERED_ISSUES&&[],e].find(Boolean),releases:(e=[],t)=>[t.type===R.ADD_RELEASES&&t.payload,t.type===R.CLEAR_RELEASES&&[],e].find(Boolean),filteredReleases:(e=[],t)=>[t.type===R.ADD_FILTERED_RELEASES&&t.payload,t.type===R.CLEAR_FILTERED_RELEASES&&[],e].find(Boolean)}),Zc=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Qe,ei=Jn(Jc,Zc(Zn(or)));er.createRoot(document.getElementById("root")).render(o.jsx(tr.StrictMode,{children:o.jsx(sr,{store:ei,children:o.jsx(nr,{children:o.jsx(rr,{children:o.jsx(ar,{children:o.jsx(Qc,{})})})})})}));

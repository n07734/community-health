import{r as j,j as n,R as da,C as ma,t as ua,c as ha,S as ga,a as Lt,T as Cs,I as pa,b as As,d as Ts,P as fa,e as ks,V as xa,L as Is,f as Ms,g as va,h as ya,i as Es,k as wa,l as ba,G as ja,m as $s,n as Os,o as Na,p as Bs,u as Pa,q as ts,s as At,v as Ra,w as Da,x as Sa,y as pe,z as ss,A as mt,B as ut,D as ns,E as Ca,F as Aa,H as Ta,J as ka,K as Ia,M as Fs,N as Ls,O as Ma,Q as k,U as nt,W as ze,X as de,Y as R,Z as K,_ as ae,$ as re,a0 as Ea,a1 as be,a2 as Be,a3 as ct,a4 as Pt,a5 as Vs,a6 as Tt,a7 as kt,a8 as qe,a9 as Ks,aa as $a,ab as Oa,ac as qs,ad as Us,ae as Gs,af as Ba,ag as Fa,ah as La,ai as as,aj as Oe,ak as Va,al as Ka,am as zs,an as te,ao as qa,ap as It,aq as Ua,ar as Ga,as as Hs,at as za,au as Ha,av as ge,aw as Mt,ax as Wa,ay as ft,az as Ws,aA as He,aB as Vt,aC as xt,aD as vt,aE as Ys,aF as Qs,aG as _s,aH as Ya,aI as Qa,aJ as os,aK as rs,aL as _a,aM as Ja,aN as Xa,aO as Js,aP as Za,aQ as eo,aR as to}from"./vendor-C_KOaFP3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();const Xs=j.createContext({}),so=({children:e})=>{const[t,s]=j.useState(!0),o={showNumbers:t,toggleShowNumbers:()=>s(!t)};return n.jsx(Xs.Provider,{value:o,children:e})},at=()=>j.useContext(Xs),Zs=j.createContext({}),no=({children:e})=>{const[t,s]=j.useState(!0),o={showNames:t,toggleShowNames:()=>s(!t)};return n.jsx(Zs.Provider,{value:o,children:e})},je=()=>j.useContext(Zs),en=j.createContext({}),ao=({children:e})=>{const[t,s]=j.useState(!1),[a,o]=j.useState(""),i={showPvP:t,togglePvPPage:()=>{s(!t),o("")},userPage:a,setUserPage:(u="")=>{s(!1),o(u)},clearUserPage:()=>{s(!1),o("")}};return n.jsx(en.Provider,{value:i,children:e})},We=()=>j.useContext(en),oo={theme:"dark",toggleTheme:()=>null},tn=j.createContext(oo),ro=({children:e,defaultTheme:t="dark",storageKey:s="vite-ui-theme",...a})=>{const[o,r]=j.useState(()=>localStorage.getItem(s)||t);j.useEffect(()=>{const c=window.document.documentElement;c.classList.remove("light","dark"),c.classList.add(o)},[o]);const l={theme:o,toggleTheme:()=>{const c=o==="dark"?"light":"dark";localStorage.setItem(s,c),r(c)}};return n.jsx(tn.Provider,{...a,value:l,children:e})},G=()=>{const e=j.useContext(tn);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},lo=da,co=ma,ls=({setIsOpen:e,isOpen:t,expandText:s,qaId:a,className:o})=>n.jsx("a",{className:`text-base text-primary ${o}`,href:"#desc",...a&&{"data-qa-id":a},onClick:r=>{r.preventDefault(),e(!t)},children:t?"hide":s}),io=({hLevel:e,children:t})=>{const s=`h${e}`;return n.jsx(s,{children:t})},me=({title:e,intro:t,children:s,hLevel:a=3,expandText:o="info",className:r="",expandQaId:l})=>{const[c,i]=j.useState(!1);return n.jsxs("div",{className:`w-full flex flex-grow flex-wrap ${r} ${t?"[&>*]:basis-full":""}`,children:[e&&typeof e=="string"?n.jsxs(io,{hLevel:a,children:[e,s&&n.jsx(ls,{isOpen:c,setIsOpen:i,expandText:o,qaId:l,className:"ml-2"})]}):e,n.jsxs("p",{children:[t," ",t&&s&&n.jsx(ls,{isOpen:c,setIsOpen:i,expandText:o,qaId:l})]}),n.jsx(lo,{open:c,onOpenChange:i,className:"wrapper basis-full",children:n.jsx(co,{children:s})})]})},J=({className:e="",children:t})=>n.jsx("div",{className:`paper ${e}`,children:t});function C(...e){return ua(ha(e))}const mo=Lt("uppercase inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),$=j.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...o},r)=>{const l=a?ga:"button";return n.jsx(l,{className:C(mo({variant:t,size:s,className:e})),ref:r,...o})});$.displayName="Button";const Ne=({children:e})=>n.jsx("div",{className:"w-full relative flex flex-col flex-wrap gap-0 items-center 3xl:flex-row 3xl:gap-0 3xl:gap-x-5 3xl:justify-center",children:e}),Je='"Nunito", "Roboto", "Helvetica", "Arial", sans-serif',Xe=12,Rt={legendOrientation:"horizontal",legendPosition:"top-right",height:10,legendOffsetX:0,legendOffsetY:-4},ot=(e="dark")=>{const t={light:"#232023",dark:"#eee"}[e],s={light:"#fff",dark:"#232023"}[e],a={light:"#077314",dark:"#077314"}[e],o={light:"#8b4ff0",dark:"#6b3dba"}[e],r={light:"#87cac6",dark:"#6b3dba"}[e];return{fontFamily:Je,fontSize:Xe,textColor:t,crosshair:{line:{stroke:t}},axis:{legend:{text:{fill:t}},ticks:{text:{fill:t}}},legends:{hidden:{symbol:{fill:"#eee",opacity:1},text:{fill:"#eee",fontWeight:"400",opacity:1}},text:{fontWeight:"800"}},legendsTextFill:t,dotColor:t,tooltip:{container:{fontFamily:Je,fontSize:Xe,background:s,color:t,boxShadow:`0 1px 2px ${t}`}},grid:{line:{stroke:"#999"}},markers:{primary:{lineStyle:{stroke:a,strokeWidth:1},textStyle:{fontFamily:Je,fontSize:Xe,fill:a},...Rt},secondary:{lineStyle:{stroke:o,strokeWidth:1},textStyle:{fontFamily:Je,fontSize:Xe,fill:o},...Rt},tertiary:{lineStyle:{stroke:r,strokeWidth:1,strokeDasharray:"2 6"},textStyle:{fontFamily:Je,fontSize:Xe,fill:r},...Rt}}}},Ue=({className:e="",items:t=[],text:s="",type:a})=>{const o=m=>{const d=t.length-1,g={zero:"",max:" and ",more:", "},h=[m===0&&"zero",m===d&&"max",m>0&&"more"].find(Boolean);return g[h]},r=({color:m,label:d})=>n.jsx("span",{style:{color:m,borderBottomColor:m},className:"saved-line",children:d}),l=({color:m,label:d})=>n.jsx("span",{style:{color:m},children:d}),c={average:"Average",trimmedAverage:"Trimmed Average",sum:"Total",count:"Total",teamDistribution:"",median:"",percentWith:"",growth:"",averagePerDev:""},i=[...new Set(t.filter(m=>"groupMath"in m).map(m=>"groupMath"in m&&m.groupMath))],u=(t.length>0&&a==="line"&&i.length<2?i[0]||"average":"")||"";return n.jsxs("h4",{className:e,children:[`${s} `,u&&`${c[u]} `,t.map((m,d)=>n.jsxs(j.Fragment,{children:[o(d),a==="line"?n.jsx(r,{...m}):n.jsx(l,{...m})]},d))]})},Fe=wa,Le=ja,Ve=ba,Ae=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Cs,{ref:a,className:C("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,n.jsx(pa,{asChild:!0,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:n.jsx("path",{d:"m6 9 6 6 6-6"})})})]}));Ae.displayName=Cs.displayName;const sn=j.forwardRef(({className:e,...t},s)=>n.jsx(As,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:n.jsx("path",{d:"m18 15-6-6-6 6"})})}));sn.displayName=As.displayName;const nn=j.forwardRef(({className:e,...t},s)=>n.jsx(Ts,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:n.jsx("path",{d:"m6 9 6 6 6-6"})})}));nn.displayName=Ts.displayName;const Te=j.forwardRef(({className:e,children:t,position:s="popper",...a},o)=>n.jsx(fa,{children:n.jsxs(ks,{ref:o,className:C("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[n.jsx(sn,{}),n.jsx(xa,{className:C("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(nn,{})]})}));Te.displayName=ks.displayName;const uo=j.forwardRef(({className:e,...t},s)=>n.jsx(Is,{ref:s,className:C("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));uo.displayName=Is.displayName;const ee=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Ms,{ref:a,className:C("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(va,{children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:n.jsx("path",{d:"M20 6 9 17l-5-5"})})})}),n.jsx(ya,{children:t})]}));ee.displayName=Ms.displayName;const ho=j.forwardRef(({className:e,...t},s)=>n.jsx(Es,{ref:s,className:C("-mx-1 my-1 h-px bg-muted",e),...t}));ho.displayName=Es.displayName;const an=j.forwardRef(({className:e,...t},s)=>n.jsx($s,{className:C("grid gap-2",e),...t,ref:s}));an.displayName=$s.displayName;const Et=j.forwardRef(({className:e,...t},s)=>n.jsx(Os,{ref:s,className:C("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(Na,{className:"flex items-center justify-center",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-2.5 w-2.5 fill-current text-current",children:n.jsx("circle",{cx:"12",cy:"12",r:"10"})})})}));Et.displayName=Os.displayName;const go=Lt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),st=j.forwardRef(({className:e,...t},s)=>n.jsx(Bs,{ref:s,className:C(go(),e),...t}));st.displayName=Bs.displayName;const E=["#E82573","#8b4ff0","#1F77B4","#4ECC7A","#DBD523","#EB9830","#D14B41"],F={dark:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#E2E2E2"},light:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#777"}},oe=["average","trimmedAverage","sum","median"],Kt=[{label:"Comments",dataKey:"comments",groupMaths:[...oe,"percentWith","teamDistribution"]},{label:"Code comments",dataKey:"codeComments",groupMaths:[...oe,"percentWith"]},{label:"Review comments",dataKey:"generalComments",groupMaths:[...oe,"percentWith"]},{label:"Approvals",dataKey:"approvals",groupMaths:[...oe,"percentWith","teamDistribution"]},{label:"Additions",dataKey:"additions",groupMaths:oe},{label:"Deletions",dataKey:"deletions",groupMaths:oe},{label:"PR size (additions + deletions)",dataKey:"prSize",groupMaths:oe},{label:"Codebase change (additions - deletions)",dataKey:"growth",groupMaths:["growth"]},{label:"PR count",dataKey:"author",groupMaths:["count","averagePerDev"]},{label:"PR Age(days)",dataKey:"age",groupMaths:oe},{label:"Sentiment",dataKey:"commentSentimentTotalScore",groupMaths:oe},{label:"Sentiment to team",dataKey:"commentSentimentScore",groupMaths:oe},{label:"Sentiment from team",dataKey:"commentAuthorSentimentScore",groupMaths:oe},{label:"Bug count",dataKey:"isBug",groupMaths:["count"]},{label:"Feature count",dataKey:"isFeature",groupMaths:["count"]}],po={average:"Average",trimmedAverage:"*Trimmed Average",sum:"Total",count:"Total",median:"Median",teamDistribution:"Team's % spread of",percentWith:"% of PRs with",growth:"",averagePerDev:"Average per Dev"},cs=e=>({color:t,label:s="",dataKey:a,groupMath:o="average"},r)=>n.jsxs("div",{style:{color:t},children:[n.jsx("p",{className:"saved-line text-xl",children:s}),n.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",onClick:l=>{l.preventDefault(),e(a,o)},children:n.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})})]},`${r}`),on=e=>[...e.left||[],...e.right||[]],$t=e=>{const t=on(e),s=[];return Kt.forEach(({label:a="",dataKey:o,groupMaths:r=[]})=>{const l=t.filter(i=>(i==null?void 0:i.dataKey)===o),c=r.filter(i=>l.every(u=>(u==null?void 0:u.groupMath)!==i));c.length>0&&s.push({label:a,dataKey:o,groupMaths:c})}),s},fo=e=>{const s=on(e).map(o=>o==null?void 0:o.dataKey);return Kt.find(({dataKey:o})=>!s.includes(o))},xo=(e,t)=>{const s=$t(t),a=e.dataKey,o=s.findIndex(r=>r.dataKey===a);return s[o+1]||s[0]||Kt[0]},is={average:()=>"Average",trimmedAverage:()=>"Trimmed Average",sum:()=>"Total",median:()=>"Median",growth:()=>"Growth",percentWith:({label:e=""}={})=>`% of PRs with ${e}`,teamDistribution:({label:e=""}={})=>`Team's % spread of ${e}`,count:()=>"Total",averagePerDev:({label:e=""}={})=>`Average ${e} per DEV`},rn=({graphInfo:e,setGraph:t=()=>{},graphs:s=[]})=>{var g;const a=fo(e),[o,r]=j.useState({label:(a==null?void 0:a.label)||"Comments",dataKey:(a==null?void 0:a.dataKey)||"comments",color:s.length>1?E[0]:E[1],lineSide:"left",groupMath:(g=a==null?void 0:a.groupMaths)==null?void 0:g[0]}),l=(h={})=>{r({...o,...h})},c=h=>{h.preventDefault();const{lineSide:p,label:f,groupMath:v}=o,x=e[p]||[];x.push({...o,label:`${po[v]} ${f}`,groupMath:v,.../teamDistribution|percentWith/.test(v)&&{yMax:100}});const b={...e,[p]:x},y=s.map(N=>b.graphId===N.graphId?b:N);t(y);const w=xo(o,b),P=E.findIndex(N=>N===o.color);r({label:w.label,dataKey:w.dataKey,color:E[(P+1)%E.length],lineSide:p,groupMath:w==null?void 0:w.groupMaths[0]})},i=h=>(p,f)=>{const x=(e[h]||[]).filter(P=>!(P.dataKey===p&&P.groupMath===f)),b={...e,[h]:x},y=s.map(P=>b.graphId===P.graphId?b:P);t(y);const[w]=$t(b);r({label:w.label,dataKey:w.dataKey,color:E[0],lineSide:"left",groupMath:w.groupMaths[0]})},u=$t(e),m=u.find(h=>h.dataKey===o.dataKey),d=((m==null?void 0:m.groupMaths)||[]).filter(h=>!/growth/.test(h));return n.jsxs("div",{className:"w-full max-w-mw",children:[u.length>0&&n.jsxs("form",{className:"flex flex-wrap rounded-2xl justify-center paper pt-2 gap-4 mb-3",onSubmit:c,children:[n.jsxs(Fe,{onValueChange:h=>{const p=u.find(f=>f.dataKey===h);l({dataKey:h,groupMath:p.groupMaths[0],label:p.label})},value:m==null?void 0:m.dataKey,children:[n.jsx(Ae,{className:"w-auto",children:n.jsx(Ve,{children:m==null?void 0:m.label})}),n.jsx(Te,{children:n.jsx(Le,{children:u.map(({label:h,dataKey:p})=>n.jsx(ee,{value:p,children:h},`${m==null?void 0:m.dataKey}${p}${h}`))})})]}),d.length>0&&n.jsxs(Fe,{onValueChange:h=>h&&l({groupMath:h}),value:o.groupMath,children:[n.jsx(Ae,{className:"w-auto",children:n.jsx(Ve,{children:is[o.groupMath](o)})}),n.jsx(Te,{children:n.jsx(Le,{children:d.map(h=>n.jsx(ee,{value:h,children:is[h](o)},`${o.dataKey}${h}`))})})]}),n.jsx(an,{defaultValue:o.lineSide,onValueChange:h=>h&&l({lineSide:h}),children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Et,{value:"left",id:"r1"}),n.jsx(st,{htmlFor:"r1",children:"Axis: Left"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Et,{value:"right",id:"r2"}),n.jsx(st,{htmlFor:"r2",children:"Right"})]})]})}),n.jsxs(Fe,{onValueChange:h=>h&&l({color:h}),value:o.color,children:[n.jsx(Ae,{className:"w-auto",children:n.jsx(Ve,{placeholder:n.jsx("div",{style:{backgroundColor:o.color,width:"70px",height:"10px"}})})}),n.jsx(Te,{children:n.jsx(Le,{children:E.map(h=>n.jsx(ee,{value:h,children:n.jsx("div",{style:{backgroundColor:h,width:"70px",height:"10px"}})},h))})})]}),n.jsx($,{color:"primary",type:"submit",children:"Add to graph"})]}),n.jsxs("div",{className:"custom-lines",children:[n.jsx("div",{children:(e.left||[]).map(cs(i("left")))}),n.jsx("div",{children:(e.right||[]).map(cs(i("right")))})]})]})},ln=j.forwardRef(({className:e,...t},s)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:s,className:C("w-full caption-bottom text-sm",e),...t})}));ln.displayName="Table";const cn=j.forwardRef(({className:e,...t},s)=>n.jsx("thead",{ref:s,className:C("[&_tr]:border-b",e),...t}));cn.displayName="TableHeader";const dn=j.forwardRef(({className:e,...t},s)=>n.jsx("tbody",{ref:s,className:C("[&_tr:last-child]:border-0",e),...t}));dn.displayName="TableBody";const vo=j.forwardRef(({className:e,...t},s)=>n.jsx("tfoot",{ref:s,className:C("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));vo.displayName="TableFooter";const dt=j.forwardRef(({className:e,...t},s)=>n.jsx("tr",{ref:s,className:C("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));dt.displayName="TableRow";const mn=j.forwardRef(({className:e,...t},s)=>n.jsx("th",{ref:s,className:C("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));mn.displayName="TableHead";const Ot=j.forwardRef(({className:e,...t},s)=>n.jsx("td",{ref:s,className:C("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ot.displayName="TableCell";const yo=j.forwardRef(({className:e,...t},s)=>n.jsx("caption",{ref:s,className:C("mt-4 text-sm text-muted-foreground",e),...t}));yo.displayName="TableCaption";const wo=({sort:e})=>({asc:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"m5 12 7-7 7 7"}),n.jsx("path",{d:"M12 19V5"})]}),desc:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"M12 5v14"}),n.jsx("path",{d:"m19 12-7 7-7-7"})]}),none:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"m21 16-4 4-4-4"}),n.jsx("path",{d:"M17 20V4"}),n.jsx("path",{d:"m3 8 4-4 4 4"}),n.jsx("path",{d:"M7 4v16"})]})})[e],ie=e=>({column:t})=>{const s=t.getIsSorted()||"none";return n.jsxs($,{variant:"link",className:"p-0",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[e,n.jsx(wo,{sort:s})]})},bo=[{accessorKey:"age",header:ie("PR Age (days)")},{accessorKey:"comments",header:ie("Comments"),cell:({row:e})=>e.getValue("comments")||0},{accessorKey:"approvals",header:ie("Approvals"),cell:({row:e})=>e.getValue("approvals")||0},{accessorKey:"commentSentimentScore",header:ie("Sentiment received"),cell:({row:e})=>e.getValue("commentSentimentScore")||0},{accessorKey:"commentAuthorSentimentScore",header:ie("Sentiment given"),cell:({row:e})=>e.getValue("commentAuthorSentimentScore")||0},{accessorKey:"commentSentimentTotalScore",header:ie("Sentiment"),cell:({row:e})=>e.getValue("commentSentimentTotalScore")||0},{accessorKey:"prSize",header:ie("PR Size")},{accessorKey:"author",header:ie("Author")},{accessorKey:"mergedAt",header:ie("Date"),cell:({row:e})=>{const t=e.getValue("mergedAt");return At(new Date(t),"do MMM yy")}},{accessorKey:"url",header:ie("Link"),cell:({row:e})=>{const t=e.getValue("url"),s=t.split("/").at(-1);return n.jsx("a",{className:"text-primary",href:t,children:s})}}],jo=({dataKeys:e,data:t,addClass:s=""})=>{var m;const[a,o]=j.useState([]),[r,l]=j.useState({pageIndex:0,pageSize:4}),c=[...e,"mergedAt","url"],i=bo.filter(d=>c.includes(d.accessorKey)),u=Pa({data:t,columns:i,getCoreRowModel:Sa(),getPaginationRowModel:Da(),onSortingChange:o,getSortedRowModel:Ra(),onPaginationChange:l,state:{sorting:a,pagination:r}});return n.jsxs("div",{className:`rounded-md border-2 border-primary mx-50 ${s}`,children:[n.jsxs(ln,{children:[n.jsx(cn,{children:u.getHeaderGroups().map(d=>n.jsx(dt,{children:d.headers.map(g=>n.jsx(mn,{children:g.isPlaceholder?null:ts(g.column.columnDef.header,g.getContext())},g.id))},d.id))}),n.jsx(dn,{children:(m=u.getRowModel().rows)!=null&&m.length?u.getRowModel().rows.map(d=>n.jsx(dt,{"data-state":d.getIsSelected()&&"selected",children:d.getVisibleCells().map(g=>n.jsx(Ot,{children:ts(g.column.columnDef.cell,g.getContext())},g.id))},d.id)):n.jsx(dt,{children:n.jsx(Ot,{colSpan:i.length,className:"h-24 text-center",children:"No results."})})})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4",children:[n.jsxs("p",{children:[r.pageIndex+1," of ",u.getPageCount()]}),n.jsx($,{variant:"ghost",size:"sm",onClick:()=>u.previousPage(),disabled:!u.getCanPreviousPage(),children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:n.jsx("path",{d:"m15 18-6-6 6-6"})})}),n.jsx($,{variant:"ghost",size:"sm",onClick:()=>u.nextPage(),disabled:!u.getCanNextPage(),children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:n.jsx("path",{d:"m9 18 6-6-6-6"})})})]})]})},un=()=>n.jsx("svg",{className:"w-[22px] h-[22px] fill-background inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:n.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})}),No=()=>n.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:n.jsx("path",{d:"M15.5 29.5c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM21.938 15.938c0-0.552-0.448-1-1-1h-4v-4c0-0.552-0.447-1-1-1h-1c-0.553 0-1 0.448-1 1v4h-4c-0.553 0-1 0.448-1 1v1c0 0.553 0.447 1 1 1h4v4c0 0.553 0.447 1 1 1h1c0.553 0 1-0.447 1-1v-4h4c0.552 0 1-0.447 1-1v-1z"})}),Po=({showTable:e=!1})=>e?n.jsx(No,{}):n.jsx(un,{}),Ro=({dataKeys:e,data:t,tableOpenedByDefault:s=!1})=>{var h;const[a,o]=j.useState(t.length-1),[r,l]=j.useState(s),c=t.flat(),u=c.length>30?t:[c],m=a===0?"rounded-tl-none":"",d=a===t.length-1?"rounded-tr-none":"",g=m||d||"";return n.jsxs("div",{className:"mb-4",children:[u.length>0&&n.jsx("div",{className:"px-50 flex flex-row justify-stretch gap-x-1",children:u.map((p,f)=>n.jsx($,{className:`rounded-lg relative w-full px-0 py-1 h-full ${a===f&&r?"slice rounded-t-lg rounded-b-none border-b-4 border-primary hover:bg-primary":"mb-1 bg-secondary hover:bg-secondary"}`,onClick:()=>{a===f&&l(!r),a!==f&&!r&&l(!0),o(f)},children:a===f?n.jsx(Po,{showTable:r}):n.jsx(un,{})},f))}),((h=u[a])==null?void 0:h.length)>0&&r&&n.jsx(jo,{data:u[a],dataKeys:e,addClass:g})]})},Do=(e,t)=>{const s=e&&ns(new Date(e))+1,a=t&&ns(new Date(t))+1;return!!(s&&a&&s!==a)},So=(e,t)=>{const s=e&&ut(new Date(e)),a=t&&ut(new Date(t));return!!(s&&a&&s!==a)},ds=e=>(t,s)=>{const a=t&&ut(new Date(t)),o=s&&ut(new Date(s));return!!(a&&o&&a%e>0&&o%e===0)},Co=(e,t)=>{const s=e&&mt(new Date(e))+1,a=t&&mt(new Date(t))+1;return!!(s&&a&&s!==a)},Ao=e=>(t,s)=>{const a=t&&mt(new Date(t))+1,o=s&&mt(new Date(s))+1;return!!(a&&o&&a%e>0&&o%e===0)},To=(e,t)=>{const s=e&&ss(new Date(e)),a=t&&ss(new Date(t));return!!(s&&a&&s!==a)},ko={"1day":Do,"1week":So,"2week":ds(2),"3week":ds(3),"1month":Co,"1quarter":Ao(3),"1year":To},Io=(e,t,s=[])=>{const a=[];return s.forEach(o=>{const l=(a.at(-1)||[]).at(-1)||{};!l[e]||ko[t](l[e],o[e])?a.push([o]):a.at(-1).push(o)}),a},Mo=(e=[])=>{const{mergedAt:t}=e.at(0),{mergedAt:s}=e.at(-1),a=pe(new Date(s),new Date(t)),o=[{batchType:"1year",maxPoints:Math.ceil(a/365)},{batchType:"1quarter",maxPoints:Math.ceil(a/89)},{batchType:"1month",maxPoints:Math.ceil(a/30)},{batchType:"2week",maxPoints:Math.ceil(a/14)},{batchType:"1week",maxPoints:Math.ceil(a/7)},{batchType:"1day",maxPoints:a}],{batchType:r}=o.reduce((l,c)=>!l.maxPoints||Math.abs(c.maxPoints-15)<Math.abs(l.maxPoints-15)?c:l,{});return Io("mergedAt",r,e)},hn=(e=[])=>e.length<1?[]:Mo(e),Bt=e=>(t=[])=>t.reduce((s,a)=>(a[e]||0)+s,0),Eo=e=>t=>e.reduce((s,a)=>s+(t&&t[a]||0),0),Pe=(e=[])=>(t,s)=>{const a=Eo(e),o=a(t);return a(s)-o},$o=e=>(t,s)=>e==="DESC"?new Date(s).getTime()-new Date(t).getTime():new Date(t).getTime()-new Date(s).getTime(),gn=e=>{const t=[];return e.forEach(({data:s})=>{const a=s.map(o=>o.y);t.push(...a)}),t.sort((s,a)=>s-a)},ms=e=>{const t=gn(e),s=Math.round(t.length*.95),a=t[s]||0,o=t.at(-1)||0,r=a&&Math.round(a/o*100)||0;return a&&r<30?a:o},us=e=>{const t=gn(e),s=t.length>0?Ca(Math.min,t):0;return s>0?0:s},Oo=e=>{const t=new Date(e),s=t.getMonth()+1,a=t.getDate();return`${t.getFullYear()}-${s<10?`0${s}`:s}-${a<10?`0${a}`:a}`},Bo=({batch:e=[]})=>{const t={};return e.forEach(s=>"prSize"in s&&(t[s.author]=1)),Math.round(e.length/Object.keys(t).length)},Fo=({batch:e=[],dataKey:t})=>{const s=t,a=e.sort(Pe([s])),o=a.length,r=o>4?a.slice(Math.ceil(o*.05),Math.floor(o*.95)):a,l=r.reduce((c,i)=>c+(s&&i[s]||0),0)/r.length;return Math.round(l)},Lo=({batch:e=[],dataKey:t="comments"})=>{const s=new Set([]),a={};e.forEach(p=>{if(!("prSize"in p))return;const{teamApprovers:f={},teamCommenters:v={}}=p,x=/approvals/i.test(t)?f:v;Object.entries(x).forEach(([y,w])=>{a[y]=(a[y]||0)+w});const b=[...Object.keys(f)||[],...Object.keys(v)||[]];b.length>0&&b.map(y=>s.add(y))});const o={};s.forEach(p=>o[p]=0);const r={...o,...a},l=Object.values(r),c=l.length,i=l.reduce((p,f)=>p+f,0),u=i/c,m=u*(c-1)+(i-u),d=l.reduce((p,f)=>p+Math.abs(f-u),0),g=m-d,h=Math.round(100/m*g);return isNaN(h)?0:h},Vo=({batch:e=[],dataKey:t="comments"})=>{const s=e.length,o=e.filter(l=>!l[t]).length;return o>0?Math.round((s-o)/s*100):0},Ko=({batch:e,dataKey:t})=>{const s=e.length,a=e.sort(Pe([t])),o=Math.floor(s/2);return a[o][t]||0},qo=({batch:e})=>e.reduce((s=0,a)=>{if(!("prSize"in a))return s;const{additions:o=0,deletions:r=0}=a;return s+(o-r)},0),Uo=({dataKey:e,groupMath:t="average"},s=[])=>{const a=[];return s.forEach(o=>{const r=o.length;if(r>0){const l={average:()=>r>0?Math.round(Bt(e)(o)/r):0,trimmedAverage:Fo,sum:()=>Bt(e)(o),count:()=>r,averagePerDev:Bo,median:Ko,percentWith:Vo,teamDistribution:Lo,growth:qo};a.push({y:l[t]({batch:o,dataKey:e}),x:Oo(o[0].mergedAt)})}}),a},hs=({lines:e=[]})=>{const t=[];return e.forEach(s=>{const{label:a,color:o,data:r}=s,l=hn(r),c=Uo(s,l);c.length&&t.push({id:a,color:o,data:c})}),t},Go=(e,t,s)=>{let a,o;s.forEach(({data:i=[]})=>{const u=i[0].x,m=i[i.length-1].x;(!a||new Date(u)<a)&&(a=new Date(u)),(!o||new Date(m)>o)&&(o=new Date(m))});const r={MAJOR:"primary",MINOR:"secondary",PATCH:"tertiary",EVENT:"primary"},l=[0,18,36,54,72,90];return e.filter(({date:i,releaseType:u})=>{const m=new Date(i);return u!=="PATCH"&&m>a&&m<o}).map((i,u)=>({axis:"x",value:new Date(i.date).getTime(),legend:i.description,...t.markers[r[i.releaseType]]||{},legendOffsetY:l[u%l.length]}))},zo=e=>{const t=`${e}`,s=Math.ceil(t.length*.4),[a]=t.split("").reduceRight(([r=[],l=!1],c,i)=>{const u=parseInt(c),m=l?u+1:u,d=i!==0&&(m>9||i>s&&m>4),g=d||i>s?0:m;return[[...r,g],d]},[[],!1]);return a.reverse().join("")},ke=(e=[])=>{var i,u,m,d;const t=hn(e),s=t.at(0)||[],a=t.at(-1)||[],o=s.at(0)&&new Date(((i=s.at(0))==null?void 0:i.mergedAt)||((u=s.at(0))==null?void 0:u.createdAt)),r=a.at(0)&&new Date(((m=a.at(0))==null?void 0:m.mergedAt)||((d=a.at(0))==null?void 0:d.createdAt)),l=o&&r?pe(r,o):0,c=[];return t.forEach((g=[])=>{const h=c.length,p=new Date((g.at(0)||{}).mergedAt||(g.at(0)||{}).createdAt),f=pe(p,o),v=Math.floor(f/l*100),x=10*h;h<1||v>=x&&h<10?c.push(g):c.at(-1).push(...g)}),c},Ho=(e=[])=>{const t=[];return e.forEach(({data:s=[]})=>{t.push(new Date(s.at(0).x)),t.push(new Date(s.at(-1).x))}),t},Wo=(e=[],t=[])=>{const s=Ho([...e,...t]),a=Aa(s),o=Ta(s);return ka(o,a)},pn=({pullRequests:e=[],showNames:t=!0,usersInfo:s={}})=>{const a={};return e.forEach(l=>{const{author:c}=l,i=a[c]||[];i.push(l),a[c]=i}),[{lines:Object.entries(a).map(([l="",c=[]],i)=>{var m;const u=c.map(d=>({value:1,mergedAt:d.mergedAt}));return{label:t?((m=s[l])==null?void 0:m.name)||l:`${Array(i).fill(" ").join("")}Spartacus`,color:E[i%E.length],dataKey:"value",groupMath:"count",data:u}}),xAxis:"left"}]},fn=(e="repo",t={})=>{const s=Object.entries(t).sort(([,i],[,u])=>i-u),a=s.slice(-20),o=s.length>19?a.map(([i])=>i):Object.keys(t),r=a.map(([i,u],m)=>({id:i,label:i,color:E[m%E.length],value:u})),l=s.length>o.length?`PR rainbow split by top 20 ${e}s out of ${s.length}`:`PR ${e} rainbow (${o.length})`;return{pieData:r,reportItems:o,pieTitle:`PR by ${e} rainbow`,sectionTitle:l}},Yo=e=>{var a;const t=o=>{const r=o.data.yFormatted,l=o.data.originalY;return/[\d.]/.test(l)?l:r},s=((a=e==null?void 0:e.slice)==null?void 0:a.points)||[];return n.jsx(Fs,{rows:s.map((o,r)=>[n.jsx("span",{style:{display:"block",width:"12px",height:"12px",background:o.serieColor}},r),o.serieId,n.jsx("strong",{children:t(o)},r)])})},Qo=(e=[])=>({series:t,lineGenerator:s,xScale:a,yScale:o})=>t.map((r={})=>{const{id:l,data:c,color:i}=r,{lineStyles:u={strokeWidth:2}}=e.find(m=>m.label===l)||{};return n.jsx("path",{d:s(c.map(m=>({x:a(m.data.x),y:o(m.data.y)}))),fill:"none",stroke:i,style:u},l)}),gs=(e=[])=>e.filter(t=>t.yMax).map(t=>t.yMax),ps=(e,t)=>t-e,_=({title:e,combineTitles:t=!1,blockHeading:s=!1,data:a=[],markers:o=[],showLegends:r=!1,tableData:l=[],tableKeys:c=[],graphInfo:i,setGraph:u=()=>{},graphs:m=[],tableOpenedByDefault:d=!1}={})=>{const{theme:g}=G(),h=ot(g),{showNumbers:p}=at(),f=a.find(({xAxis:A})=>A==="left")||{lines:[]},v=gs(f.lines),x=hs(f),[b]=[...v,ms(x)].sort(ps),y=us(x),w=a.find(({xAxis:A})=>A==="right")||{lines:[]},P=gs(w.lines),N=hs(w),[I]=[...P,ms(N)].sort(ps),S=us(N),B=b||I,z=y>S?S:y,X=[];N.forEach(A=>{const M=A.data.map(L=>({y:L.y<0?L.y:Math.round(L.y*(B/I)),x:L.x,originalY:L.y}));M.length&&X.push({...A,data:M})});const Y=f.lines,le=!t&&e||s?[]:Y,O=w.lines,U=[...f.lines,...w.lines],se=U.map(A=>({label:A.label,default:A.color,current:A.color,clicked:!1})),[H=[],W]=j.useState(se);(se.length!==H.length||H.length===1&&H[0].color!==se[0].color)&&W(se);const V="rgba(120, 119, 120, 0.27)",ve=(A={})=>{const M=se.findIndex(L=>L.label===A.label);W(H.map((L,q)=>({...L,current:q===M||L.clicked?L.default:V})))},Re=()=>{const A=H.some(M=>M.clicked);W(H.map(M=>({...M,current:A&&M.clicked||!A?M.default:V})))},Me=(A={})=>{const M=se.findIndex(q=>q.label===A.label),L=H.map((q,ce)=>{const he=ce===M&&!q.clicked;return{...q,current:he||ce!==M&&q.clicked?q.default:V,clicked:ce===M?he:q.clicked}});W(L)},ye={anchor:"top-right",direction:"column",justify:!1,translateX:-10,translateY:10,itemsSpacing:0,itemDirection:"right-to-left",itemWidth:80,itemHeight:20,itemOpacity:1,symbolSize:12,symbolShape:"square",symbolBorderColor:"rgba(0, 0, 0, .9)",itemTextColor:h.textColor},we=[];if(w.lines.length<1&&Y.length>10){const A=[],M=[],L=Math.ceil(Y.length/2);Y.forEach(({label:q,color:ce},he)=>{const{current:Se}=H.find(ne=>ne.label===q)||{},Z={label:q,color:Se||ce};he<L?A.push(Z):M.push(Z)}),we.push({...ye,data:A,anchor:"top-left",direction:"column",translateX:10,itemDirection:"left-to-right"},{...ye,data:M})}const Qe=we.length>0?we.map(A=>({...A,onMouseEnter:ve,onMouseLeave:Re,onClick:Me})):[{...ye,onMouseEnter:ve,onMouseLeave:Re,onClick:Me}],De=x.concat(X),Ee=Go(o,h,De),ue=A=>A.some(M=>((M==null?void 0:M.data)||[]).length),_e=Wo(x,N)>90?"%Y":"%y/%m";return ue(De)&&n.jsxs("div",{className:"z-10 w-full max-w-mw",children:[i&&m.length>0&&n.jsx(rn,{graphInfo:i,setGraph:u,graphs:m}),n.jsxs("div",{className:"flex flex-wrap justify-between",children:[n.jsx(Ue,{type:"line",text:e,items:le}),!s&&O.length>0&&n.jsx(Ue,{type:"line",items:O})]}),n.jsx("div",{className:"chart-wrap",children:n.jsx(Ia,{margin:{top:14,right:50,bottom:50,left:50},data:De,colors:H.map(A=>A.current),lineWidth:2,curve:"monotoneX",animate:!1,isInteractive:p,xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:z,max:B},axisBottom:{format:_e,tickSize:0,tickPadding:10,tickRotation:-45},legends:r?Qe:[],axisLeft:{...!p&&{renderTick:void 0},tickSize:0,tickValues:8},pointLabelYOffset:0,...Ee.length&&{markers:Ee},...X.length&&{axisRight:{...!p&&{renderTick:void 0},tickSize:0,tickValues:8,format:A=>{const M=Math.round(A*(I/B));return A<0?A:zo(M)}}},enableGridX:!1,enableSlices:"x",sliceTooltip:Yo,theme:h,layers:["grid","markers","areas",Qo(U),"slices","points","axes","legends"]})}),l.length>0&&n.jsx(Ro,{data:l,dataKeys:c,tableOpenedByDefault:d})]})},_o=(e,t)=>{const s=(e==null?void 0:e.date)||"",a=(t==null?void 0:t.date)||"";return new Date(s).getTime()-new Date(a).getTime()},et=e=>(e==null?void 0:e.description)||"",Jo=(e,t)=>{let s;try{s=Ls.lt(et(e),et(t))?-1:1}catch{s=0}return s},Xo=(e=[])=>{const t=e.filter(r=>/^v?\d+\.\d+\.\d+$/.test(et(r))).sort(Jo),s=t.map((r,l)=>{const c=et(r);let i="";try{const d=l>0?et(t[l-1]):"v0.0.0",g=Ls.diff(d,c)||"EMPTY";i={minor:"MINOR",major:"MAJOR",patch:"PATCH",premajor:"PATCH",preminor:"PATCH",prepatch:"PATCH",prerelease:"PATCH",EMPTY:"PATCH"}[g]||"PATCH"}catch{i="PATCH"}const u=/T/.test(r.date)?r.date.split("T")[0]:r.date;return{...r,date:u,releaseType:i||"MAJOR"}}),a=s.length>70?r=>r.releaseType!=="PATCH":()=>!0;return s.filter(a).sort((r,l)=>_o(r,l))},Ie=({usersInfo:e={},releases:t=[],events:s=[]})=>{const a=[];Object.values(e).forEach(({name:c="",userId:i="",dates:u=[]})=>{u.forEach(m=>{const{startDate:d,endDate:g}=m;d&&a.push({date:d,description:c||i,releaseType:"MINOR"}),g&&a.push({date:g,description:c||i,releaseType:"PATCH"})})});const o=s.map(({date:c,name:i}={})=>({date:c,description:i,releaseType:"EVENT"})),r=(c,i)=>{const u=(c==null?void 0:c.date)||"",m=(i==null?void 0:i.date)||"";return new Date(u).getTime()-new Date(m).getTime()};return[...a,...o,...t].sort(r)},xn=(e,t,s=[])=>new Promise((a,o)=>{const[r,...l]=e;Promise.all(r.map(c=>t(c))).then(c=>l&&l.length?xn(l,t,c).then(i=>a(s.concat(i))).catch(o):a(s.concat(c))).catch(o)}),tt=(e=[],t,s=2)=>{const a=Ma(s,e);return e.length?xn(a,t):[]},qt=(e,t="DESC",s="")=>a=>{const o=k("",e,a),r=o&&new Date(o),l=s?new Date(s):new Date;return t==="DESC"?r&&nt(r,l):r&&ze(r,l)},yt=e=>e?` after:"${e}" `:"",Ut=(e,{oldest:t,newest:s})=>{const a=e==="DESC"?t:s,r=a?` ${e==="DESC"?"after":"before"}:"${a}" `:"",l=r?50:10;return`
    ${e==="DESC"?`last: ${l}`:`first: ${l}`}
    ${r}
  `},Gt=e=>({oldest:t,newest:s})=>yt(e==="DESC"?t:s),fe="pageInfo { endCursor hasNextPage hasPreviousPage startCursor }",Ge=e=>`
    comments(first: ${e?100:10} ${yt(e)}) {
      totalCount
      edges {
        node {
          author {
            login
            url
          }
          publishedAt
          body
        }
      }
      ${fe}
    }
`,vn=e=>t=>`
pullRequests(
  first: 50
  ${Gt(e)(t)}
  states: [MERGED]
  orderBy: {field: CREATED_AT direction: ${e}}
) {
  totalCount
  edges {
    node {
      id
      url
      author {
        login
        url
      }
      repository {
        name
        owner {
          login
        }
      }
      additions
      deletions
      mergedAt
      createdAt
      commits(first:1) {
        edges {
          node {
            commit {
              committedDate
            }
          }
        }
      }
      ${wn(void 0)}
      ${Ge(void 0)}
    }
  }
  ${fe}
}`,yn=e=>t=>`
issues(
  ${Gt(e)(t)}
  first: 50
  orderBy: { field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      title
      url
      createdAt
      closedAt
      state
      labels(first:5) {
        edges {
          node {
            name
          }
        }
      }
    }
  }
  ${fe}
}`,Zo=e=>t=>`
releases(
  ${Gt(e)(t)}
  first: 50
  orderBy:{ field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      id
      name
      createdAt
      tag {
        name
      }
    }
  }
  ${fe}
}`,wn=e=>`
    reviews(first: ${e?100:10} ${yt(e)}) {
      edges {
        node {
          id
          state
          author {
            login
            url
          }
          ${Ge(void 0)}
        }
      }
      ${fe}
    }
`,bn=(e={},t="",s={},a)=>o=>{const{hasNextPage:r=!1,startCursor:l,endCursor:c}=k({},["data","result",o,"pageInfo"],s),i=k([],["data","result",o,"edges"],s),u=o==="pullRequests"?"mergedAt":"createdAt",m=ae(t)?i.filter(qt(["node",u],a,t)):[],d={pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"},h=k(a==="DESC"?c:l,[d[o],"oldest"],e),f=k(a==="ASC"?c:l,[d[o],"newest"],e),v=m.length,x=de([[R(r===!1),re],[R(!ae(t)),R(r)],[R(v===0),re],[R(v>0&&i.length>v),re],[K,R(r)]])();return{newest:a==="ASC"&&c?c:f,oldest:a==="DESC"&&c?c:h,hasNextPage:r,hasNextPageForDate:x}},er=(e={},t="",s={},a)=>o=>{const r=o==="usersReviews"?["data","result"]:["data","result",o],{hasNextPage:l=!1,hasPreviousPage:c=!1,startCursor:i,endCursor:u}=k({},[...r,"pageInfo"],s),m=k([],[...r,"edges"],s),d=["pullRequests","usersReviews"].includes(o)?"mergedAt":"createdAt",g=ae(t)?m.filter(qt(["node",d],a,t)):[],h={commitComments:"commitCommentsPagination",issueComments:"issueCommentsPagination",usersReviews:"usersReviewsPagination"},p=o==="usersReviews"||a==="ASC"?"right":"left",v=k(p==="right"?u:i,[h[o],"oldest"],e),b=k(p==="right"?i:u,[h[o],"newest"],e),y=p==="right"?l:c,w=g.length,P=de([[R(y===!1),re],[R(!ae(t)),R(y)],[R(w===0),re],[R(w>0&&m.length>w),re],[K,R(y)]])();return{newest:p==="right"&&u?u:b,oldest:p==="left"&&i?i:v,hasNextPage:y,hasNextPageForDate:P}},tr=(e={},t="",s={},a)=>{const{hasNextPage:o=!1,hasPreviousPage:r=!1,startCursor:l,endCursor:c}=k({},["data","result","pageInfo"],s),i=k([],["data","result","edges"],s),u=ae(t)?i.filter(qt(["node","mergedAt"],a,t)):[],d=k(a==="DESC"?c:l,["usersReviewsPagination","oldest"],e),h=k(a==="DESC"?l:c,["usersReviewsPagination","newest"],e),p=a==="DESC"?o:r,f=u.length,v=de([[R(p===!1),re],[R(!ae(t)),R(p)],[R(f===0),re],[K,R(p)]])();return{newest:a==="ASC"&&l?l:h,oldest:a==="DESC"&&c?c:d,hasNextPage:p,hasNextPageForDate:v}},zt=e=>{const t=["issues","pullRequests","releases"],[s]=t.map(a=>{var o,r,l;return((l=(r=(o=e==null?void 0:e.data)==null?void 0:o.result)==null?void 0:r[a])==null?void 0:l.totalCount)||0}).sort((a,o)=>o-a);return Math.ceil(s/50)-1},sr=e=>t=>`
    commitComments(
      ${Ut(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          commit {
            repository {
              nameWithOwner
            }
            url
            associatedPullRequests(last: 10) {
              edges {
                node {
                  number
                  url
                }
              }
            }
          }
          body
        }
      }
      ${fe}
    }
`,nr=e=>t=>`
    issueComments(
      ${Ut(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          url
          repository {
            nameWithOwner
          }
          issue {
            number
          }
          pullRequest {
            number
          }
          body
        }
      }
      ${fe}
    }
`,ar=e=>({user:t,sortDirection:s="DESC",amountOfData:a,usersReviewsPagination:o={}})=>({query:`{
    result: search(
      query: "type:pr state:closed reviewed-by:${t}"
      type: ISSUE
      ${Ut(s,o)}
    ) {
      issueCount
      ${fe}
      edges {
        node {
          ... on PullRequest {
            id
            number
            url
            author {
              login
              url
            }
            repository {
              name
              owner {
                login
              }
            }
            additions
            deletions
            mergedAt
            createdAt
            ${Ge(void 0)}
            reviews(last: 10 states: [COMMENTED,APPROVED,CHANGES_REQUESTED] author: "${t}") {
              ${fe}
              edges {
                node {
                  id
                  state
                  author {
                    login
                    url
                  }
                  ${Ge(void 0)}
                }
              }
            }
          }
        }
      }
    }
  }`,sortDirection:s,user:t,resultInfo:r=>{const l=tr({usersReviewsPagination:o,amountOfData:a},e,r,s),c=de([[R(a==="all"),R(a)],[R(ae(e)),R(a)],[R(Number.isInteger(a)),R(a-1)],[K,zt]])(r),i={usersReviewsPagination:Object.assign(l,{hasNextPage:!1})},u=ae(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:i.usersReviewsPagination[u]===!0,nextPageInfo:{...i,amountOfData:c}}},fillerType:"pullRequests",hasMoreResults:[o.hasNextPage].some(r=>r!==!1)}),Ke=e=>{const{hasNextPageForDate:t}=e;return t!==!1},jn=e=>({user:t,sortDirection:s="DESC",amountOfData:a,issuesPagination:o={},prPagination:r={},commitCommentsPagination:l={},issueCommentsPagination:c={}})=>({query:`{
    result: user(login: "${t}") {
      login
      ${Ke(c)?nr(s)(c):""}
      ${Ke(l)?sr(s)(l):""}
      ${Ke(r)?vn(s)(r):""}
      ${o[e?"hasNextPageForDate":"hasNextPage"]!==!1?yn(s)(o):""}
    }
  }`,sortDirection:s,user:t,resultInfo:i=>{const u=bn({issuesPagination:o,prPagination:r,amountOfData:a},e,i,s),m=er({commitCommentsPagination:l,issueCommentsPagination:c,amountOfData:a},e,i,s),d=de([[R(a==="all"),R(a)],[R(ae(e)),R(a)],[R(Number.isInteger(a)),R(a-1)],[K,zt]])(i);Object.assign(u("pullRequests"),{hasNextPage:!1});const g={prPagination:Object.assign(u("pullRequests"),{hasNextPage:!1}),issuesPagination:Object.assign(u("issues"),{hasNextPage:!1}),commitCommentsPagination:Object.assign(m("commitComments"),{hasNextPage:!1}),issueCommentsPagination:Object.assign(m("issueComments"),{hasNextPage:!1})},h=ae(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(g).some(f=>f[h]===!0),nextPageInfo:{...g,amountOfData:d}}},hasMoreResults:[r.hasNextPage,o.hasNextPage,l.hasNextPage,c.hasNextPage].some(i=>i!==!1)}),Nn=e=>({org:t,repo:s,sortDirection:a="DESC",amountOfData:o,issuesPagination:r={},releasesPagination:l={},prPagination:c={}})=>({query:`{
      result: repository(name: "${s}" owner: "${t}") {
        id
        description
        name
        owner {
          org: login
        }
        ${Ke(c)?vn(a)(c):""}
        ${Ke(r)?yn(a)(r):""}
        ${Ke(l)?Zo(a)(l):""}
      }
    }`,sortDirection:a,resultInfo:i=>{const u=bn({issuesPagination:r,releasesPagination:l,prPagination:c},e,i,a),m=de([[R(o==="all"),R(o)],[R(ae(e)),R(o)],[R(Number.isInteger(o)),R(o-1)],[K,zt]])(i),d={prPagination:Object.assign({hasNextPage:!1},u("pullRequests")),issuesPagination:Object.assign({hasNextPage:!1},u("issues")),releasesPagination:Object.assign({hasNextPage:!1},u("releases"))},g=ae(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(d).some(p=>p[g]===!0),nextPageInfo:{...d,amountOfData:m}}},fillerType:"batchedQuery",hasMoreResults:[c.hasNextPage,r.hasNextPage,l.hasNextPage].some(i=>i!==!1)}),or=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.comments)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.comments)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:""}),rr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${wn(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.reviews)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.reviews)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.reviews)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:"pullRequestReviewComments"}),lr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequestReview {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.comments)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.comments)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:""}),cr=({org:e,orgPagination:t={}})=>({query:`{
    organization(login: "${e}") {
      repositories(
        first:100
        ${yt(t==null?void 0:t.cursor)}
        orderBy: {field: NAME, direction: ASC}
      ) {
        edges {
          node {
            name
          }
          cursor
        }
        pageInfo {
          endCursor
          hasNextPage
        }
      }
    }
  }`,fillerType:"org",resultInfo:s=>{var r,l,c,i,u,m,d,g,h,p,f,v,x,b,y;const a=((i=(c=(l=(r=s==null?void 0:s.data)==null?void 0:r.organization)==null?void 0:l.repositories)==null?void 0:c.pageInfo)==null?void 0:i.hasNextPage)||!1,o=((g=(d=(m=(u=s==null?void 0:s.data)==null?void 0:u.organization)==null?void 0:m.repositories)==null?void 0:d.pageInfo)==null?void 0:g.endCursor)||"";return{rawData:s,results:((f=(p=(h=s==null?void 0:s.data)==null?void 0:h.organization)==null?void 0:p.repositories)==null?void 0:f.edges)||[],hasNextPage:((y=(b=(x=(v=s==null?void 0:s.data)==null?void 0:v.organization)==null?void 0:x.repositories)==null?void 0:b.pageInfo)==null?void 0:y.hasNextPage)||!1,nextPageInfo:{orgPagination:{cursor:o,hasNextPage:a,hasNextPageForDate:a},amountOfData:"all"}}}}),ir=({org:e,team:t})=>({query:`{
    organization(login: "${e}") {
      team(slug:"${t}") {
        members(
          first:100
        ) {
          edges {
            node {
              name
              email
              login
              createdAt
            }
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
    }
  }`,fillerType:"team",resultInfo:s=>{var a,o,r,l,c;return{results:((c=(l=(r=(o=(a=s[0])==null?void 0:a.data)==null?void 0:o.organization)==null?void 0:r.team)==null?void 0:l.members)==null?void 0:c.edges)||[],hasNextPage:!1}}}),dr=(e,t)=>{const a={org:["data","organization","repositories","edges"],team:["data","organization","team","members","edges"]}[e];return a?k([],a,t):t},mr=e=>{const t=u=>{const d={pullRequests:[i,l],pullRequestReviewComments:[r],batchedQuery:[i,l]}[u]||[];return g=>d.length?Promise.all(d.map(h=>h(g))).then(h=>h.reduce((p,f)=>f(p),g)):dr(u,g)},s=u=>m=>async(d=[])=>{const{hasNextPage:g}=m,{query:h,resultInfo:p,fillerType:f}=u(m),v=g?await e(h):{},{results:x=[],hasNextPage:b,nextArgs:y}=p(v),w=[...d,...x];return b&&f?s(u)(y)(w):await t(f)(w)},a=u=>m=>d=>{const g=Object.assign(u.node,{[m]:d});return Object.assign(u,{node:g})},o=u=>m=>{var d,g,h,p,f,v,x;return{nodeId:((d=m==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((p=(h=(g=m==null?void 0:m.node)==null?void 0:g[u])==null?void 0:h.pageInfo)==null?void 0:p.endCursor)||"",hasNextPage:((x=(v=(f=m==null?void 0:m.node)==null?void 0:f[u])==null?void 0:v.pageInfo)==null?void 0:x.hasNextPage)||!1}},r=async(u=[])=>{const d=await tt(u,async g=>{var v,x;const h=((x=(v=g==null?void 0:g.node)==null?void 0:v.comments)==null?void 0:x.edges)||[],p=o("comments")(g),f=await s(lr)(p)(h);return a(g)("comments")({edges:f})},5);return()=>d},l=async u=>{var h,p,f;const m=((f=(p=(h=u==null?void 0:u.data)==null?void 0:h.result)==null?void 0:p.pullRequests)==null?void 0:f.edges)||[],g=await tt(m,async v=>{var w,P,N;const x=((P=(w=v==null?void 0:v.node)==null?void 0:w.reviews)==null?void 0:P.edges)||[],b=o("reviews")(v),y=await s(rr)(b)(x);return{nodeId:(N=v==null?void 0:v.node)==null?void 0:N.id,results:{edges:y}}},5);return v=>{const x=c(v)("reviews")(g);return{data:Object.assign((v==null?void 0:v.data)||{},{result:Object.assign(k({pullRequests:x},["data","result"],v))})}}},c=u=>m=>d=>{var f,v,x,b,y;const g=((v=(f=u==null?void 0:u.data)==null?void 0:f.result)==null?void 0:v.pullRequests)||{},p=(((y=(b=(x=u==null?void 0:u.data)==null?void 0:x.result)==null?void 0:b.pullRequests)==null?void 0:y.edges)||[]).map(w=>{var I;const P=((I=w==null?void 0:w.node)==null?void 0:I.id)||"",N=d.find(S=>S.nodeId===P);return N?a(w)(m)(N.results):w});return Object.assign(g,{edges:p})},i=async u=>{var h,p,f;const m=((f=(p=(h=u==null?void 0:u.data)==null?void 0:h.result)==null?void 0:p.pullRequests)==null?void 0:f.edges)||[],g=await tt(m,async v=>{var w,P,N;const x=((P=(w=v==null?void 0:v.node)==null?void 0:w.comments)==null?void 0:P.edges)||[],b=o("comments")(v),y=await s(or)(b)(x);return{nodeId:((N=v==null?void 0:v.node)==null?void 0:N.id)||"",results:{edges:y}}},5);return v=>{var b;const x=c(v)("comments")(g);return{data:Object.assign((v==null?void 0:v.data)||{},{result:Object.assign(((b=v==null?void 0:v.data)==null?void 0:b.result)||{pullRequests:x})})}}};return t},ur=e=>new Promise((t,s)=>{e.json().then(a=>e.status===200?t(a):s(Object.assign(a,{status:e.status}))).catch(a=>{console.log("-=-=--parseJSON error",a),a.status=e.status,s(a)})}),fs=({message:e=""})=>/(You have triggered an abuse detection mechanism|You have exceeded a secondary rate limit)/.test(e),hr=({message:e=""})=>/Unexpected end of JSON input/.test(e),gr=e=>t=>fetch(e.enterpriseAPI||"https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({query:t})}).then(ur),pr=(e,{amountOfData:t})=>de([[R(e===!1),re],[R(e&&typeof t=="number"&&t>=1),K],[R(e&&t==="all"),K],[K,re]])(),fr=(e=3e4)=>new Promise(t=>setTimeout(()=>t(),e));let xs=0;const xr=async(e,t)=>(console.log("-=-=--paused",Date.now()),await fr(),console.log("-=-=--resume",Date.now()),++xs,xs<=10?xe(e,t):{errorMessage:{level:"error",message:"Hit rate limit over ten times"},fetchInfo:e.fetchInfo,results:t,reviewResults:[]}),Dt=(e,t)=>t.reduce((a,o)=>{var l,c,i;const r=((i=(c=(l=o==null?void 0:o.data)==null?void 0:l.result)==null?void 0:c[e])==null?void 0:i.edges)||[];return a+r.length},0),vr=e=>(t,s=[])=>{var u,m,d,g;const o=k(!1,[{pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"}[t],"hasNextPageForDate"],e),r=s[s.length-1]||{},l=((d=(m=(u=r==null?void 0:r.data)==null?void 0:u.result)==null?void 0:m[t])==null?void 0:d.edges)||[],c=l[l.length-1],i=t==="pullRequests"?"createdAt":"closedAt";return o&&((g=c==null?void 0:c.node)==null?void 0:g[i])||""},xe=async({fetchInfo:e,queryInfo:t},s=[])=>{const{query:a,resultInfo:o,fillerType:r,user:l,sortDirection:c}=t(e),i=vr(e),[u]=[i("pullRequests",s),i("issues",s),i("releases",s)].filter(Boolean).sort($o(c)),m={prCount:Dt("pullRequests",s),issueCount:Dt("issues",s),releasesCount:Dt("releases",s),latestItemDate:u,user:l,repo:e.repo,repos:e.repos||[],paused:!1};console.log("-=-=--statusPayload",m),T.setState({fetchStatus:m});const d=gr(e);try{const g=await d(a);if(fs(g))throw new Error("Abuse rate triggered");const h=await mr(d)(r)(g),p=[...s,h],{hasNextPage:f,nextPageInfo:v={}}=o(g),x=Ea(e,v);return pr(f,x)?xe({fetchInfo:x,queryInfo:t},p):{fetchInfo:x,results:p,reviewResults:[]}}catch(g){const h=g,p=de([[fs,K],[hr,K],[x=>x.status===500,K],[x=>x.status===502,K],[x=>x.message==="Abuse rate triggered",K],[be(ct(/ENOTFOUND|ECONNRESET/),Be("","code")),K],[be(ct(/fetch/i),Be("","message")),K],[K,re]]),v=de([[p,R({level:"warn",message:"You may have triggered the api's abuse detection, please wait a minute before trying again"})],[be(ct(/50\d/i),Be("","status")),R({level:"error",message:"GitHub API 500 error, could be CORS or rate limiting"})],[x=>x.status===401,R({level:"error",message:"GitHub token does not have correct settings, please see README"})],[be(ct(/40\d/i),Be("","status")),x=>({level:"error",message:`Auth error: ${x.message||"UNKOWN"}`})],[x=>x.status===void 0,R({level:"error",message:"Error while processing data after, please check the console"})],[K,x=>({level:"error",message:`ERROR: ${x.message||"UNKOWN"}`})]])(h);if(p(h))return T.setState({fetchStatus:{...m,paused:!0}}),xr({fetchInfo:e,queryInfo:t},s);throw new Error(v.message)}},yr=async({fetchInfo:e,untilDate:t})=>{try{const a=e.userIds.map(c=>({fetchInfo:{...e,issuesPagination:e.issuesPagination[c]||{hasNextPage:!0},prPagination:e.prPagination[c]||{hasNextPage:!0},user:c},queryInfo:jn(t)})),o=await tt(a,xe,1),r=[];return o.forEach(({fetchInfo:c,results:i})=>{r.push(i);const u=(c==null?void 0:c.user)||"";c.issuesPagination[u]=c==null?void 0:c.issuesPagination,c.prPagination[u]=c==null?void 0:c.prPagination}),{fetchInfo:e,results:r.flat()}}catch(s){throw console.log("-=-=--getUsersData:error",s),s}},wr=async({fetchInfo:e,untilDate:t})=>{var s,a,o,r;try{const[l]=e.userIds||[],i={fetchInfo:{...e,issuesPagination:(e==null?void 0:e.issuesPagination[l])||{hasNextPage:!0},prPagination:(e==null?void 0:e.prPagination[l])||{hasNextPage:!0},user:l},queryInfo:jn(t)},u=await xe(i),m=u.results,d={fetchInfo:{...e,usersReviewsPagination:((s=e.usersReviewsPagination)==null?void 0:s[l])||{hasNextPage:!0},user:l},queryInfo:ar(t)},g=await xe(d),h=g.results,p={issuesPagination:{[l]:(a=u.fetchInfo)==null?void 0:a.issuesPagination},prPagination:{[l]:(o=u.fetchInfo)==null?void 0:o.prPagination},usersReviewsPagination:{[l]:((r=g.fetchInfo)==null?void 0:r.usersReviewsPagination)||{hasNextPage:!0}}};return{fetchInfo:{...e,...p},results:m.flat(),reviewResults:h.flat()}}catch(l){throw console.log("-=-=--getUserData:error",l),l}},br=async({fetchInfo:e,untilDate:t})=>{try{const s=await xe({fetchInfo:e,queryInfo:cr}),o=((s==null?void 0:s.results.flat())||[]).filter(m=>{var d;return(d=m==null?void 0:m.node)==null?void 0:d.name}).map(m=>{var d;return(d=m==null?void 0:m.node)==null?void 0:d.name}),r=e.org,l=o.map(m=>({fetchInfo:{...e,issuesPagination:(e==null?void 0:e.issuesPagination[m])||{hasNextPage:!0},prPagination:(e==null?void 0:e.prPagination[m])||{hasNextPage:!0},org:r,repo:m,repos:o},queryInfo:Nn(t)})),c=await tt(l,xe,1),i=[];return c.forEach(({fetchInfo:m,results:d=[]})=>{i.push(d);const{repo:g,issuesPagination:h,releasesPagination:p,prPagination:f}=m;m.issuesPagination[g]=h,m.releasesPagination[g]=p,m.prPagination[g]=f}),{fetchInfo:e,results:i.flat(),reviewResults:[]}}catch(s){throw console.log("-=-=--getOrgData:error",s),s}},jr=(e,t=[])=>{var r;const s=e==="DESC"?0:-1,a=t.at(s),o=((r=a==null?void 0:a.node)==null?void 0:r.mergedAt)||(a==null?void 0:a.mergedAt);return new Date(o)},Nr=(e,t=[])=>{const{untilDate:s="",amountOfData:a=0,sortDirection:o="DESC"}=e,r={months:a},l=be(Vs(String),Pt("amountOfData")),c=be(d=>!(typeof d=="string"&&d.length>1),Pt("untilDate")),i=be(d=>Tt(d,r),d=>d?new Date(d):new Date,Pt("untilDate")),u=be(({prDate:d,sortDirection:g})=>g==="DESC"?Tt(d,r):kt(d,r),d=>({prDate:jr(d,t),sortDirection:d}),Be("","sortDirection")),[,m]=[[l(e),""],[c(e)&&t.length>0,u(e)],[o==="DESC",i(e)],[o==="ASC",kt(new Date(s),r)],[!0,""]].find(([d])=>d)||["",""];return m},Pr=e=>t=>{const s={};return t.forEach(a=>{const o=$a(e,a);s[o]=(s[o]||0)+1}),s},Pn=Pr(["node","author","login"]),Rr=e=>{const t={};return e.forEach(({author:s="",score:a=0})=>{t[s]=(t[s]||0)+a}),t},vs=(e=[])=>{const t=new Oa,s=e.map(a=>{var l,c,i;const o=((l=a==null?void 0:a.node)==null?void 0:l.body)||"";return{author:((i=(c=a==null?void 0:a.node)==null?void 0:c.author)==null?void 0:i.login)||"",score:t.analyze(o).score}});return{sentimentScore:Bt("score")(s),sentiments:Rr(s)}},Dr=e=>{var a,o;const t=((o=(a=e==null?void 0:e.node)==null?void 0:a.reviews)==null?void 0:o.edges)||[],s=[];return t.forEach(r=>{var c,i;const l=((i=(c=r==null?void 0:r.node)==null?void 0:c.comments)==null?void 0:i.edges)||[];s.push(...l)}),s},Rn=e=>t=>{var s,a;return e.includes((a=(s=t==null?void 0:t.node)==null?void 0:s.author)==null?void 0:a.login)},Sr=e=>t=>{var o,r;const s=!Rn(e)(t);return!/\/apps\//.test(((r=(o=t==null?void 0:t.node)==null?void 0:o.author)==null?void 0:r.url)||"")&&s},St=(e,t,s)=>{var p,f;const a=(f=(p=s==null?void 0:s.node)==null?void 0:p.author)==null?void 0:f.login,o=k([],["node","comments","edges"],s),r=Dr(s),c={general:o,code:r,all:[...r,...o]}[e]||[],i=c.filter(Sr([...t,a])),{sentimentScore:u=0,sentiments:m={}}=vs(i),d=c.filter(Rn([a])),{sentimentScore:g=0}=vs(d),h=e==="all"?"c":`${e}C`;return{[`${h}omments`]:i.length,[`${h}ommenters`]:Pn(i),[`${h}ommentSentimentScore`]:u,[`${h}ommentSentiments`]:m,[`${h}ommentsAuthor`]:d.length,[`${h}ommentAuthorSentimentScore`]:g,[`${h}ommentSentimentTotalScore`]:(g||0)+(u||0)}},Cr=(e,t)=>{const s=St("general",e,t),a=St("code",e,t),o=St("all",e,t);return{...s,...a,...o}},Ar=e=>{var o,r;const s=(((r=(o=e==null?void 0:e.node)==null?void 0:o.reviews)==null?void 0:r.edges)||[]).filter(l=>{var c;return((c=l==null?void 0:l.node)==null?void 0:c.state)==="APPROVED"}),a=Pn(s);return{approvals:s.length,approvers:a}},Tr=(e=[],t)=>{var x,b,y,w,P,N;const s=k("",["node","repository","owner","login"],t),a=k("",["node","repository","name"],t),o=k("",["node","author","login"],t),r=k("",["node","author","url"],t),l=k("",["node","url"],t),c=k(0,["node","additions"],t),i=k(0,["node","deletions"],t),u=k("",["node","createdAt"],t),m=k("",["node","mergedAt"],t),d=((N=(P=(w=(y=(b=(x=t==null?void 0:t.node)==null?void 0:x.commits)==null?void 0:b.edges)==null?void 0:y[0])==null?void 0:w.node)==null?void 0:P.commit)==null?void 0:N.committedDate)||"",g=ze(new Date(d),new Date(u))?d:u,h=Cr(e,t),{approvals:p,approvers:f}=Ar(t);return{repo:a,org:s,author:/\/apps\//.test(r)?"GIT_APP_PR":o,url:l,additions:c,deletions:i,prSize:c+i,mergedAt:m,cycleTime:pe(new Date(m),new Date(g))||1,age:pe(new Date(m),new Date(u))||1,approvals:p,approvers:f,...h}},Dn=(e,t)=>(s,a)=>{const o=s[e],r=a[e];return t==="DESC"?new Date(r).getTime()-new Date(o).getTime():new Date(o).getTime()-new Date(r).getTime()},ys=(e,t=[])=>{const{excludeIds:s=[]}=e;return t.map(o=>{var r,l,c,i,u;return((c=(l=(r=o==null?void 0:o.data)==null?void 0:r.result)==null?void 0:l.pullRequests)==null?void 0:c.edges)||((u=(i=o==null?void 0:o.data)==null?void 0:i.result)==null?void 0:u.edges)}).flat().map(o=>Tr(s,o))},kr=(e="")=>({startDate:t="",endDate:s=""}={})=>{const a=new Date(e),o=t?nt(a,new Date(t))||qe(a,new Date(t)):!0,r=s?ze(a,new Date(s))||qe(a,new Date(s)):!0;return o&&r},Ir=(e,t=[])=>{const s=e.usersInfo||{};return t.filter(o=>{const r=o.author,{dates:l=[]}=s[r]||{},c=kr(o.mergedAt);return l.length>0?l.some(c):!0})},ws=({excludeIds:e=[]},{reportStartDate:t="",reportEndDate:s=""},a=[])=>{const o=[];return[a.filter(l=>{const c=Be("","author",l),i=["GIT_APP_PR",...e].some(h=>h===c),u=l.mergedAt,m=qe(new Date(u),new Date(t))||qe(new Date(u),new Date(s)),d=nt(new Date(u),new Date(t))&&ze(new Date(u),new Date(s)),g=(m||d)&&!i;return!g&&o.push(l),g}).sort(Dn("mergedAt","ASC")),o]},Sn=e=>({reportStartDate:t="",reportEndDate:s=""},a=[])=>{const o=[];return[a.filter(l=>{const c=l==null?void 0:l[e],i=qe(new Date(c),new Date(t))||qe(new Date(c),new Date(s)),u=nt(new Date(c),new Date(t))&&ze(new Date(c),new Date(s)),m=i||u;return!m&&o.push(l),m}).sort(Dn(e,"ASC")),o]},Mr=Sn("mergedAt"),Er=Sn("date"),$r=e=>{var l,c,i,u,m,d;const t=((l=e==null?void 0:e.node)==null?void 0:l.createdAt)||"",s=((c=e==null?void 0:e.node)==null?void 0:c.closedAt)||"",a=((i=e==null?void 0:e.node)==null?void 0:i.title)||"",o=((u=e==null?void 0:e.node)==null?void 0:u.url)||"",r=((d=(m=e==null?void 0:e.node)==null?void 0:m.labels)==null?void 0:d.edges)||[];return{mergedAt:t,createdAt:t,age:pe(new Date(s),new Date(t))||1,url:o,isBug:/bug/i.test(a)||r.some(g=>{var h;return/bug/i.test((h=g==null?void 0:g.node)==null?void 0:h.name)})}},Or=(e=[])=>{const t=e.map(r=>{var l,c,i;return((i=(c=(l=r==null?void 0:r.data)==null?void 0:l.result)==null?void 0:c.issues)==null?void 0:i.edges)||[]});return Ks(t).filter(Boolean).map(r=>$r(r))},Br=e=>{var a,o,r;const t=((a=e==null?void 0:e.node)==null?void 0:a.createdAt)||"",s=((r=(o=e==null?void 0:e.node)==null?void 0:o.tag)==null?void 0:r.name)||"";return{date:t,description:s}},Fr=(e=[])=>{const t=e.map(r=>{var l,c,i;return((i=(c=(l=r==null?void 0:r.data)==null?void 0:l.result)==null?void 0:c.releases)==null?void 0:i.edges)||[]});return Ks(t).filter(Boolean).map(r=>Br(r))},Cn=e=>typeof e=="string"&&e.length&&e||/^-?[\d.]+$/.test(`${e}`)&&/^-?[^0]/.test(`${e}`)&&e||Array.isArray(e)&&e.length&&Lr(e)||e&&Object.keys(e).length&&An(e)||typeof e=="boolean"&&e,Lr=e=>{const t=[];return e.forEach(s=>{const a=Cn(s);a&&t.push(a)}),t.length&&t},An=e=>{const t={};return Object.entries(e).forEach(([s,a])=>{const o=Cn(a);o&&(t[s]=o)}),Object.keys(t).length&&t},ht={author:"",approvalsGiven:0,approvalsByUser:{},commentsGiven:0,commentsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,totalPRs:0,uniquePRsContributedTo:0,commentsByUser:{},prSizes:[],prTotalAdditions:0,prTotalDeletions:0,prAdditions:[],prDeletions:[],prAges:[],sentimentTotalScores:[],orgs:new Set,repos:new Set,sentimentTotalPositiveScore:0,sentimentAveragePositiveScore:0,sentimentPositiveCount:0,sentimentTotalNegativeScore:0,sentimentNegativeCount:0,sentimentAverageNegativeScore:0},Ze=(e,t,s,a)=>{const o={};return Object.entries(s).forEach(([r,l])=>{const c=e[r]||{},i={...ht,...c,user:r,[t]:(c[t]||0)+(a||l)};o[r]=i}),o},bs=(e,t,s,a,o,r)=>{const l={};return Object.entries(s).filter(([c])=>r&&a!==r?c===r:!0).forEach(([c,i])=>{const u=e[c]||{},m=u[t]||{},d={...m,[a]:(m[a]||0)+(o||i||0)},g={...ht,...u,author:c,[t]:d};l[c]=g}),l},wt=(e=[],t={},s="")=>{const a=new Set,o={};e.forEach(i=>{var Se;const{org:u,repo:m,author:d,additions:g=0,deletions:h=0,age:p=0,approvals:f=0,approvers:v={},comments:x=0,commenters:b={},codeComments:y=0,codeCommenters:w={},generalComments:P=0,generalCommenters:N={},commentSentimentTotalScore:I=0,commentSentimentScore:S=0,commentAuthorSentimentScore:B=0}=i;a.add(d);const z=bs(o,"commentsByUser",b,d,0,s);Object.assign(o,z);const X=bs(o,"approvalsByUser",v,d,1,s);Object.assign(o,X);const Y=Ze(o,"commentsGiven",b);Object.assign(o,Y);const le=Ze(o,"codeCommentsGiven",w);Object.assign(o,le);const O=Ze(o,"generalCommentsGiven",N);Object.assign(o,O);const U=Ze(o,"approvalsGiven",v);Object.assign(o,U);const se=Ze(o,"uniquePRsApproved",v,1);Object.assign(o,se),[...new Set([...Object.keys(w),...Object.keys(N),...Object.keys(v)])].forEach(Z=>{const ne=o[Z]||{},rt={...ht,...ne,author:Z,uniquePRsContributedTo:(ne.uniquePRsContributedTo||0)+1};o[Z]=rt}),o[d]||(o[d]={...ht}),o[d].orgs.add(u),o[d].repos.add(m);const W=I||S+B;o[d].sentimentTotalScores.push(W);const V=(Z="",ne=0)=>(o[d][Z]||0)+ne,ve=V("totalPRs",1),Re=V("prTotalAge",p),Me=Math.round(Re/ve),ye=V("prTotalAdditions",g),we=V("prTotalDeletions",h),Qe=Math.round((ye+we)/ve),De=W>0?W:0,Ee=W>0?1:0,ue=V("sentimentTotalPositiveScore",De),$e=V("sentimentPositiveCount",Ee),_e=$e?Math.round(ue/$e):0,A=W<0?W:0,M=W<0?1:0,L=V("sentimentNegativeCount",M),q=V("sentimentTotalNegativeScore",A),ce=L?Math.round(q/L):0,he={author:d,name:((Se=t[d])==null?void 0:Se.name)||d,user:d,totalPRs:ve,age:Me,prTotalAge:Re,prSize:Qe,prTotalAdditions:ye,prTotalDeletions:we,approvalsReceived:V("approvalsReceived",f),commentsReceived:V("commentsReceived",x),codeCommentsReceived:V("codeCommentsReceived",y),generalCommentsReceived:V("generalCommentsReceived",P),commentSentimentTotalScore:V("commentSentimentTotalScore",W),sentimentPositiveCount:$e,sentimentTotalPositiveScore:ue,sentimentAveragePositiveScore:_e,sentimentNegativeCount:L,sentimentTotalNegativeScore:q,sentimentAverageNegativeScore:ce,orgCount:o[d].orgs.size,repoCount:o[d].repos.size};Object.assign(o[d],he)});const r=Object.values(o).filter(({author:i})=>a.has(i)).map((i={})=>qs(["author","user","name","approvalsGiven","approvalsByUser","uniquePRsApproved","commentsGiven","commentsReceived","codeCommentsGiven","codeCommentsReceived","generalCommentsGiven","generalCommentsReceived","totalPRs","uniquePRsContributedTo","commentsByUser","prTotalAdditions","prTotalDeletions","orgCount","repoCount","user","approvalsReceived","prSize","prTotalAge","age","sentimentAveragePositiveScore","sentimentTotalPositiveScore","sentimentAverageNegativeScore","sentimentTotalNegativeScore"],i)),l=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"];return r.filter(({author:i})=>Object.keys(t).length>0?t[i]:!0).sort(Pe(l))},js=Us(La(","),Ba(Fa),Gs(Boolean)),Vr=e=>{const{org:t="",repo:s="",token:a="",userIds:o=[]}=e,r=[a];t&&r.push(t),s&&r.push(s);const l=r.every(m=>typeof m=="string"&&m.length>0),i=(o.length?[o]:[]).every(m=>m.length>0);if(!(l&&i))throw new Error("Not a valid request")},Kr=(e="",t="")=>(s="mergedAt",a=[])=>{const o=[],r=[],l=[],c=(i=[])=>i.forEach(u=>{const m=new Date(u[s]);ze(m,new Date(e))?o.push(u):nt(m,new Date(t))?l.push(u):r.push(u)});return a.forEach(c),[o,r,l]},Tn=(e=[])=>{const{mergedAt:t=""}=e.at(0)||{mergedAt:""},{mergedAt:s=""}=e.at(-1)||{mergedAt:""};return[t,s]},qr=async(e,t)=>{var M,L,q,ce,he,Se;Vr(e);const{filteredPRs:s=[],pullRequests:a=[],filteredReviewedPRs:o=[],reviewedPullRequests:r=[],issues:l=[],filteredIssues:c=[],releases:i=[],filteredReleases:u=[]}=t,d=Nr(e,a),{usersInfo:g,reportType:h,sortDirection:p="DESC",userIds:f=[]}=e,v={user:async()=>wr({fetchInfo:e,untilDate:d}),team:async()=>yr({fetchInfo:e,untilDate:d}),repo:async()=>xe({fetchInfo:e,queryInfo:Nn(d)}),org:async()=>br({fetchInfo:e,untilDate:d})},{fetchInfo:x,results:b=[],reviewResults:y=[]}=await v[h](),w=ys(e,b),P=Ir(e,w),N=a.concat(s).concat(P),I=(L=(M=a.at(-1))==null?void 0:M.mergedAt)==null?void 0:L.slice(0,10),S=(ce=(q=a.at(0))==null?void 0:q.mergedAt)==null?void 0:ce.slice(0,10),B=(Se=(he=w.at(-1))==null?void 0:he.mergedAt)==null?void 0:Se.slice(0,10),z=new Date().toISOString().slice(0,10),X=p==="DESC"?{reportStartDate:d||B,reportEndDate:I||z}:{reportStartDate:S,reportEndDate:d||z},[Y,le]=ws(e,X,N),U=ys(e,y).filter(({author:Z="",mergedAt:ne=""})=>ne&&Z!==f[0]),se=r.concat(o).concat(U),[H=[],W=[]]=ws(e,X,se),V=Tn(Y),ve=Fr(b),Re=Xo([...u,...i,...ve]),[Me,ye]=Er(X,Re),we=Or(b),Qe=l.concat(c).concat(we),[De,Ee]=Mr(X,Qe),ue=(Z={})=>{const ne=qs(["newest","oldest"]),rt={};return Object.entries(Z).filter(([,lt])=>Vs(Object,lt)&&Ka(ne(lt)).length>0).forEach(([lt,ia])=>{rt[lt]=ne(ia)}),{...ne(Z),...rt}},$e=wt(Y.concat(H),g),_e={pullRequests:Y,filteredPRs:le,reviewedPullRequests:H,filteredReviewedPRs:W,itemsDateRange:V,usersData:$e,releases:Me,filteredReleases:ye,issues:De,filteredIssues:Ee},A={...x,reportType:h,fetching:!1,fetchStatus:{},prPagination:ue(x.prPagination),usersReviewsPagination:ue(x.usersReviewsPagination),releasesPagination:ue(x.releasesPagination),issuesPagination:ue(x.issuesPagination)};return{newReportData:_e,newFetchInfo:A}},kn=async e=>{const t=D.getState();try{En();const{newReportData:s,newFetchInfo:a}=await qr(e,t);D.setState(o=>({...o,...s})),T.setState(o=>({...o,...a,fetching:!1,fetchStatus:{}}))}catch(s){const a=s;$n({level:"error",message:(a==null?void 0:a.message)||"Unknown error"})}},Ur=e=>new Promise((t,s)=>{e.json().then(a=>e.status===200?t(a):s(new Error(`Error status code ${e.status}`))).catch(a=>{const o=a;console.log("-=-=--parseJSON error",o),o.status=e.status,s(o)})}),In=async({fileName:e="",externalURL:t="",localData:s})=>{Mn(),En({fetchStatus:{savedReportName:e}});try{if(s)return Ps(s);const a=t?`${t}${e}.json`:`https://n07734.github.io/community-health/data/${e}.json`,o=await fetch(a).then(Ur);Ps(o)}catch(a){const o=a;console.log("-=-=--api data error",o,o.status);const r=o.status!==200?`Error status code ${o.status} loading ${e}`:`${o.message} loading ${e}`;$n({level:"error",message:r||"Unknown error"})}},Gr=e=>Us(as("HOW_TO","1: Add this file to ./src/myReports 2: Run the app. If you want multiple reports you will need to edit ./src/myReports/myReportsConfig.js."),Va(["fetches","pullRequests","filteredPRs","reviewedPullRequests","filteredReviewedPRs","userData","issues","filteredIssues","releases","teamName","chartConfig"]),Oe(["fetches","token"]),Oe(["fetches","sortDirection"]),Oe(["fetches","amountOfData"]),Oe(["fetches","prPagination","hasNextPage"]),Oe(["fetches","issuesPagination","hasNextPage"]),Oe(["fetches","releasesPagination","hasNextPage"]),as("preFetchedName",e),An),zr=()=>{const e=D.getState(),t=T.getState(),s={...e,fetches:t},{repo:a,org:o,teamName:r,userIds:l=[]}=(s==null?void 0:s.fetches)||{},c=(l==null?void 0:l.length)===1?l[0]:"",i=r||c||`${o}${a?`-${a}`:""}`,u=Gr(i)(s),m=JSON.stringify(u,null,2),d=new Blob([m],{type:"application/json"});return{href:URL.createObjectURL(d),download:`${i}.json`}},Hr=[{graphId:1,left:[{label:"*Trimmed Average PR Age (days)",color:E[2],dataKey:"age",groupMath:"trimmedAverage"}],right:[{label:"*Trimmed Average PR Size",color:E[0],dataKey:"prSize",groupMath:"trimmedAverage"}]}],Ht={fetching:!1,error:{level:"",message:""},fetchStatus:{},preFetchedError:{level:"",message:""},usersInfo:{},events:[],repo:"",org:"",teamName:"",excludeIds:[],token:"",sortDirection:"ASC",amountOfData:"all",enterpriseAPI:"",reportType:"repo",userIds:[],formUntilDate:"",prPagination:{},usersReviewsPagination:{},releasesPagination:{},issuesPagination:{}},Wt={reportDescription:"",pullRequests:[],reviewedPullRequests:[],issues:[],releases:[],usersData:[],filteredPRs:[],filteredReviewedPRs:[],filteredReleases:[],filteredIssues:[],trimmedItems:{trimmedPRs:{trimmedLeftPrs:[],trimmedRightPrs:[]},trimmedReviewedPRs:{trimmedLeftReviewedPrs:[],trimmedRightReviewedPrs:[]},trimmedReleases:{trimmedLeftReleases:[],trimmedRightReleases:[]},trimmedIssues:{trimmedLeftIssues:[],trimmedRightIssues:[]}},preFetchedName:"",chartConfig:Hr,itemsDateRange:["",""]},D=zs(()=>Wt),T=zs(()=>Ht),Ns=(e="",t="")=>{const{trimmedItems:{trimmedPRs:{trimmedLeftPrs:s=[],trimmedRightPrs:a=[]}={},trimmedReviewedPRs:{trimmedLeftReviewedPrs:o=[],trimmedRightReviewedPrs:r=[]}={},trimmedReleases:{trimmedLeftReleases:l=[],trimmedRightReleases:c=[]}={},trimmedIssues:{trimmedLeftIssues:i=[],trimmedRightIssues:u=[]}={}}={},pullRequests:m=[],reviewedPullRequests:d=[],releases:g=[],issues:h=[]}=D.getState(),{usersInfo:p}=T.getState(),f=Kr(e,t),v=[s,m,a],[x,b,y]=f("mergedAt",v),w=[o,d,r],[P,N,I]=f("mergedAt",w),S=[l,g,c],[B,z,X]=f("date",S),Y=[i,h,u],[le,O,U]=f("mergedAt",Y);D.setState({pullRequests:b,reviewedPullRequests:N,usersData:wt(b.concat(N),p),releases:z,issues:O,trimmedItems:{trimmedPRs:{trimmedLeftPrs:x,trimmedRightPrs:y},trimmedReviewedPRs:{trimmedLeftReviewedPrs:P,trimmedRightReviewedPrs:I},trimmedReleases:{trimmedLeftReleases:B,trimmedRightReleases:X},trimmedIssues:{trimmedLeftIssues:le,trimmedRightIssues:U}}})},Mn=()=>{D.setState(Wt),T.setState(Ht)},it=e=>D.setState({chartConfig:e}),En=(e={})=>T.setState({fetching:!0,error:{level:"",message:""},...e}),$n=e=>T.setState({fetching:!1,error:e}),On=e=>{const{token:t,sortDirection:s,amountOfData:a,excludeIds:o,events:r,reportType:l,enterpriseAPI:c}=e,u=js(r).map((d="")=>{const[g="",h=""]=d.split("=");return{name:g.trim(),date:h.trim()}});return{reportType:l,...l==="repo"&&{repo:e.repo,org:e.org},...l==="org"&&{org:e.org},...l==="user"&&{[e.userId]:{userId:e.userId,name:e.name}},...l==="team"&&{teamName:e.teamName,usersInfo:e.usersInfo,userIds:Object.keys(e.usersInfo)},sortDirection:s,amountOfData:a,token:t,excludeIds:js(o)||[],events:u,enterpriseAPI:c}},Wr=e=>{const{teamName:t="",userIds:s=[],repo:a="",org:o=""}=e;return t&&"team"||s.length===1&&"user"||!a&&o&&"org"||"repo"},Ps=e=>{const{usersData:t=[],fetches:{usersInfo:s={}},pullRequests:a=[],reviewedPullRequests:o=[]}=e,r=Tn(a),l={...e,fetching:!1,itemsDateRange:r,usersData:t.length?t:wt(a.concat(o),s)};l.fetches={},D.setState(()=>({...Wt,...l}));const c=Wr(e.fetches);T.setState(()=>({...Ht,...e.fetches,reportType:c}))},Yr=(e=[],t=[])=>s=>{const a=u=>{const m=u.dataKey;return["isBug","isFeature"].includes(m)?t.filter(({isBug:h=!1})=>h&&m==="isBug"||!h&&m==="isFeature"):e},{left:o=[],right:r=[]}=s,l={lines:o.map(u=>({...u,data:a(u)})),xAxis:"left"},c={lines:r.map(u=>({...u,data:a(u)})),xAxis:"right"};return[...o.length>0?[l]:[],...r.length>0?[c]:[]]},Qr=e=>{const t=[...(e==null?void 0:e.left)||[],...(e==null?void 0:e.right)||[]].map(a=>a.dataKey);return t.length>0?[...t,"author"]:["comments","approvals","age","prSize","author"]};let _r=1;const Jr=()=>++_r,Xr=(e=[])=>{const t=[];return e.forEach(({left:s=[],right:a=[]})=>{s.forEach(o=>(o==null?void 0:o.groupMath)&&t.push(o.groupMath)),a.forEach(o=>(o==null?void 0:o.groupMath)&&t.push(o.groupMath))}),t},Zr=(e=[])=>Xr(e).includes("trimmedAverage"),bt=({chunkyData:e=[],pullRequests:t=[],tableOpenedByDefault:s=!1})=>{const a=D(d=>d.issues),o=D(te(d=>d.releases)),r=D(d=>d.chartConfig),l=T(d=>d.usersInfo),c=T(d=>d.events),i=Ie({events:c,releases:o,usersInfo:l}),u=Zr(r),m=Yr(t,a);return t.length>0&&n.jsxs(J,{children:[n.jsxs(me,{title:"Your graphs",expandText:"guidance",children:[n.jsx("p",{children:"You can build multiple graphs with data you want to see to help you find insights and track trends."}),n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"What metrics do you want to look and and compare against?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"}),n.jsx("li",{children:"This graph initially had PR age and size as they are often impactful metrics, what do you think about the trends of these metrics?"})]})]}),n.jsxs(Ne,{children:[r.map((d,g)=>{var p,f;const h=m(d);return((p=d==null?void 0:d.left)==null?void 0:p.length)<1&&((f=d==null?void 0:d.right)==null?void 0:f.length)<1?n.jsx(rn,{graphInfo:d,setGraph:it,graphs:r},g):n.jsx(_,{graphInfo:d,setGraph:it,graphs:r,blockHeading:!0,markers:i,showLegends:!1,data:h,tableKeys:Qr(d),tableData:e,tableOpenedByDefault:g===0&&s},g)}),u&&n.jsx("p",{children:"*Trimmed average is the average after the top and bottom 5% is trimmed."})]}),n.jsxs("div",{className:"flex flex-nowrap basis-full justify-center gap-x-3 mb-08",children:[r.length>1&&n.jsx($,{variant:"secondary",onClick:d=>{d.preventDefault(),it(r.slice(0,-1))},children:"Remove above graph"}),n.jsx($,{onClick:d=>{d.preventDefault(),it([...r,{graphId:Jr(),left:[],right:[]}])},children:"Add another custom graph"})]})]})},Bn=(e,t)=>t.some(s=>e.some(a=>a[s])),gt=({data:e=[],bars:t=[],sortBy:s="",indexBy:a="user",max:o=20,title:r=""})=>{const{theme:l}=G(),c=ot(l),{showNumbers:i}=at(),u=Gs(p=>t.some(f=>p[f.dataKey]),e),m=p=>(f,v)=>+((f[p]||0)<(v[p]||0))||+((f[p]||0)===(v[p]||0))-1,d=s?u.sort(m(s)):u,g=o?d.slice(0,o):d,h=t.map(p=>p.dataKey);return Bn(e,h)&&n.jsxs("div",{className:"flex flex-col justify-between w-full max-w-mw mb-4",children:[n.jsx(Ue,{text:r,items:t}),n.jsx("div",{className:"chart-wrap",children:n.jsx(qa,{data:g,keys:h,indexBy:a,margin:{top:5,right:50,bottom:60,left:50},padding:.3,groupMode:"grouped",layout:"vertical",valueFormat:p=>`${p}`,colors:t.map(p=>p.color),axisBottom:{tickSize:0,tickRotation:-45},axisLeft:{...!i&&{renderTick:void 0},tickSize:0},isInteractive:i,enableLabel:!1,animate:!1,theme:c})})]})},el=(e,t,s=!1)=>{const a={},o={};e.forEach(d=>{const g=d.author,h=d[t]||{},p=It(Object.values(h));a[g]=p,o[g]=d.name||g});const r=Object.entries(a).sort(([,d],[,g])=>g-d),l=It(Object.values(a)),c=d=>{const g=100/l;return d*g},i=[];r.forEach(([d,g])=>{const h=c(g);g>0&&h>5&&i.push(d)});const u=i.length===e.length-1?r.map(([d])=>d):i,m=s?e.filter(d=>u.includes(d.author)).map(d=>d.author):u;return[m,m.map(d=>o[d]||d)]},tl=(e=[],t)=>{const s=Object.entries(t).filter(([o])=>!e.some(r=>r===o));return It(s.map(o=>o[1]))},sl=(e=[],t,s=[],a=!1)=>{const o=c=>[...s.map(i=>{var u;return((u=c==null?void 0:c[t])==null?void 0:u[i])||0}),...a?[tl(s,c[t])]:[]],r=s.map(c=>{const i=e.find(u=>u.author===c);return o(i)});let l=[];return e.forEach(c=>{if(!s.some(i=>i===c.author)){const u=o(c).map((m,d)=>m+(l[d]||0));l=[...u.slice(0,u.length-1),0]}}),[...r,...l.length?[l]:[]]},nl=({data:e,dataKey:t,preSorted:s,showNames:a=!0})=>{const[o,r]=el(e,t,s),l=r.length<e.length,c=sl(e,t,o,l),i=[...r,...l?["Others"]:[]];return{names:a?i:i.map((u,m)=>`Spartacus${Array(m).fill(" ").join("")}`),matrix:c}},pt=({title:e,data:t=[],preSorted:s=!1,dataKey:a})=>{const{theme:o}=G(),r=ot(o),{showNumbers:l}=at(),{showNames:c}=je(),{names:i,matrix:u}=nl({data:t,dataKey:a,preSorted:s,showNames:c});return(d=>d.some(g=>g.some(Boolean)))(u)&&n.jsxs("div",{children:[n.jsx(Ue,{text:e,className:"text-center"}),n.jsx("div",{className:"chord-wrap",children:n.jsx(Ua,{label:"id",data:u,keys:i,margin:{top:0,right:10,bottom:10,left:10},arcBorderColor:{from:"color",modifiers:[["darker",.4]]},ribbonOpacity:.5,ribbonBorderWidth:.5,ribbonBorderColor:{from:"color",modifiers:[["darker",.4]]},innerRadiusRatio:.85,labelRotation:0,padAngle:.06,innerRadiusOffset:.03,labelOffset:-23,labelTextColor:{from:"color",modifiers:[["darker",2]]},colors:E,isInteractive:l,activeArcOpacity:1,inactiveArcOpacity:1,activeRibbonOpacity:.75,inactiveRibbonOpacity:.25,animate:!1,motionConfig:"stiff",theme:r})})]})},Fn=({title:e="",data:t=[]})=>{const{theme:s}=G(),a=ot(s),{showNumbers:o}=at();return t.length&&n.jsxs("div",{className:"z-10 w-full max-w-mw",children:[n.jsx("div",{className:"flex flex-wrap justify-between",children:n.jsx(Ue,{type:"line",text:e})}),n.jsx("div",{className:"pie-wrap",children:n.jsx(Ga,{data:t,colors:{datum:"data.color"},margin:{top:15,right:80,bottom:0,left:80},animate:!1,innerRadius:.65,padAngle:1,cornerRadius:4,activeOuterRadiusOffset:5,borderWidth:1,startAngle:-90,endAngle:90,enableArcLabels:!1,arcLinkLabelsSkipAngle:4,arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLinkLabelsDiagonalLength:10,arcLinkLabelsStraightLength:15,arcLinkLabelsTextColor:a.textColor,theme:a,isInteractive:o})})]})},Yt=({pullRequests:e=[],chunkyData:t=[],allRepos:s={}})=>{var N,I;const a=D(S=>S.usersData),o=D(S=>S.releases),{userIds:r=[],usersInfo:l={},events:c=[]}=T(te(S=>S)),{theme:i}=G(),u=F[i].secondary,m=F[i].primary,{showNames:d}=je(),g=Ie({events:c,releases:o,usersInfo:l}),h=r.length||15,p=["commentsGiven","approvalsGiven"],f=a.sort(Pe(p)),v=f.map((S,B)=>{var z;return{commentsGiven:S.commentsGiven,commentsReceived:S.commentsReceived,uniquePRsApproved:S.uniquePRsApproved,totalPRs:S.totalPRs,author:d?S.author:`${Array(B).fill(" ").join("")}Spartacus`,name:d?((z=l[S.author])==null?void 0:z.name)||S.author:`${Array(B).fill(" ").join("")}Spartacus`}}),x=f.map(S=>{var B;return{...S,name:((B=l[S.author])==null?void 0:B.name)||S.author}}),b=fn("repo",s),y=pn({pullRequests:e,showNames:d,usersInfo:l}),w=x.filter(S=>S.approvalsGiven>0).length,P=x.filter(S=>S.commentsGiven>0).length;return a.length>0&&n.jsxs(J,{children:[n.jsxs(me,{title:"Contributions",expandText:"guidance*",children:[n.jsx("p",{children:"*Received comments can also come from out of team so can be higher."}),n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"Is there a bus factor risk?"}),n.jsx("li",{children:"Are there any data points that stand out?"}),n.jsx("li",{children:"How do the given and received metrics look?"}),n.jsx("li",{children:"How well spread are the collaboration metrics?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),n.jsxs(Ne,{children:[n.jsxs("div",{className:"grid grid-cols-2 w-full max-mm:grid-cols-1",children:[n.jsx(gt,{data:v,indexBy:"name",title:"Comments",sortBy:"commentsGiven",max:h,bars:[{dataKey:"commentsGiven",color:u,label:"given"},{dataKey:"commentsReceived",color:m,label:"*received"}]}),n.jsx(gt,{data:v,indexBy:"name",title:"PRs",sortBy:"uniquePRsApproved",max:h,bars:[{dataKey:"uniquePRsApproved",color:u,label:"approved"},{dataKey:"totalPRs",color:m,label:"opened"}]})]}),(P>0||w>0)&&n.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[P>0&&n.jsx(pt,{data:x,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),w>0&&n.jsx(pt,{data:x,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),n.jsx("p",{children:"These chord charts show how contributions are given and received, the dominant colour indicates more contribution"}),y.length>0&&((I=(N=y==null?void 0:y[0])==null?void 0:N.lines)==null?void 0:I.length)<21&&n.jsx(_,{title:"PRs by author",markers:g,showLegends:!0,data:y,tableData:t,tableKeys:["author","repo"]}),b.pieData.length>0&&n.jsx(Fn,{data:b.pieData,title:b.sectionTitle})]})]})},Ln=j.forwardRef(({className:e,...t},s)=>n.jsx(Hs,{className:C("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:s,children:n.jsx(za,{className:C("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ln.displayName=Hs.displayName;const al={warn:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),error:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})},Qt=({error:{level:e="error",message:t},className:s})=>{const a=e==="error"?"bg-error":"bg-warn";return n.jsxs("div",{className:`${a} p-3 flex items-center rounded-sm ${s}`,children:[e&&al[e],n.jsx("p",{className:"m-0 ml-2 p-0",children:t})]})},ol=(e,t)=>[e&&"fetching",t.length&&"Get more data","Get data"].find(Boolean),Vn=({qaId:e=""})=>{const t=D(o=>o.pullRequests),{fetching:s=!1,error:a}=T(o=>o);return n.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2",children:[n.jsx($,{className:"m-0 w-full col-span-full",type:"submit",disabled:s,color:"primary","data-qa-id":e,children:ol(s,t)}),(a==null?void 0:a.message)&&n.jsx(Qt,{error:a,className:"col-span-full"})]})},Kn=e=>{const{setValue:t,amountOfData:s,className:a=""}=e,o=D(i=>i.preFetchedName),r=D(i=>i.pullRequests),l=!o&&r.length>0,c=i=>`Get ${i} ${i===1?"month":"months"} ${l?"more ":""}data`;return n.jsxs(Fe,{onValueChange:i=>t("amountOfData",i==="all"?i:Number(i)),value:`${s}`,children:[n.jsx(Ae,{className:`w-auto ${a}`,children:n.jsx(Ve,{children:s==="all"?"Get it all!":c(Number(s))})}),n.jsx(Te,{children:n.jsxs(Le,{children:[n.jsx(ee,{value:"1",children:c(1)}),n.jsx(ee,{value:"3",children:c(3)}),n.jsx(ee,{value:"6",children:c(6)}),n.jsx(ee,{value:"12",children:c(12)}),n.jsx(ee,{value:"24",children:c(24)}),n.jsx(ee,{value:"all",children:"Get it all!"})]})})]})},qn=j.forwardRef(({className:e,type:t,...s},a)=>n.jsx("input",{type:t,"data-qa-id":`input-${t}`,className:C("flex mt-8 h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground  focus:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring  disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));qn.displayName="Input";const Un={org:"Organization",repo:"Repository",team:"Team name (from GitHub Org team url)",gitTeamUrl:"Org's team url",token:"Token",excludeIds:"Exclude GitHub users e.g. remove bot PRs and comments, ',' separated",enterpriseAPI:"Enterprise API full url",userIds:"Comma separated list GitHub users",userId:"GitHub user ID",startDate:"Joined yyyy/mm/dd",endDate:"Left yyyy/mm/dd",events:"Comma separated list of events (optional)",teamName:"Team name",name:"Name"},rl=({dates:e=[]})=>{const t=e.every(({startDate:r="",endDate:l=""})=>{const c=!r||Mt(new Date(r)),i=!l||Mt(new Date(l));return c&&i}),s=[];e.forEach(({startDate:r="",endDate:l=""})=>{r&&s.push(r),l&&s.push(l)});const a=Wa((r,l)=>new Date(r).getTime()-new Date(l).getTime(),s),o=ge(s,a);return t&&o},ll=(e={})=>{const t=Object.values(e).every(s=>rl(s));return Object.keys(e).length>0&&t},Rs=(e="")=>!e||/^\d{4}[/-]\d{2}[/-]\d{2}$/.test(e)&&Mt(new Date(e)),Gn=({key:e,value:t})=>de([[ge("gitTeamUrl"),R(/^(https:\/\/.+\..+$)/.test(t))],[ge("enterpriseAPI"),R(/^(https:\/\/.+\..+|^$)/.test(t))],[ge("excludeIds"),R(/^([\w-.,\s]+|)$/.test(t))],[ge("events"),R(/^([\w-.,&\s=]+|)$/.test(t))],[ge("name"),R(/.?/.test(t))],[ge("usersInfo"),()=>ll(t)],[ge("startDate"),()=>Rs(t)],[ge("endDate"),()=>Rs(t)],[K,R(/^[\w-_.]+$/.test(t))]])(e),cl=e=>t=>{const s=e[t];return!Gn({key:t,value:s})},zn=e=>{const t=cl(e),s={};return Object.keys(e).forEach(o=>{s[o]=t(o)}),{isValid:Object.values(s).every(o=>!o),validationErrors:s}},Ft=(e,t)=>{const s=e[t],a=typeof s=="object"?"":s;return Array.isArray(s)?Ha(", ",s):a},Q=e=>{const{type:t,className:s="",inputError:a={},setInputError:o=()=>{},formInfo:r={},setValue:l}=e,c=a[t]?"border-red-500":"";return n.jsxs(st,{children:[n.jsx("p",{className:"mb-1 block",children:Un[t]}),n.jsx(qn,{className:`${s} m-0 w-full ${c}`,value:Ft(r,t),type:t,onBlur:i=>{const u=k("",["target","value"],i),m=Gn({key:t,value:u});o({...a,[t]:!m}),m&&l(t,u)},onChange:i=>{const u=k("",["target","value"],i);o({...a,[t]:!1}),l(t,u)},onFocus:()=>o({...a,[t]:!1})}),n.jsx("p",{className:"text-red-500 text-xs",children:a[t]&&"Invalid input"})]})},Hn=Ys,il=Qs,Wn=Ws,_t=j.forwardRef(({className:e,...t},s)=>n.jsx(ft,{ref:s,className:C("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));_t.displayName=ft.displayName;const Yn=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Wn,{children:[n.jsx(_t,{}),n.jsxs(He,{ref:a,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,n.jsxs(Vt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[n.jsx("path",{d:"M18 6 6 18"}),n.jsx("path",{d:"m6 6 12 12"})]}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Yn.displayName=He.displayName;const Qn=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Wn,{children:[n.jsx(_t,{}),n.jsx(He,{ref:a,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:t})]}));Qn.displayName=He.displayName;const Ye=j.forwardRef(({className:e,...t},s)=>n.jsx(xt,{ref:s,className:C("text-lg font-semibold leading-none tracking-tight",e),...t}));Ye.displayName=xt.displayName;const dl=j.forwardRef(({className:e,...t},s)=>n.jsx(vt,{ref:s,className:C("text-sm text-muted-foreground",e),...t}));dl.displayName=vt.displayName;const ml=({onSubmit:e=()=>{},gitUsers:t=[],usersInfo:s={}})=>{const a=Object.entries(s).map(([x,{name:b="",dates:y=[]}])=>({userId:x,name:b,dates:y})),o=a.length>0?a:[{userId:"",name:"",dates:[]}],[r,l]=j.useState(o),c=x=>(b,y)=>{const w=[...r];w[x][b]=y,l(w)},i=(x,b)=>(y,w)=>{const P=[...r];P[x].dates[b][y]=w,l(P)},u=x=>{x.preventDefault();const b={};r.forEach(({userId:y,name:w,dates:P})=>{b[y]={userId:y,name:w,dates:P}}),e(b)},m=x=>{x.preventDefault(),l([...r,{userId:"",name:"",dates:[]}])},d=(x,b)=>{b.preventDefault();const y=[...r];y.splice(x,1),l(y)},g=(x,b)=>{b.preventDefault();const y=[...r],w={startDate:"",endDate:""};y[x].dates.push(w),l(y)},h=({userIndex:x,dateIndex:b})=>{const y=[...r],P=y[x].dates.filter((N,I)=>I!==b);y[x].dates=P,l(y)},[p,f]=j.useState({}),v=t.length>0&&"Edit Github Team members"||Object.keys(s).length>0&&"Edit team members"||"Or manually add team members";return n.jsxs("form",{children:[n.jsx("h4",{children:v}),r.map((x,b)=>n.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2 mb-8",children:[n.jsx(Q,{type:"userId",formInfo:x,inputError:p,setInputError:f,setValue:c(b)}),n.jsx(Q,{type:"name",formInfo:x,setValue:c(b),inputError:p,setInputError:f}),x.dates.map((y,w)=>n.jsxs("div",{className:"flex items-stretch gap-2 justify-between col-span-full",children:[n.jsx(Q,{type:"startDate",formInfo:y,inputError:p,setInputError:f,setValue:i(b,w)}),n.jsx(Q,{type:"endDate",inputError:p,formInfo:y,setInputError:f,setValue:i(b,w)}),n.jsx("svg",{onClick:()=>h({userIndex:b,dateIndex:w}),className:"w-6 fill-current min-h-12 rounded-sm bg-destructive test-[#CCC] px-0 py-2 h-auto",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"DeleteIcon",children:n.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})})]},w)),n.jsx($,{className:"min-h-12 m-0",color:"primary",onClick:y=>g(b,y),children:`Add ${x.dates.length>0?"more dates":"dates"}`}),n.jsx($,{className:"bg-destructive text=[#CCC] min-h-12 m-0",onClick:y=>d(b,y),children:"Remove User"})]},b)),n.jsx($,{className:"mr-0 w-full min-h-12",color:"primary",onClick:x=>m(x),children:"Create new user"}),n.jsx($,{className:"mr-0 w-full min-h-12",color:"primary",onClick:x=>u(x),children:"Save and close"})]})},ul=async({fetchInfo:e,setGitUsers:t,setInputError:s})=>{try{const{results:a=[]}=await xe({fetchInfo:e,queryInfo:ir}),o=[];a.flat().forEach(({node:r})=>{const{name:l,email:c,login:i}=r,u=l?l.replace(",",""):c.split(".")[0];o.push({userId:i,name:u})}),t(o)}catch(a){const o=a;s({level:"error",message:`Api call error: ${(o==null?void 0:o.message)||"unknown"}`})}},hl=e=>{var u;const{setGitUsers:t}=e,[s,a]=j.useState({}),o={gitTeamUrl:"",token:""},[r,l]=j.useState(o),i={inputError:s,setInputError:a,formInfo:r,setValue:(m,d)=>l({...r,[m]:d})};return n.jsxs("form",{onSubmit:m=>{m.preventDefault();const{gitTeamUrl:d="",token:g=""}=r,h=d.split("/"),p=h.at(-2)||"",f=h.at(-2)||"";[p,f,g].every(x=>x&&x.length>0)?ul({fetchInfo:{name:p,org:f,token:g},setGitUsers:t,setInputError:a}):a({level:"error",message:"Invalid inputs"})},children:[n.jsx("h4",{children:"Getting team members from a GitHub Org team page"}),n.jsx(Q,{type:"gitTeamUrl",...i},"gitTeamUrl"),n.jsx(Q,{type:"token",...i}),n.jsx($,{className:"w-full mr-0 min-h-12",type:"submit",children:"Get team members"}),((u=s==null?void 0:s.message)==null?void 0:u.length)>0&&n.jsx(Qt,{error:s})]})},_n=({setParentValues:e,usersInfo:t={}})=>{const[s,a]=j.useState(!1),[o,r]=j.useState([]),l=o.length>0&&"Edit Github Team members"||Object.keys(t).length>0&&"Edit team members"||"Fill in team by:";return n.jsxs("div",{children:[n.jsxs("p",{className:"mb-1",children:["Team members: ",Object.values(t).map(({name:c,userId:i})=>c||i).join(", ")||"None"]}),n.jsxs(Hn,{open:s,onOpenChange:a,children:[n.jsx(il,{asChild:!0,children:n.jsx($,{className:"w-full",type:"button",children:Object.keys(t).length===0?"Add team members":"Edit team members"})}),n.jsxs(Yn,{className:"overflow-scroll max-h-full w-4/5",children:[n.jsx(Ye,{children:l}),Object.keys(t).length===0&&n.jsx(hl,{setGitUsers:r}),n.jsx(ml,{gitUsers:o,usersInfo:t,onSubmit:c=>{const i=Object.keys(c).filter(Boolean).length>0;e(i?{usersInfo:c}:{usersInfo:{}}),a(!1)}})]})]})]})},Jn=()=>{const e=D(a=>a.pullRequests),t=T(a=>a.fetching),s=zr();return!t&&e.length>0?n.jsx("p",{children:n.jsx("a",{className:"text-primary",...s,children:"Download report data"})}):null},gl=()=>{var le;const e=T(O=>O),{repo:t="",org:s="",fetching:a=!1,excludeIds:o=[],events:r=[],usersInfo:l={},token:c="",amountOfData:i="all",enterpriseAPI:u="",reportType:m,teamName:d=""}=e,g="ASC",h=r.map(({name:O,date:U})=>`${O}=${U}`).join(", "),p=o.join(", "),f={repo:{reportType:"repo",org:s,repo:t},org:{reportType:"org",org:s},team:{reportType:"team",usersInfo:l,teamName:d},user:{reportType:"user",userId:Object.keys(l)[0],name:((le=Object.values(l)[0])==null?void 0:le.name)||""}},[v,x]=j.useState({sortDirection:g,amountOfData:i,token:c,excludeIds:p,enterpriseAPI:u,events:h,...f[m]}),[b,y]=j.useState({}),[w,P]=j.useState(!1),N=(O,U)=>x({...v,[O]:U}),I=(O={})=>{const U={...v,...O};x(U)},S={inputError:b,setInputError:y,formInfo:v,setValue:N},B=O=>{O.preventDefault();const{isValid:U,validationErrors:se}=zn(v);if(y(se),U&&!a){const H=On(v);kn({...e,...H}),P(!0)}},Y=[...{repo:["org","repo"],org:["org"],team:["teamName"],user:["userId","name"]}[m],"enterpriseAPI"];return n.jsx(me,{className:"mb-0 col-span-full",title:"",expandText:"here",intro:"Top up this report's data",expandQaId:"expand-prefetch-form",children:n.jsxs("div",{className:"mb-3",children:[n.jsxs("form",{onSubmit:B,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end mb-4",children:[n.jsxs("div",{className:"col-span-full",children:[Y.filter(O=>Ft(e,O)).map(O=>n.jsxs("p",{children:[Un[O],": ",n.jsx("b",{children:Ft(e,O)})]},O)),m==="team"&&n.jsx(_n,{usersInfo:l,setParentValues:I})]}),n.jsx(Q,{type:"events",className:"col-span-full",...S}),n.jsx("p",{className:"col-span-full",children:"Key events can impact the data e.g. starting or launching a new feature or major version. These events can help give more context while viewing the data. e.g. ProjectA=2013-12-01."}),n.jsx(Q,{type:"excludeIds",...S}),n.jsx(Q,{type:"token",...S}),n.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",n.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]}),n.jsxs(Fe,{onValueChange:O=>N("sortDirection",O),value:v.sortDirection,children:[n.jsx(Ae,{className:"w-auto",children:n.jsx(Ve,{children:v.sortDirection==="DESC"?"Prepend data":"Append data"})}),n.jsx(Te,{children:n.jsxs(Le,{children:[n.jsx(ee,{value:"DESC",children:"Prepend data"}),n.jsx(ee,{value:"ASC",children:"Append data"})]})})]}),n.jsx(Kn,{setValue:N,amountOfData:v.amountOfData})]}),n.jsx(Vn,{qaId:"prefetch-top-up"})]}),w&&n.jsx(Jn,{})]})})},pl=()=>{const e=D(l=>l.pullRequests),t=D(l=>l.issues),s=T(l=>l.usersInfo),a=Object.keys(s).length,o=a>1?`by ${a} contributors`:"",r=t.length>0?`and ${t.length} issues`:"";return e.length>0&&n.jsx(n.Fragment,{children:n.jsxs("p",{className:"w-full",children:[n.jsxs("b",{children:["Showing ",e.length," PRs ",o," ",r]}),". Drag the points to change the date range of the report."]})})},Xn=j.forwardRef(({className:e,...t},s)=>n.jsxs(_s,{ref:s,className:C("relative flex w-full touch-none select-none items-center",e),...t,children:[n.jsx(Ya,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:n.jsx(Qa,{className:"absolute h-full bg-primary"})}),n.jsx(os,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}),n.jsx(os,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Xn.displayName=_s.displayName;let Ce=[];const Ct=({startDate:e,endDate:t,left:s,right:a})=>{const o=pe(new Date(t),new Date(e)),r=o/100,l=Math.floor(r*s),c=Math.ceil(r*a),i=e?rs(kt(new Date(e),{days:l}),{representation:"date"}):"",u=t?rs(Tt(new Date(t),{days:o-c}),{representation:"date"}):"";return[i,u]},fl=()=>{const e=D(te(d=>d.itemsDateRange)),[t,s]=e,[[a,o],r]=j.useState([0,100]),[l,c]=Ct({startDate:t,endDate:s,left:a,right:o}),i=d=>{Ce=d,Array.isArray(d)&&d.length===2&&r(d)},u=d=>{const[g,h]=Ce.length?Ce:d,[p,f]=Ct({startDate:t,endDate:s,left:g,right:h});Ce=[],Ns(p,f)},m=()=>{if(!Ce.length)return;const[d,g]=Ce,[h,p]=Ct({startDate:t,endDate:s,left:d,right:g});Ce=[],Ns(h,p)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"w-full flex justify-between",children:[n.jsx("p",{className:"text-2xl mb-1",children:At(new Date(l),"do MMM yy")}),n.jsx("p",{className:"text-2xl mb-1",children:At(new Date(c),"do MMM yy")})]}),n.jsx(Xn,{value:[a,o],onValueChange:i,onValueCommit:u,className:"pb-08",onLostPointerCapture:m})]})},xl=e=>{const{repo:t="",org:s="",teamName:a="",usersInfo:o={},userIds:r=[],colorA:l="",colorB:c=""}=e,{userId:i="",name:u=""}=o[r[0]]||{},m=s||a||u||i,d=!a&&u&&i||t&&s!==t&&t||"",g=d?l:c;return n.jsxs(n.Fragment,{children:[n.jsx("span",{style:{color:g},children:m}),d&&n.jsxs(n.Fragment,{children:["/",n.jsx("span",{style:{color:c},children:d})]})]})},jt=()=>{const e=D(te(f=>f.preFetchedName)),t=D(te(f=>f.reportDescription)),s=D(f=>f.pullRequests),a=D(f=>f.issues),{repo:o,org:r,teamName:l,usersInfo:c,userIds:i=[]}=T(te(f=>f)),{theme:u}=G(),m=F[u].secondary,d=F[u].primary,{showNames:g,toggleShowNames:h}=je();return(s.length>0||a.length>0)&&n.jsxs(J,{children:[n.jsx("h2",{"data-qa-id":"report-title",className:"truncate",children:n.jsx(xl,{repo:o,org:r,teamName:l,usersInfo:c,userIds:i,colorA:m,colorB:d})}),t&&n.jsx("p",{children:t}),i&&i.length>1&&n.jsxs("p",{children:["Team's GitHub IDs: ",i.join(", ")]}),n.jsxs("div",{className:"flex items-center space-x-2 pb-08",children:[n.jsx(Ln,{id:"spartacus-mode",onCheckedChange:h,checked:!g,name:"checkedA",className:"dark:data-[state=unchecked]:bg-white"}),n.jsx(st,{htmlFor:"spartacus-mode",children:g?"Who is Spartacus?":"Spartacus mode can help look for trends."})]}),n.jsx(pl,{}),n.jsx(fl,{}),e.length>0&&n.jsx(gl,{})]})},Zn=({chunkyData:e=[],pullRequests:t=[]})=>{const s=D(te(p=>p.releases)),a=T(p=>p.userIds),o=T(p=>p.usersInfo),r=T(p=>p.events),{theme:l}=G(),c=F[l].secondary,i=F[l].primary,u=F[l].tertiary,{showNames:m}=je(),d=a.length>0,g=d?pn({pullRequests:t,showNames:m,usersInfo:o}):[],h=Ie({events:r,releases:s,usersInfo:o});return t.length>0&&n.jsxs(J,{children:[n.jsx(me,{title:"Pull Request trends",children:s.length>1&&n.jsx("div",{children:n.jsx("p",{children:"Vertical lines are releases: Green is a Major release, solid purple is Minor and dotted purple is Patch or Alpha"})})}),n.jsxs(Ne,{children:[d&&n.jsx(n.Fragment,{children:n.jsx(_,{title:"PRs by author",markers:h,showLegends:!0,data:g,tableData:e,tableKeys:["author","repo"]})}),n.jsx(_,{markers:h,data:[{lines:[{label:"PRs over time",color:c,dataKey:"url",groupMath:"count",data:t}],xAxis:"left"}],tableData:e,tableKeys:["author"]}),n.jsx(_,{markers:h,data:[{lines:[{label:"Comments",color:c,dataKey:"comments",data:t},{label:"Approvals",color:i,dataKey:"approvals",data:t}],xAxis:"left"},{lines:[{label:"PR Size",color:u,dataKey:"prSize",data:t}],xAxis:"right"}],tableData:e,tableKeys:["comments","approvals","prSize","author"]}),n.jsx(_,{markers:h,data:[{lines:[{label:"Age (days)",color:i,dataKey:"age",data:t}],xAxis:"left"},{lines:[{label:"PR Size",color:u,dataKey:"prSize",data:t}],xAxis:"right"}],tableData:e,tableKeys:["age","prSize","author"]})]})]})},vl=()=>{const e=D(a=>a.pullRequests),t={};e.forEach(a=>{t[a.repo]=(t[a.repo]||0)+1});const s=ke(e);return n.jsxs(n.Fragment,{children:[n.jsx(jt,{}),n.jsx(Yt,{pullRequests:e,chunkyData:s,allRepos:t}),n.jsx(bt,{pullRequests:e,chunkyData:s,tableOpenedByDefault:!0}),n.jsx(Zn,{pullRequests:e,chunkyData:s})]})},yl=(e=[])=>e.map(t=>({mergedAt:t.mergedAt,...t.isBug?{bug:1}:{issue:1}})),Jt=()=>{const e=D(te(g=>g.releases)),t=D(g=>g.issues),s=T(g=>g.usersInfo),a=T(g=>g.events),{theme:o}=G(),r=F[o].secondary,l=F[o].primary,c=yl(t),i=ke(t),u=Ie({events:a,releases:e,usersInfo:s}),m=[],d=[];return c.forEach(g=>{g.issue&&m.push(g),g.bug&&d.push(g)}),c&&c.length>0&&n.jsxs(J,{children:[n.jsx(me,{title:"Feature and bug trends"}),n.jsx(Ne,{children:n.jsx(_,{markers:u,data:[{lines:[{label:"Issues",color:r,dataKey:"issue",groupMath:"count",data:m},{label:"Bugs*",color:l,dataKey:"bug",groupMath:"count",data:d}],xAxis:"left"}],tableKeys:["isBug"],tableData:i})}),n.jsx("p",{className:"w-full text-center",children:"*Bugs in this graph are issues that have a title or a label that contains the word 'bug'"})]})},wl=({chunkyData:e=[],pullRequests:t=[]})=>{const s=D(te(te(m=>m.releases))),{userIds:a=[],usersInfo:o={},events:r=[]}=T(te(m=>m)),{showNames:l}=je(),c=Ie({events:r,releases:s,usersInfo:o}),i={};t.forEach(m=>{const d=m.author;i[d]||(i[d]=[]),i[d].push(m)});const u=a.map((m,d)=>{const g=l?m:`Spartacus${Array(d).fill(" ").join("")}`;return[{label:`To ${g}`,color:E[d%E.length],dataKey:"commentSentimentScore",data:i[m]},{label:`From ${g}`,color:E[d%E.length],dataKey:"commentAuthorSentimentScore",data:i[m]}]}).flat();return t.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{children:[n.jsx(me,{title:"Sentiment analysis*",children:n.jsxs("div",{children:[n.jsx("p",{children:"*Adding this is an experiment to see if it can provide useful insights."}),n.jsxs("p",{children:["Uses npm package ",n.jsx("a",{className:"text-primary",href:"https://github.com/thisandagain/sentiment",children:"sentiment"})," which uses AFINN-165 word list and Emoji ranking to perform sentiment analysis."]})]})}),n.jsxs(Ne,{children:[n.jsx(_,{markers:c,showLegends:!0,title:"Sentiment in PRs between team and reviewers",data:[{lines:[{label:"To team",color:E[0],dataKey:"commentSentimentScore",data:t},{label:"From team",color:E[2],dataKey:"commentAuthorSentimentScore",data:t}],xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e}),a.length>0&&n.jsx(n.Fragment,{children:n.jsx(_,{showLegends:!0,title:"Sentiment in PRs between authors and reviewers",data:[{lines:u,xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e})})]})]})})},bl=e=>({index:t,data:s})=>{const a=e.find(r=>r.area===t),o=s.map(({id:r,color:l})=>[n.jsx(Ja,{color:l},r),r,a[`${r}Original`]]);return n.jsx(Fs,{title:n.jsx("strong",{children:t}),rows:o})},jl=({title:e="",showTitle:t=!0,data:s=[],keys:a=[],colors:o=[],width:r=410,height:l=300})=>{const{theme:c}=G(),i=ot(c),u=F[c].secondary,m=F[c].primary,d=o.length>0?o:[u,m],{showNumbers:g}=at();return Bn(s,a)&&n.jsxs("div",{children:[t&&n.jsx(Ue,{className:"text-center",items:[{label:e,color:m}]}),n.jsx(_a,{width:r,height:l,margin:{top:0,bottom:0,right:100,left:100},dotSize:8,dotBorderColor:i.dotColor,dotBorderWidth:2,colors:d,gridShape:"linear",enableDotLabel:!1,gridLabelOffset:10,gridLevels:3,animate:!1,indexBy:"area",keys:a,data:s,maxValue:100,theme:i,sliceTooltip:bl(s),isInteractive:g})]})},Nl=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0},a=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],r=e.filter(g=>a.some(f=>g[f]>1)).sort(Pe(a)),l=Math.ceil(r.length/100*10),c=l>10?r.slice(0,l):r,i={};c.filter(g=>!0).forEach(g=>{Object.entries(g).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,p])=>{const f=i[h]||0;i[h]=+p+f})});const u=c.length,m={...s,user:"Peers",userCount:u};Object.entries(i).forEach(([g,h])=>{m[g]=Math.round(h/u)}),e.find(g=>g.author===t);const d=s;return e.forEach(g=>{Object.entries(g).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,p])=>{const f=d[h]||0,v=+p;d[h]=f>v?f:v})}),{averagedData:m,maxValues:d,users:e,user:{}}},Pl=({maxValues:e={},users:t=[]},s)=>{const a=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],o=s?t:t.sort(Pe(a)).slice(0,6),r=[{area:"Comments received",dataKey:"commentsReceived"},{area:"Comments given",dataKey:"commentsGiven"},{area:"Approved PRs",dataKey:"uniquePRsApproved"},{area:"PR count",dataKey:"totalPRs"},{area:"PR size",dataKey:"prSize"}];return o.map(c=>{const i=r.map(({area:u,dataKey:m})=>{const d=c[m]||0,g=e[m]||0;return{area:u,value:d&&g?d/g*100:0,valueOriginal:d}});return{title:c.author,data:i,keys:["value"]}})},ea=()=>{const e=D(h=>h.usersData),{userIds:t=[],usersInfo:s={}}=T(te(h=>h)),{theme:a}=G(),{togglePvPPage:o,setUserPage:r}=We(),l=F[a].secondary,c=F[a].primary,{showNames:i}=je(),u=Nl(e),m=Pl(u,t.length>0),d=t.length>0,g=d?"Team members":"Top contributors";return m.length>0&&n.jsxs(J,{className:"flex flex-wrap flex-row justify-center",children:[n.jsx(me,{title:g}),m.map((h,p)=>{var x;const f=h.title,v=((x=s[f])==null?void 0:x.name)||f;return n.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[n.jsx(jl,{showTitle:!1,height:240,colors:[(p+1)%2===0?l:c],...h}),n.jsx($,{variant:(p+1)%2===0?"secondary":void 0,onClick:b=>{b.preventDefault(),r(f),window&&window.scrollTo(0,0)},children:i?v:"Spartacus"})]},p)}),d&&n.jsx($,{className:"w-full mb-4",color:"primary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"PvP arena"})]})},Rl=()=>{const e=D(o=>o.usersData),{showNames:t}=je(),{togglePvPPage:s,setUserPage:a}=We();return e.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{className:"justify-between",children:[n.jsx($,{className:"w-full mb-4",color:"primary",onClick:o=>{o.preventDefault(),s(),window&&window.scrollTo(0,0)},children:"PvP arena"}),n.jsx("h3",{className:"w-full",children:"User pages"}),n.jsx("div",{className:"flex flex-wrap justify-between gap-2",children:e.map(({author:o,user:r},l)=>n.jsx($,{className:"flex-grow",variant:"secondary",onClick:c=>{c.preventDefault(),a(r),window&&window.scrollTo(0,0)},children:t?o:"Spartacus"},`${l}`))})]})})},Dl=()=>{const e=D(s=>s.pullRequests),t=ke(e);return n.jsxs(n.Fragment,{children:[n.jsx(jt,{}),n.jsx(Yt,{pullRequests:e,chunkyData:t}),n.jsx(bt,{pullRequests:e,chunkyData:t,tableOpenedByDefault:!0}),n.jsx(wl,{pullRequests:e,chunkyData:t}),n.jsx(Zn,{pullRequests:e,chunkyData:t}),n.jsx(Jt,{}),n.jsx(ea,{}),n.jsx(Rl,{})]})},Ds=({player:e="",className:t="",otherPlayer:s,setPlayerId:a,players:o=[]})=>n.jsxs(Fe,{value:e,onValueChange:r=>a(r),children:[n.jsx(Ae,{className:`text-3xl w-auto ${t}`,children:n.jsx(Ve,{children:e})}),n.jsx(Te,{children:n.jsx(Le,{children:o.filter(({author:r})=>r!==s).map(({author:r,name:l})=>n.jsx(ee,{value:r,children:l},r))})})]}),ta=({player1:e,player2:t,setPlayer1Id:s=()=>({}),setPlayer2Id:a=()=>({}),players:o=[]})=>{const{theme:r}=G(),l=F[r].secondary,c=F[r].primary,u=[{title:"Total Merged",id:"totalPRs"},{title:"Total approved",id:"uniquePRsApproved"},{title:"Comments given",id:"commentsGiven"},{title:"Comments received",id:"commentsReceived"},{title:"Average positive sentiment",id:"sentimentAveragePositiveScore"},{title:"Average negative sentiment",id:"sentimentAverageNegativeScore"},{title:"Average size",id:"prSize"},{title:"Total additions",id:"prTotalAdditions"},{title:"Total deletions",id:"prTotalDeletions"},{title:"Average days open",id:"age"},{title:"Orgs contributed to",id:"orgCount"},{title:"Repos contributed to",id:"repoCount"}].filter(({id:m})=>Number.isInteger(e[m])&&Number.isInteger(t[m])&&(!["orgCount","repoCount"].includes(m)||["orgCount","repoCount"].includes(m)&&e[m]!==1&&t[m]!==1)).map(m=>{const d=m.id,g=e[d],h=t[d],p=l,f=c,v=Math.ceil(100*g/(g+h)),x=100-v;return{...m,lValue:g,lColor:p,lPercent:v,rValue:h,rColor:f,rPercent:x}});return n.jsxs("div",{className:"w-full flex flex-col items-center basis-full",children:[n.jsx("div",{className:"w-full flex flex-nowrap justify-between mb-4 max-w-mw",children:o.length>0?n.jsxs(n.Fragment,{children:[n.jsx(Ds,{player:e.author,className:"text-secondary",otherPlayer:t.author,setPlayerId:s,players:o}),n.jsx(Ds,{player:t.author,className:"text-primary",otherPlayer:e.author,setPlayerId:a,players:o})]}):n.jsxs(n.Fragment,{children:[n.jsx("h3",{style:{color:l,margin:0},children:e.name}),n.jsx("h3",{style:{color:c,margin:0},children:t.name})]})}),u.map((m,d)=>n.jsxs("div",{className:"w-full relative max-w-mw mb-2",children:[n.jsx("p",{className:"z-[1] absolute w-full top-2 text-center m-0",children:m.title}),n.jsxs("div",{className:"w-full flex flex-nowrap content-stretch justify-between",children:[n.jsx("div",{className:"relative h-9",style:{width:`${m.lPercent}%`,backgroundColor:`${m.lColor}`},children:n.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 left-2 text-left m-0",children:m.lValue})}),n.jsx("div",{className:"relative h-9",style:{width:`${m.rPercent}%`,backgroundColor:`${m.rColor}`},children:n.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 right-2 text-right m-0",children:m.rValue})})]},m.id)]},`${m.id}${d}`))]})},Sl=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,prTotalAdditions:0,prTotalDeletions:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0,sentimentAveragePositiveScore:0,sentimentAverageNegativeScore:0,orgCount:0,repoCount:0},a=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"],r=e.filter(h=>{const p=h.author!==t,f=a.some(v=>h[v]>1);return p&&f}).sort(Pe(a)),l=Math.ceil(r.length/100*10),c=l>10?r.slice(0,l):r,i={};c.filter(h=>h.author!==t).forEach(h=>{Object.entries(h).filter(([,p])=>!Array.isArray(p)&&/^\d+$/.test(p)&&p>0).forEach(([p,f])=>{const v=i[p]||0;i[p]=+f+v})});const u=c.length,m={...s};Object.entries(i).forEach(([h,p])=>{m[h]=Math.round(p/u)});const d={...m,user:"Peers",name:"Peers"},g=e.find(h=>h.author===t)||{approvalsGivenByTeam:{}};return[{...g,user:g.author,name:g.name||g.author},d,u]},Cl=(e=[],t=[],s,a,o)=>{const r=[],l=[];e.forEach(i=>{const{author:u}=i;u===s?l.push(i):r.push(i)});const c=ke(l);return[{markers:t,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${s} received`,color:E[2],dataKey:"commentSentimentScore",data:l},{label:`${s} given`,color:E[1],dataKey:"commentAuthorSentimentScore",data:l},{label:"Peer received",color:E[4],dataKey:"commentSentimentScore",data:r},{label:"Peer given",color:E[5],dataKey:"commentAuthorSentimentScore",data:r}],xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore"],tableData:c},{markers:t,data:[{lines:[{label:"User PR size",color:a,dataKey:"prSize",data:l},{label:"Peer PR size",color:o,dataKey:"prSize",data:r}],xAxis:"left"}],tableKeys:["prSize"],tableData:c},{markers:t,data:[{lines:[{label:"User PR age",color:a,dataKey:"age",data:l},{label:"Peer PR age",color:o,dataKey:"age",data:r}],xAxis:"left"}],tableKeys:["age"],tableData:c}]},Al=()=>{const e=D(h=>h.pullRequests),t=D(h=>h.releases),s=D(h=>h.usersData),{userPage:a,clearUserPage:o}=We(),{theme:r}=G(),l=F[r].secondary,c=F[r].primary,i=Cl(e,t,a,l,c),[u,m,d]=Sl(s,a),g=u.name||a;return n.jsxs(J,{children:[n.jsx($,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"Back to main view"}),n.jsxs("p",{className:"w-full text-center",children:["A collection metrics showing ",g,"'s data and average data from the top ",d," peers"]}),n.jsx(ta,{player1:u,player2:m}),i.length&&i.map((h,p)=>n.jsx(_,{...h},`${p}-${a}`)),n.jsx($,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})},Tl=k("",["location","search"],window),sa=new URLSearchParams(Tl),kl=(e=[])=>{var t;return sa.get("player1")||((t=e[0])==null?void 0:t.author)},Il=(e=[])=>{var t;return sa.get("player2")||((t=e[1])==null?void 0:t.author)},Ml=()=>{const e=D(w=>w.pullRequests),t=D(w=>w.releases),s=D(w=>w.usersData),{events:a=[],usersInfo:o={}}=T(w=>w),{togglePvPPage:r}=We(),{theme:l}=G(),c=F[l].secondary,i=F[l].primary,[u,m]=j.useState(kl(s)),[d,g]=j.useState(Il(s)),h=s.find(w=>w.author===u),p=s.find(w=>w.author===d),f=[],v=[],x=[];e.forEach(w=>{const P=w.author;P===u?(f.push(w),x.push(w)):P===d&&(v.push(w),x.push(w))});const b=ke(x),y=Ie({events:a,releases:t,usersInfo:o});return s.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{children:[n.jsx($,{className:"w-full mr-0 mb-4",color:"secondary",onClick:w=>{w.preventDefault(),r()},children:"Back to main view"}),n.jsx("p",{className:"w-full text-center",children:"This page is just for fun, a bigger or smaller number could be good, bad or not mean much, it depends on context."}),n.jsx(ta,{player1:h,player2:p,setPlayer1Id:m,setPlayer2Id:g,players:s}),n.jsx("p",{className:"w-full text-center",children:"And the winner is.... Both! Thanks for your great work!"}),n.jsxs(Ne,{children:[n.jsx(_,{markers:y,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${h.name} received`,color:E[0],dataKey:"commentSentimentScore",data:f},{label:`${h.name} given`,color:E[2],dataKey:"commentAuthorSentimentScore",data:f},{label:`${p.name} received`,color:E[0],dataKey:"commentSentimentScore",data:v},{label:`${p.name} given`,color:E[2],dataKey:"commentAuthorSentimentScore",data:v}],xAxis:"left"}],tableData:b,tableKeys:["author","commentSentimentScore","commentAuthorSentimentScore"]}),n.jsx(_,{markers:y,data:[{lines:[{label:`${h.name} PR size`,color:c,dataKey:"prSize",data:f},{label:`${p.name} PR size`,color:i,dataKey:"prSize",data:v}],xAxis:"left"}],tableKeys:["author","prSize"],tableData:b}),n.jsx(_,{markers:y,data:[{lines:[{label:`${h.name} PR age`,color:c,dataKey:"age",data:f},{label:`${p.name} PR age`,color:i,dataKey:"age",data:v}],xAxis:"left"}],tableKeys:["author","age"],tableData:b})]}),n.jsx($,{className:"w-full mr-0 mb-4",color:"secondary",onClick:w=>{w.preventDefault(),r(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})})},El=({pullRequests:e=[]})=>{const{events:t=[],usersInfo:s={}}=T(i=>i),a=D(i=>i.releases),{theme:o}=G(),r=F[o].secondary,l=F[o].primary,c=Ie({events:t,releases:a,usersInfo:s});return e.length>0&&n.jsxs(J,{children:[n.jsxs(me,{title:"Team's contribution spread",expandText:"guidance",children:[n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"Is there a healthy percentage spread?"}),n.jsx("li",{children:"Are the Approval and comments spreads similar?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),n.jsx("p",{children:"Y axis is the percentage spread of approvals and comments within the active team*, 100% is an EVEN spread across the team, 0% is contribution from only ONE engineer."}),n.jsx(Ne,{children:n.jsx(_,{title:"Percentage spread within team for ",combineTitles:!0,markers:c,data:[{lines:[{label:"Comments given",color:r,dataKey:"comments",groupMath:"teamDistribution",yMax:100,data:e},{label:"Approvals given",color:l,dataKey:"approvals",groupMath:"teamDistribution",yMax:100,data:e}],xAxis:"left"}]})}),n.jsx("p",{children:"*Active team per data point are those who have approved, commented or raised a PR within that time frame."})]})},$l=()=>{const e=D(l=>l.pullRequests),t=T(l=>l.userIds),s=l=>{const c={};return t.forEach(i=>{const u=l==null?void 0:l[i];u&&(c[i]=u)}),c},a={},o=e.map(l=>(a[l.repo]=(a[l.repo]||0)+1,Object.assign(l,{teamApprovers:s(l.approvers),teamCommenters:s(l.commenters)}))),r=ke(o);return n.jsxs(n.Fragment,{children:[n.jsx(jt,{}),n.jsx(El,{pullRequests:o}),n.jsx(bt,{pullRequests:o,chunkyData:r,tableOpenedByDefault:!0}),n.jsx(Yt,{pullRequests:o,chunkyData:r,allRepos:a}),n.jsx(Jt,{}),n.jsx(ea,{})]})},Ol=()=>{const{usersInfo:e={},userIds:t=[]}=T(y=>y),s=D(y=>y.pullRequests),a=D(y=>y.reviewedPullRequests),[o]=t,{showNames:r}=je(),{theme:l}=G(),c=F[l].secondary,i=F[l].primary,u={},m={},d={};s.forEach(y=>{const w=y.commenters||{};Object.keys(w).forEach(N=>{const I=w[N]||0;d[N]||(d[N]={}),d[N].commentsReceived=(d[N].commentsReceived||0)+I});const P=y.approvers||{};Object.keys(P).forEach(N=>{const I=P[N]||0;d[N]||(d[N]={}),d[N].approvalsReceived=(d[N].approvalsReceived||0)+I}),u[y.repo]=(u[y.repo]||0)+1,m[y.org]=(m[y.org]||0)+1});const g={...e};a.map(y=>{var I,S;const w=y.author;g[w]={userId:w};const P=((I=y==null?void 0:y.commenters)==null?void 0:I[o])||0,N=((S=y==null?void 0:y.approvers)==null?void 0:S[o])||0;d[w]||(d[w]={}),d[w].commentsGiven=(d[w].commentsGiven||0)+P,d[w].approvalsGiven=(d[w].approvalsGiven||0)+N});const h=Object.entries(d).map(([y,w],P)=>{var N;return{...w,author:r?y:`${Array(P).fill(" ").join("")}Spartacus`,name:r?((N=e[y])==null?void 0:N.name)||y:`${Array(P).fill(" ").join("")}Spartacus`}}),p=wt(s.concat(a),g,o),f=["commentsGiven","approvalsGiven"],v=p.sort(Pe(f)),x=ke(s),b=fn("repo",u);return n.jsxs(n.Fragment,{children:[n.jsx(jt,{}),n.jsx(J,{children:n.jsxs(Ne,{children:[n.jsxs("div",{className:"flex flex-wrap justify-center w-full",children:[n.jsx(gt,{data:h,indexBy:"name",title:"Comments",sortBy:"commentsGiven",bars:[{dataKey:"commentsGiven",color:c,label:"given"},{dataKey:"commentsReceived",color:i,label:"received"}]}),n.jsx(gt,{data:h,indexBy:"name",title:"Approvals",sortBy:"approvalsGiven",bars:[{dataKey:"approvalsGiven",color:c,label:"given"},{dataKey:"approvalsReceived",color:i,label:"received"}]})]}),n.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[n.jsx(pt,{data:v,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),n.jsx(pt,{data:v,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),b.pieData.length>0&&n.jsx(Fn,{data:b.pieData,title:b.sectionTitle})]})}),n.jsx(bt,{pullRequests:s,chunkyData:x,tableOpenedByDefault:!0}),n.jsx(Jt,{})]})},Bl=()=>{const{showPvP:e,userPage:t}=We(),s=!!(t&&t.length>0),a=e||s,o=T(r=>r.reportType);return n.jsxs("div",{children:[e&&n.jsx(Ml,{}),s&&n.jsx(Al,{}),!a&&o==="team"&&n.jsx($l,{}),!a&&o==="user"&&n.jsx(Ol,{}),!a&&o==="org"&&n.jsx(vl,{}),!a&&o==="repo"&&n.jsx(Dl,{})]})},Fl=()=>{const{toggleTheme:e}=G();return n.jsxs("div",{className:"grow self-center flex flex-nowrap justify-end gap-x-2 mr-2",children:[n.jsx("a",{className:"hover:text-primary",href:"https://bsky.app/profile/chris-n07734.bsky.social",children:n.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"BlueSkyIcon",children:n.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"})})}),n.jsx("a",{className:"hover:text-primary",href:"https://github.com/n07734/community-health",children:n.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"GitHubIcon",children:n.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"})})}),n.jsxs("a",{href:"#theme",onClick:t=>{t.preventDefault(),e()},className:"theme-icon hover:text-primary",children:[n.jsx("svg",{className:"h-6 w-6 sun fill-current dark:display-none",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"SunnyIcon",children:n.jsx("path",{d:"m6.76 4.84-1.8-1.79-1.41 1.41 1.79 1.79zM4 10.5H1v2h3zm9-9.95h-2V3.5h2zm7.45 3.91-1.41-1.41-1.79 1.79 1.41 1.41zm-3.21 13.7 1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5v2h3v-2zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6m-1 16.95h2V19.5h-2zm-7.45-3.91 1.41 1.41 1.79-1.8-1.41-1.41z"})}),n.jsx("svg",{className:"h-6 w-6 moon fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"MoonIcon",children:n.jsx("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54 0 4.48-2.94 8.27-7 9.54.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2"})})]})]})},na=Ys,aa=Qs,oa=Vt,Ll=Ws,ra=j.forwardRef(({className:e,...t},s)=>n.jsx(ft,{className:C("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));ra.displayName=ft.displayName;const Vl=Lt("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Xt=j.forwardRef(({side:e="right",className:t,children:s,...a},o)=>n.jsxs(Ll,{children:[n.jsx(ra,{}),n.jsxs(He,{ref:o,className:C(Vl({side:e}),t),...a,children:[s,n.jsxs(Vt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[n.jsx(Xa,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Xt.displayName=He.displayName;const Zt=({className:e,...t})=>n.jsx("div",{className:C("flex flex-col space-y-2 text-center sm:text-left",e),...t});Zt.displayName="SheetHeader";const es=j.forwardRef(({className:e,...t},s)=>n.jsx(xt,{ref:s,className:C("text-lg font-semibold text-foreground",e),...t}));es.displayName=xt.displayName;const la=j.forwardRef(({className:e,...t},s)=>n.jsx(vt,{ref:s,className:C("text-sm text-muted-foreground",e),...t}));la.displayName=vt.displayName;const Kl=[["Individual report","user"],["Team report","team"],["Repo report","repo"],["Org report","org"]],ql=({setNewReportType:e})=>n.jsxs(na,{children:[n.jsx(aa,{asChild:!0,children:n.jsx($,{variant:"link",className:"normal-case text-report-title hover:text-primary text-base",children:"Make a report"})}),n.jsxs(Xt,{className:"bg-background",children:[n.jsxs(Zt,{children:[n.jsx(es,{children:"Make a report"}),n.jsx(la,{children:"Choose the type of report you want to make"})]}),n.jsx("div",{children:Kl.map(([t,s],a)=>n.jsx(oa,{asChild:!0,children:n.jsx($,{className:"text-xl normal-case mr-2 mb-3 w-full",variant:"secondary",onClick:()=>{const o=new URL(window.location.href);o.searchParams.delete("report"),history.pushState(null,"",o),Mn(),e(s)},children:t})},`${a}`))})]})]}),ca=[],Ul=[{name:"React",fileName:"facebook-react"},{name:"NextJS",fileName:"vercel-next.js"},{name:"Remix",fileName:"remix-run-remix"},{name:"Vue",fileName:"vuejs-core"},{name:"Svelte",fileName:"sveltejs-svelte"},{name:"Typescript",fileName:"microsoft-typescript"},{name:"Typescript 10th anniversary",fileName:"microsoft-typescript-10"},{name:"MSW",fileName:"mswjs-msw"},{name:"SWC",fileName:"swc-project-swc"},{name:"vscode",fileName:"microsoft-vscode"},{name:"Node",fileName:"nodejs-node"},{name:"Bluesky",fileName:"bluesky-social-social-app"}],Gl=[{name:"Vite",fileName:"vitejs"},{name:"testing-library",fileName:"testing-library"},{name:"TanStack",fileName:"TanStack"}],zl=[{name:"ReactCore",fileName:"ReactCore"},{name:"ViteCore",fileName:"ViteCore"},{name:"TypeScriptCore",fileName:"TypeScriptCore"}],Hl=[{name:"Theo",fileName:"t3dotgg"},{name:"Daniel Roe",fileName:"danielroe"},{name:"Kent",fileName:"kentcdodds"},{name:"Hailey",fileName:"haileyok"},{name:"shadcn",fileName:"shadcn"},{name:"Dominik",fileName:"tkdodo"},{name:"Tyler",fileName:"coolsoftwaretyler"}],Wl=[{name:"Vite",fileName:"vitejs"},{name:"Vitest",fileName:"vitest-dev-vitest"},{name:"Playwright",fileName:"microsoft-playwright"},{name:"Astro",fileName:"withastro-astro"},{name:"PNPM",fileName:"pnpm-pnpm"},{name:"esbuild",fileName:"evanw-esbuild"},{name:"Testing Library",fileName:"testing-library"},{name:"SvelteKit",fileName:"sveltejs-kit"}],Yl=({setNewReportType:e})=>{const t=D(te(a=>a.preFetchedName)),s=(a,o=1)=>n.jsx(oa,{asChild:!0,children:n.jsx($,{className:"mr-2 mb-3","data-qa-id":`prefetch-${a.name}`,variant:t===a.fileName?void 0:"secondary",onClick:()=>{const r=new URL(window.location.href);r.searchParams.set("report",a.fileName),history.pushState(null,"",r),e(""),In(a)},children:(a==null?void 0:a.name)||"Report"})},`${o}`);return n.jsxs(na,{children:[n.jsx(aa,{asChild:!0,children:n.jsx($,{variant:"link",className:"normal-case text-foreground hover:text-primary text-base",children:"Other reports"})}),n.jsxs(Xt,{className:"bg-background overflow-scroll",children:[n.jsx(Zt,{children:n.jsx(es,{children:"See a different report"})}),n.jsxs("div",{className:"mb-4",children:[ca.map(s),n.jsxs("div",{children:[n.jsxs("p",{children:[n.jsx("a",{className:"text-primary",href:"https://2024.stateofjs.com/en-US/libraries/#tier_list",children:"StateOfJS 24"})," S tier list"]}),Wl.map(s)]}),n.jsx("p",{children:"Other reports"}),n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"Repository reports"}),Ul.map(s),n.jsx("p",{children:"Org reports"}),Gl.map(s),n.jsx("p",{children:"Team reports"}),zl.map(s),n.jsx("p",{children:"Individual reports"}),Hl.map(s)]})]})]})]})},Ql=()=>{var m,d;const e=T(g=>g.error),{togglePvPPage:t,setUserPage:s}=We(),a=(m=window==null?void 0:window.location)==null?void 0:m.search,o=new URLSearchParams(a),r=o.get("player1")||"",l=o.get("player2")||"",c=o.get("user")||"",u=o.get("report")||((d=ca[0])==null?void 0:d.fileName)||"bluesky-social-social-app";return j.useEffect(()=>{In({fileName:u})},[u]),j.useEffect(()=>{r&&l?t():c&&s(c)},[t,s,r,l,c]),n.jsx(n.Fragment,{children:e&&e.message&&n.jsx(Qt,{error:e,className:"col-span-full mb-4"})})},_l=({reportType:e="repo"})=>{const t=T(b=>b),{fetching:s=!1}=t,o={repo:"Get community data for any repo",team:"Get community data for any Team(list of users)",user:"Get data for an individual",org:"Get community data for any Org"}[e],l={repo:{reportType:"repo",org:"",repo:""},org:{reportType:"org",org:""},team:{reportType:"team",usersInfo:{},teamName:""},user:{reportType:"user",userId:"",name:""}}[e],c=j.useMemo(()=>({sortDirection:"DESC",amountOfData:1,token:"",excludeIds:"",enterpriseAPI:"",events:"",...l}),[l]),[i,u]=j.useState({}),[m,d]=j.useState(c),g=(b={})=>{const y={...m,...b};d(y)};j.useEffect(()=>{d(c)},[c,d]);const h=(b,y)=>d({...m,[b]:y}),p={inputError:i,setInputError:u,formInfo:m,setValue:h},f=b=>{b.preventDefault();const{isValid:y,validationErrors:w}=zn(m);if(u(w),!s&&y){const P=On(m);kn({...t,...P})}},x={repo:[{type:"org"},{type:"repo"}],org:[{type:"org",className:"col-span-full"}],team:[{type:"teamName",className:"col-span-full"}],user:[{type:"userId"},{type:"name"}]}[e];return n.jsxs("div",{className:"mb-3",children:[n.jsx("h3",{children:o}),n.jsxs("form",{onSubmit:f,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-start",children:[x.map(b=>n.jsx(Q,{className:b.className,type:b.type,...p},b.type)),m.reportType==="team"&&n.jsx(_n,{usersInfo:m.usersInfo,setParentValues:g}),n.jsx(Q,{className:"col-span-full",type:"events",...p}),n.jsx("p",{className:"col-span-full",children:"Key events can give context when viewing the data e.g. started using copilot, launched a feature. These events can help give more context while viewing the data. e.g.  Copilot adopted=2024-02-01,Feature A=2024-04-10."}),n.jsx(Q,{type:"token",...p}),n.jsx(Kn,{className:"mb-3 max-mm:mb-0 self-end",setValue:h,amountOfData:m.amountOfData}),n.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",n.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]})]}),n.jsx(me,{className:"mb-0 col-span-full",expandText:"show",intro:"Advanced options",children:n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end",children:[n.jsx(Q,{type:"excludeIds",...p}),n.jsx(Q,{type:"enterpriseAPI",...p})]})}),n.jsx(Vn,{})]}),n.jsx(Jn,{})]})},Jl=()=>{const[e,t]=j.useState("");return n.jsxs("div",{className:"p-0 overflow-auto",children:[n.jsxs("header",{children:[n.jsxs("nav",{className:"w-full flex flex-wrap",children:[n.jsx(Yl,{setNewReportType:t}),n.jsx(ql,{setNewReportType:t}),n.jsx(Fl,{})]}),"  ",n.jsx(J,{children:n.jsxs(me,{title:"Code Health",hLevel:1,expandText:"more",children:[n.jsx("p",{children:"Coding is a team activity, healthy collaboration produces better code. This tool gives in depth collaboration and contribution metrics for teams to analyze their code health."}),n.jsx("p",{children:"You can create your own reports for individuals, teams, repos and orgs from public or enterprise GitHub."})]})})]}),n.jsx(Ql,{}),e!==""&&n.jsx(J,{className:"block",children:n.jsx(_l,{reportType:e})}),n.jsx(Bl,{})]})},Nt=j.forwardRef(({className:e,value:t,...s},a)=>n.jsx(Js,{ref:a,className:C("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:n.jsx(Za,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Nt.displayName=Js.displayName;const Xl=({userIds:e,user:t})=>{const s=t?e.findIndex(l=>l===t):0,a=s>0?e.slice(0,s):[],o=100/(e.length||10),r=s*o;return n.jsxs(n.Fragment,{children:[n.jsxs(Ye,{className:"text-6xl font-extralight mb-08",children:["Fetching ",s+1," of ",e.length," ",e.length===1?"user":"users"]}),n.jsx(Nt,{value:r}),a.length>0&&n.jsxs("p",{children:["Fetched users: ",a.join(", ")]})]})},Zl=({repo:e,repos:t,loadedPercent:s,prCount:a,issueCount:o})=>{const r=e?t.findIndex(c=>c===e):0,l=r>0?t.slice(0,r):[];return n.jsxs(n.Fragment,{children:[n.jsxs(Ye,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e})]}),n.jsx(Nt,{value:s}),n.jsxs("h3",{children:[a," Pull Requests"]}),n.jsxs("h3",{children:[o," Issues"]}),l.length>0&&n.jsxs("p",{children:["Fetched repos: ",l.join(", ")]})]})},Ss=({user:e,repo:t,loadedPercent:s,prCount:a,issueCount:o})=>n.jsxs(n.Fragment,{children:[n.jsxs(Ye,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e||t})]}),n.jsx(Nt,{value:s}),n.jsxs("h3",{children:[a," Pull Requests"]}),n.jsxs("h3",{children:[o," Issues"]})]}),ec=({savedReportName:e})=>n.jsxs(Ye,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e})]}),tc={team:Xl,user:Ss,repo:Ss,org:Zl,saved:ec},sc=()=>{const{fetching:e=!1,fetchStatus:t={},userIds:s=[],sortDirection:a="",formUntilDate:o=""}=T(B=>B),r=D(B=>B.pullRequests),{user:l="",repo:c="",repos:i=[],savedReportName:u="",prCount:m=0,latestItemDate:d="",issueCount:g=0,paused:h=!1}=t,p=u&&"saved"||s.length>1&&"team"||s.length===1&&"user"||i.length>1&&"org"||"repo",f=(B,z)=>a==="DESC"?pe(B,z):pe(z,B),v=a==="DESC"?0:-1,x=r.length>0?new Date(r.at(v).mergedAt):new Date,b=d?new Date(d):x,y=new Date(o),w=f(x,y),P=f(x,b),N=100/(w||10),I=P*N,S=tc[p];return e&&n.jsx(Hn,{open:!0,children:n.jsxs(Qn,{"aria-describedby":void 0,"data-qa-id":"loader",className:"overflow-scroll max-h-full w-4/5",children:[h&&n.jsx("p",{children:" Fetching paused briefly due to Github api throttling."}),n.jsx(S,{userIds:s,user:l,repo:c,repos:i,prCount:m,issueCount:g,savedReportName:u,loadedPercent:I})]})})};class nc extends j.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,s){console.error("Uncaught error:",t,s)}render(){return this.state.hasError?n.jsx("h1",{className:"text-center mt-4",children:"Something went wrong."}):this.props.children}}const ac=()=>n.jsx(nc,{children:n.jsxs(ro,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[n.jsx(sc,{}),n.jsx(Jl,{})]})});eo.createRoot(document.getElementById("root")).render(n.jsx(to.StrictMode,{children:n.jsx(so,{children:n.jsx(no,{children:n.jsx(ao,{children:n.jsx(ac,{})})})})}));

import{r as j,j as n,R as ma,C as ua,t as ha,c as ga,a as Lt,S as pa,T as Cs,I as fa,b as As,d as Ts,P as xa,e as ks,V as va,L as Is,f as Ms,g as ya,h as wa,i as Es,k as ba,G as ja,l as Na,m as $s,n as Os,o as Pa,p as Bs,u as Ra,q as ts,s as St,v as Da,w as Sa,x as Ca,y as he,z as ss,A as it,B as dt,D as ns,E as Aa,F as Ta,H as ka,J as Ia,K as Ma,M as Fs,N as Ls,O as Ea,Q as I,U as nt,W as Ue,X as ie,Y as R,Z as se,_ as K,$ as re,a0 as $a,a1 as we,a2 as Oe,a3 as rt,a4 as jt,a5 as Vs,a6 as Ct,a7 as At,a8 as Ke,a9 as Ks,aa as Oa,ab as Ba,ac as qs,ad as Gs,ae as Us,af as Fa,ag as La,ah as Va,ai as Ka,aj as as,ak as $e,al as qa,am as zs,an as _,ao as Ga,ap as Tt,aq as Ua,ar as za,as as Hs,at as Ha,au as ue,av as Wa,aw as kt,ax as Ya,ay as gt,az as ze,aA as Vt,aB as pt,aC as ft,aD as Ws,aE as Ys,aF as Qs,aG as _s,aH as Qa,aI as _a,aJ as os,aK as rs,aL as Ja,aM as Xa,aN as Za,aO as Js,aP as eo,aQ as to,aR as so}from"./vendor-CtcYDE6B.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();const Xs=j.createContext({}),no=({children:e})=>{const[t,s]=j.useState(!0),o={showNumbers:t,toggleShowNumbers:()=>s(!t)};return n.jsx(Xs.Provider,{value:o,children:e})},at=()=>j.useContext(Xs),Zs=j.createContext({}),ao=({children:e})=>{const[t,s]=j.useState(!0),o={showNames:t,toggleShowNames:()=>s(!t)};return n.jsx(Zs.Provider,{value:o,children:e})},be=()=>j.useContext(Zs),en=j.createContext({}),oo=({children:e})=>{const[t,s]=j.useState(!1),[a,o]=j.useState(""),i={showPvP:t,togglePvPPage:()=>{s(!t),o("")},userPage:a,setUserPage:(u="")=>{s(!1),o(u)},clearUserPage:()=>{s(!1),o("")}};return n.jsx(en.Provider,{value:i,children:e})},He=()=>j.useContext(en),ro={theme:"dark",toggleTheme:()=>null},tn=j.createContext(ro),lo=({children:e,defaultTheme:t="dark",storageKey:s="vite-ui-theme",...a})=>{const[o,r]=j.useState(()=>localStorage.getItem(s)||t);j.useEffect(()=>{const c=window.document.documentElement;c.classList.remove("light","dark"),c.classList.add(o)},[o]);const l={theme:o,toggleTheme:()=>{const c=o==="dark"?"light":"dark";localStorage.setItem(s,c),r(c)}};return n.jsx(tn.Provider,{...a,value:l,children:e})},G=()=>{const e=j.useContext(tn);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},co=ma,io=ua,ls=({setIsOpen:e,isOpen:t,expandText:s,qaId:a,className:o})=>n.jsx("a",{className:`text-base text-primary ${o}`,href:"#desc",...a&&{"data-qa-id":a},onClick:r=>{r.preventDefault(),e(!t)},children:t?"hide":s}),mo=({hLevel:e,children:t})=>{const s=`h${e}`;return n.jsx(s,{children:t})},de=({title:e,intro:t,children:s,hLevel:a=3,expandText:o="info",className:r="",expandQaId:l})=>{const[c,i]=j.useState(!1);return n.jsxs("div",{className:`w-full flex flex-grow flex-wrap ${r} ${t?"[&>*]:basis-full":""}`,children:[e&&typeof e=="string"?n.jsxs(mo,{hLevel:a,children:[e,s&&n.jsx(ls,{isOpen:c,setIsOpen:i,expandText:o,qaId:l,className:"ml-2"})]}):e,n.jsxs("p",{children:[t," ",t&&s&&n.jsx(ls,{isOpen:c,setIsOpen:i,expandText:o,qaId:l})]}),n.jsx(co,{open:c,onOpenChange:i,className:"wrapper basis-full",children:n.jsx(io,{children:s})})]})},J=({className:e="",children:t})=>n.jsx("div",{className:`paper ${e}`,children:t});function C(...e){return ha(ga(e))}const uo=Lt("uppercase inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),O=j.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...o},r)=>{const l=a?pa:"button";return n.jsx(l,{className:C(uo({variant:t,size:s,className:e})),ref:r,...o})});O.displayName="Button";const je=({children:e})=>n.jsx("div",{className:"w-full relative flex flex-col flex-wrap gap-0 items-center 3xl:flex-row 3xl:gap-0 3xl:gap-x-5 3xl:justify-center",children:e}),Je='"Nunito", "Roboto", "Helvetica", "Arial", sans-serif',Xe=12,Nt={legendOrientation:"horizontal",legendPosition:"top-right",height:10,legendOffsetX:0,legendOffsetY:-4},ot=(e="dark")=>{const t={light:"#232023",dark:"#eee"}[e],s={light:"#fff",dark:"#232023"}[e],a={light:"#077314",dark:"#077314"}[e],o={light:"#8b4ff0",dark:"#6b3dba"}[e],r={light:"#87cac6",dark:"#6b3dba"}[e];return{fontFamily:Je,fontSize:Xe,textColor:t,crosshair:{line:{stroke:t}},axis:{legend:{text:{fill:t}},ticks:{text:{fill:t}}},legends:{hidden:{symbol:{fill:"#eee",opacity:1},text:{fill:"#eee",fontWeight:"400",opacity:1}},text:{fontWeight:"800"}},legendsTextFill:t,dotColor:t,tooltip:{container:{fontFamily:Je,fontSize:Xe,background:s,color:t,boxShadow:`0 1px 2px ${t}`}},grid:{line:{stroke:"#999"}},markers:{primary:{lineStyle:{stroke:a,strokeWidth:1},textStyle:{fontFamily:Je,fontSize:Xe,fill:a},...Nt},secondary:{lineStyle:{stroke:o,strokeWidth:1},textStyle:{fontFamily:Je,fontSize:Xe,fill:o},...Nt},tertiary:{lineStyle:{stroke:r,strokeWidth:1,strokeDasharray:"2 6"},textStyle:{fontFamily:Je,fontSize:Xe,fill:r},...Nt}}}},qe=({className:e="",items:t=[],text:s="",type:a})=>{const o=m=>{const d=t.length-1,g={zero:"",max:" and ",more:", "},h=[m===0&&"zero",m===d&&"max",m>0&&"more"].find(Boolean);return g[h]},r=({color:m,label:d})=>n.jsx("span",{style:{color:m,borderBottomColor:m},className:"saved-line",children:d}),l=({color:m,label:d})=>n.jsx("span",{style:{color:m},children:d}),c={average:"Average",trimmedAverage:"Trimmed Average",sum:"Total",count:"Total",teamDistribution:"",median:"",percentWith:"",growth:"",averagePerDev:""},i=[...new Set(t.filter(m=>"groupMath"in m).map(m=>"groupMath"in m&&m.groupMath))],u=(t.length>0&&a==="line"&&i.length<2?i[0]||"average":"")||"";return n.jsxs("h4",{className:e,children:[`${s} `,u&&`${c[u]} `,t.map((m,d)=>n.jsxs(j.Fragment,{children:[o(d),a==="line"?n.jsx(r,{...m}):n.jsx(l,{...m})]},d))]})},Be=ba,Fe=ja,Le=Na,Ce=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Cs,{ref:a,className:C("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,n.jsx(fa,{asChild:!0,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:n.jsx("path",{d:"m6 9 6 6 6-6"})})})]}));Ce.displayName=Cs.displayName;const sn=j.forwardRef(({className:e,...t},s)=>n.jsx(As,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:n.jsx("path",{d:"m18 15-6-6-6 6"})})}));sn.displayName=As.displayName;const nn=j.forwardRef(({className:e,...t},s)=>n.jsx(Ts,{ref:s,className:C("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 opacity-50","aria-hidden":"true",children:n.jsx("path",{d:"m6 9 6 6 6-6"})})}));nn.displayName=Ts.displayName;const Ae=j.forwardRef(({className:e,children:t,position:s="popper",...a},o)=>n.jsx(xa,{children:n.jsxs(ks,{ref:o,className:C("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[n.jsx(sn,{}),n.jsx(va,{className:C("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(nn,{})]})}));Ae.displayName=ks.displayName;const ho=j.forwardRef(({className:e,...t},s)=>n.jsx(Is,{ref:s,className:C("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));ho.displayName=Is.displayName;const te=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Ms,{ref:a,className:C("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(ya,{children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4","aria-hidden":"true",children:n.jsx("path",{d:"M20 6 9 17l-5-5"})})})}),n.jsx(wa,{children:t})]}));te.displayName=Ms.displayName;const go=j.forwardRef(({className:e,...t},s)=>n.jsx(Es,{ref:s,className:C("-mx-1 my-1 h-px bg-muted",e),...t}));go.displayName=Es.displayName;const an=j.forwardRef(({className:e,...t},s)=>n.jsx($s,{className:C("grid gap-2",e),...t,ref:s}));an.displayName=$s.displayName;const It=j.forwardRef(({className:e,...t},s)=>n.jsx(Os,{ref:s,className:C("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(Pa,{className:"flex items-center justify-center",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-2.5 w-2.5 fill-current text-current",children:n.jsx("circle",{cx:"12",cy:"12",r:"10"})})})}));It.displayName=Os.displayName;const po=Lt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),st=j.forwardRef(({className:e,...t},s)=>n.jsx(Bs,{ref:s,className:C(po(),e),...t}));st.displayName=Bs.displayName;const E=["#E82573","#8b4ff0","#1F77B4","#4ECC7A","#DBD523","#EB9830","#D14B41"],V={dark:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#E2E2E2"},light:{primary:"#E82573",secondary:"#1F77B4",tertiary:"#777"}},oe=["average","trimmedAverage","sum","median"],Kt=[{label:"Comments",dataKey:"comments",groupMaths:[...oe,"percentWith","teamDistribution"]},{label:"Code comments",dataKey:"codeComments",groupMaths:[...oe,"percentWith"]},{label:"Review comments",dataKey:"generalComments",groupMaths:[...oe,"percentWith"]},{label:"Approvals",dataKey:"approvals",groupMaths:[...oe,"percentWith","teamDistribution"]},{label:"Additions",dataKey:"additions",groupMaths:oe},{label:"Deletions",dataKey:"deletions",groupMaths:oe},{label:"PR size (additions + deletions)",dataKey:"prSize",groupMaths:oe},{label:"Codebase change (additions - deletions)",dataKey:"growth",groupMaths:["growth"]},{label:"PR count",dataKey:"author",groupMaths:["count","averagePerDev"]},{label:"PR Age(days)",dataKey:"age",groupMaths:oe},{label:"Sentiment",dataKey:"commentSentimentTotalScore",groupMaths:oe},{label:"Sentiment to team",dataKey:"commentSentimentScore",groupMaths:oe},{label:"Sentiment from team",dataKey:"commentAuthorSentimentScore",groupMaths:oe},{label:"Bug count",dataKey:"isBug",groupMaths:["count"]},{label:"Feature count",dataKey:"isFeature",groupMaths:["count"]}],fo={average:"Average",trimmedAverage:"*Trimmed Average",sum:"Total",count:"Total",median:"Median",teamDistribution:"Team's % spread of",percentWith:"% of PRs with",growth:"",averagePerDev:"Average per Dev"},cs=e=>({color:t,label:s="",dataKey:a,groupMath:o="average"},r)=>n.jsxs("div",{style:{color:t},children:[n.jsx("p",{className:"saved-line text-xl",children:s}),n.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",onClick:l=>{l.preventDefault(),e(a,o)},children:n.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})})]},`${r}`),on=e=>[...e.left||[],...e.right||[]],Mt=e=>{const t=on(e),s=[];return Kt.forEach(({label:a="",dataKey:o,groupMaths:r=[]})=>{const l=t.filter(i=>(i==null?void 0:i.dataKey)===o),c=r.filter(i=>l.every(u=>(u==null?void 0:u.groupMath)!==i));c.length>0&&s.push({label:a,dataKey:o,groupMaths:c})}),s},xo=e=>{const s=on(e).map(o=>o==null?void 0:o.dataKey);return Kt.find(({dataKey:o})=>!s.includes(o))},vo=(e,t)=>{const s=Mt(t),a=e.dataKey,o=s.findIndex(r=>r.dataKey===a);return s[o+1]||s[0]||Kt[0]},is={average:()=>"Average",trimmedAverage:()=>"Trimmed Average",sum:()=>"Total",median:()=>"Median",growth:()=>"Growth",percentWith:({label:e=""}={})=>`% of PRs with ${e}`,teamDistribution:({label:e=""}={})=>`Team's % spread of ${e}`,count:()=>"Total",averagePerDev:({label:e=""}={})=>`Average ${e} per DEV`},rn=({graphInfo:e,setGraph:t=()=>{},graphs:s=[]})=>{var g;const a=xo(e),[o,r]=j.useState({label:(a==null?void 0:a.label)||"Comments",dataKey:(a==null?void 0:a.dataKey)||"comments",color:s.length>1?E[0]:E[1],lineSide:"left",groupMath:(g=a==null?void 0:a.groupMaths)==null?void 0:g[0]}),l=(h={})=>{r({...o,...h})},c=h=>{h.preventDefault();const{lineSide:p,label:f,groupMath:x}=o,v=e[p]||[];v.push({...o,label:`${fo[x]} ${f}`,groupMath:x,.../teamDistribution|percentWith/.test(x)&&{yMax:100}});const b={...e,[p]:v},w=s.map(N=>b.graphId===N.graphId?b:N);t(w);const y=vo(o,b),P=E.findIndex(N=>N===o.color);r({label:y.label,dataKey:y.dataKey,color:E[(P+1)%E.length],lineSide:p,groupMath:y==null?void 0:y.groupMaths[0]})},i=h=>(p,f)=>{const v=(e[h]||[]).filter(P=>!(P.dataKey===p&&P.groupMath===f)),b={...e,[h]:v},w=s.map(P=>b.graphId===P.graphId?b:P);t(w);const[y]=Mt(b);r({label:y.label,dataKey:y.dataKey,color:E[0],lineSide:"left",groupMath:y.groupMaths[0]})},u=Mt(e),m=u.find(h=>h.dataKey===o.dataKey),d=((m==null?void 0:m.groupMaths)||[]).filter(h=>!/growth/.test(h));return n.jsxs("div",{className:"w-full max-w-mw",children:[u.length>0&&n.jsxs("form",{className:"flex flex-wrap rounded-2xl justify-center paper pt-2 gap-4 mb-3",onSubmit:c,children:[n.jsxs(Be,{onValueChange:h=>{const p=u.find(f=>f.dataKey===h);l({dataKey:h,groupMath:p.groupMaths[0],label:p.label})},value:m==null?void 0:m.dataKey,children:[n.jsx(Ce,{className:"w-auto",children:n.jsx(Le,{children:m==null?void 0:m.label})}),n.jsx(Ae,{children:n.jsx(Fe,{children:u.map(({label:h,dataKey:p})=>n.jsx(te,{value:p,children:h},`${m==null?void 0:m.dataKey}${p}${h}`))})})]}),d.length>0&&n.jsxs(Be,{onValueChange:h=>h&&l({groupMath:h}),value:o.groupMath,children:[n.jsx(Ce,{className:"w-auto",children:n.jsx(Le,{children:is[o.groupMath](o)})}),n.jsx(Ae,{children:n.jsx(Fe,{children:d.map(h=>n.jsx(te,{value:h,children:is[h](o)},`${o.dataKey}${h}`))})})]}),n.jsx(an,{defaultValue:o.lineSide,onValueChange:h=>h&&l({lineSide:h}),children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(It,{value:"left",id:"r1"}),n.jsx(st,{htmlFor:"r1",children:"Axis: Left"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(It,{value:"right",id:"r2"}),n.jsx(st,{htmlFor:"r2",children:"Right"})]})]})}),n.jsxs(Be,{onValueChange:h=>h&&l({color:h}),value:o.color,children:[n.jsx(Ce,{className:"w-auto",children:n.jsx(Le,{placeholder:n.jsx("div",{style:{backgroundColor:o.color,width:"70px",height:"10px"}})})}),n.jsx(Ae,{children:n.jsx(Fe,{children:E.map(h=>n.jsx(te,{value:h,children:n.jsx("div",{style:{backgroundColor:h,width:"70px",height:"10px"}})},h))})})]}),n.jsx(O,{color:"primary",type:"submit",children:"Add to graph"})]}),n.jsxs("div",{className:"custom-lines",children:[n.jsx("div",{children:(e.left||[]).map(cs(i("left")))}),n.jsx("div",{children:(e.right||[]).map(cs(i("right")))})]})]})},ln=j.forwardRef(({className:e,...t},s)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:s,className:C("w-full caption-bottom text-sm",e),...t})}));ln.displayName="Table";const cn=j.forwardRef(({className:e,...t},s)=>n.jsx("thead",{ref:s,className:C("[&_tr]:border-b",e),...t}));cn.displayName="TableHeader";const dn=j.forwardRef(({className:e,...t},s)=>n.jsx("tbody",{ref:s,className:C("[&_tr:last-child]:border-0",e),...t}));dn.displayName="TableBody";const yo=j.forwardRef(({className:e,...t},s)=>n.jsx("tfoot",{ref:s,className:C("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));yo.displayName="TableFooter";const ct=j.forwardRef(({className:e,...t},s)=>n.jsx("tr",{ref:s,className:C("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ct.displayName="TableRow";const mn=j.forwardRef(({className:e,...t},s)=>n.jsx("th",{ref:s,className:C("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));mn.displayName="TableHead";const Et=j.forwardRef(({className:e,...t},s)=>n.jsx("td",{ref:s,className:C("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Et.displayName="TableCell";const wo=j.forwardRef(({className:e,...t},s)=>n.jsx("caption",{ref:s,className:C("mt-4 text-sm text-muted-foreground",e),...t}));wo.displayName="TableCaption";const bo=({sort:e})=>({asc:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"m5 12 7-7 7 7"}),n.jsx("path",{d:"M12 19V5"})]}),desc:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"M12 5v14"}),n.jsx("path",{d:"m19 12-7 7-7-7"})]}),none:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4",children:[n.jsx("path",{d:"m21 16-4 4-4-4"}),n.jsx("path",{d:"M17 20V4"}),n.jsx("path",{d:"m3 8 4-4 4 4"}),n.jsx("path",{d:"M7 4v16"})]})})[e],ce=e=>({column:t})=>{const s=t.getIsSorted()||"none";return n.jsxs(O,{variant:"link",className:"p-0",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:[e,n.jsx(bo,{sort:s})]})},jo=[{accessorKey:"age",header:ce("PR Age (days)")},{accessorKey:"comments",header:ce("Comments"),cell:({row:e})=>e.getValue("comments")||0},{accessorKey:"approvals",header:ce("Approvals"),cell:({row:e})=>e.getValue("approvals")||0},{accessorKey:"commentSentimentScore",header:ce("Sentiment received"),cell:({row:e})=>e.getValue("commentSentimentScore")||0},{accessorKey:"commentAuthorSentimentScore",header:ce("Sentiment given"),cell:({row:e})=>e.getValue("commentAuthorSentimentScore")||0},{accessorKey:"commentSentimentTotalScore",header:ce("Sentiment"),cell:({row:e})=>e.getValue("commentSentimentTotalScore")||0},{accessorKey:"prSize",header:ce("PR Size")},{accessorKey:"author",header:ce("Author")},{accessorKey:"mergedAt",header:ce("Date"),cell:({row:e})=>{const t=e.getValue("mergedAt");return St(new Date(t),"do MMM yy")}},{accessorKey:"url",header:ce("Link"),cell:({row:e})=>{const t=e.getValue("url"),s=t.split("/").at(-1);return n.jsx("a",{className:"text-primary",href:t,children:s})}}],No=({dataKeys:e,data:t,addClass:s=""})=>{var m;const[a,o]=j.useState([]),[r,l]=j.useState({pageIndex:0,pageSize:4}),c=[...e,"mergedAt","url"],i=jo.filter(d=>c.includes(d.accessorKey)),u=Ra({data:t,columns:i,getCoreRowModel:Da(),getPaginationRowModel:Sa(),onSortingChange:o,getSortedRowModel:Ca(),onPaginationChange:l,state:{sorting:a,pagination:r}});return n.jsxs("div",{className:`rounded-md border-2 border-primary mx-50 ${s}`,children:[n.jsxs(ln,{children:[n.jsx(cn,{children:u.getHeaderGroups().map(d=>n.jsx(ct,{children:d.headers.map(g=>n.jsx(mn,{children:g.isPlaceholder?null:ts(g.column.columnDef.header,g.getContext())},g.id))},d.id))}),n.jsx(dn,{children:(m=u.getRowModel().rows)!=null&&m.length?u.getRowModel().rows.map(d=>n.jsx(ct,{"data-state":d.getIsSelected()&&"selected",children:d.getVisibleCells().map(g=>n.jsx(Et,{children:ts(g.column.columnDef.cell,g.getContext())},g.id))},d.id)):n.jsx(ct,{children:n.jsx(Et,{colSpan:i.length,className:"h-24 text-center",children:"No results."})})})]}),n.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4",children:[n.jsxs("p",{children:[r.pageIndex+1," of ",u.getPageCount()]}),n.jsx(O,{variant:"ghost",size:"sm",onClick:()=>u.previousPage(),disabled:!u.getCanPreviousPage(),children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:n.jsx("path",{d:"m15 18-6-6 6-6"})})}),n.jsx(O,{variant:"ghost",size:"sm",onClick:()=>u.nextPage(),disabled:!u.getCanNextPage(),children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:n.jsx("path",{d:"m9 18 6-6-6-6"})})})]})]})},un=()=>n.jsx("svg",{className:"w-[22px] h-[22px] fill-background inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:n.jsx("path",{d:"M15.5 3.5c-7.18 0-13 5.82-13 13s5.82 13 13 13c7.18 0 13-5.82 13-13s-5.82-13-13-13zM22 16.875c0 0.553-0.448 1-1 1h-11c-0.553 0-1-0.447-1-1v-1c0-0.552 0.447-1 1-1h11c0.552 0 1 0.448 1 1v1z"})}),Po=()=>n.jsx("svg",{className:"w-[22px] h-[22px] fill-current inline-block",focusable:"false","aria-hidden":"true",viewBox:"0 0 32 32","data-qa-id":"RemoveCircleIcon",children:n.jsx("path",{d:"M15.5 29.5c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM21.938 15.938c0-0.552-0.448-1-1-1h-4v-4c0-0.552-0.447-1-1-1h-1c-0.553 0-1 0.448-1 1v4h-4c-0.553 0-1 0.448-1 1v1c0 0.553 0.447 1 1 1h4v4c0 0.553 0.447 1 1 1h1c0.553 0 1-0.447 1-1v-4h4c0.552 0 1-0.447 1-1v-1z"})}),Ro=({showTable:e=!1})=>e?n.jsx(Po,{}):n.jsx(un,{}),Do=({dataKeys:e,data:t,tableOpenedByDefault:s=!1})=>{var h;const[a,o]=j.useState(t.length-1),[r,l]=j.useState(s),c=t.flat(),u=c.length>30?t:[c],m=a===0?"rounded-tl-none":"",d=a===t.length-1?"rounded-tr-none":"",g=m||d||"";return n.jsxs("div",{className:"mb-4",children:[u.length>0&&n.jsx("div",{className:"px-50 flex flex-row justify-stretch gap-x-1",children:u.map((p,f)=>n.jsx(O,{className:`rounded-lg relative w-full px-0 py-1 h-full ${a===f&&r?"slice rounded-t-lg rounded-b-none border-b-4 border-primary hover:bg-primary":"mb-1 bg-secondary hover:bg-secondary"}`,onClick:()=>{a===f&&l(!r),a!==f&&!r&&l(!0),o(f)},children:a===f?n.jsx(Ro,{showTable:r}):n.jsx(un,{})},f))}),((h=u[a])==null?void 0:h.length)>0&&r&&n.jsx(No,{data:u[a],dataKeys:e,addClass:g})]})},So=(e,t)=>{const s=e&&ss(new Date(e))+1,a=t&&ss(new Date(t))+1;return!!(s&&a&&s!==a)},Co=(e,t)=>{const s=e&&it(new Date(e)),a=t&&it(new Date(t));return!!(s&&a&&s!==a)},ds=e=>(t,s)=>{const a=t&&it(new Date(t)),o=s&&it(new Date(s));return!!(a&&o&&a%e>0&&o%e===0)},Ao=(e,t)=>{const s=e&&dt(new Date(e))+1,a=t&&dt(new Date(t))+1;return!!(s&&a&&s!==a)},To=e=>(t,s)=>{const a=t&&dt(new Date(t))+1,o=s&&dt(new Date(s))+1;return!!(a&&o&&a%e>0&&o%e===0)},ko=(e,t)=>{const s=e&&ns(new Date(e)),a=t&&ns(new Date(t));return!!(s&&a&&s!==a)},Io={"1day":So,"1week":Co,"2week":ds(2),"3week":ds(3),"1month":Ao,"1quarter":To(3),"1year":ko},Mo=(e,t,s=[])=>{const a=[];return s.forEach(o=>{const l=(a.at(-1)||[]).at(-1)||{};!l[e]||Io[t](l[e],o[e])?a.push([o]):a.at(-1).push(o)}),a},Eo=(e=[])=>{const{mergedAt:t}=e.at(0),{mergedAt:s}=e.at(-1),a=he(new Date(s),new Date(t)),o=[{batchType:"1year",maxPoints:Math.ceil(a/365)},{batchType:"1quarter",maxPoints:Math.ceil(a/89)},{batchType:"1month",maxPoints:Math.ceil(a/30)},{batchType:"2week",maxPoints:Math.ceil(a/14)},{batchType:"1week",maxPoints:Math.ceil(a/7)},{batchType:"1day",maxPoints:a}],{batchType:r}=o.reduce((l,c)=>!l.maxPoints||Math.abs(c.maxPoints-15)<Math.abs(l.maxPoints-15)?c:l,{});return Mo("mergedAt",r,e)},hn=(e=[])=>e.length<1?[]:Eo(e),$t=e=>(t=[])=>t.reduce((s,a)=>(a[e]||0)+s,0),$o=e=>t=>e.reduce((s,a)=>s+(t&&t[a]||0),0),Ne=(e=[])=>(t,s)=>{const a=$o(e),o=a(t);return a(s)-o},Oo=e=>(t,s)=>e==="DESC"?new Date(s).getTime()-new Date(t).getTime():new Date(t).getTime()-new Date(s).getTime(),gn=e=>{const t=[];return e.forEach(({data:s})=>{const a=s.map(o=>o.y);t.push(...a)}),t.sort((s,a)=>s-a)},ms=e=>{const t=gn(e),s=Math.round(t.length*.95),a=t[s]||0,o=t.at(-1)||0,r=a&&Math.round(a/o*100)||0;return a&&r<30?a:o},us=e=>{const t=gn(e),s=t.length>0?Aa(Math.min,t):0;return s>0?0:s},Bo=e=>{const t=new Date(e),s=t.getMonth()+1,a=t.getDate();return`${t.getFullYear()}-${s<10?`0${s}`:s}-${a<10?`0${a}`:a}`},Fo=({batch:e=[]})=>{const t={};return e.forEach(s=>"prSize"in s&&(t[s.author]=1)),Math.round(e.length/Object.keys(t).length)},Lo=({batch:e=[],dataKey:t})=>{const s=t,a=e.sort(Ne([s])),o=a.length,r=o>4?a.slice(Math.ceil(o*.05),Math.floor(o*.95)):a,l=r.reduce((c,i)=>c+(s&&i[s]||0),0)/r.length;return Math.round(l)},Vo=({batch:e=[],dataKey:t="comments"})=>{const s=new Set([]),a={};e.forEach(p=>{if(!("prSize"in p))return;const{teamApprovers:f={},teamCommenters:x={}}=p,v=/approvals/i.test(t)?f:x;Object.entries(v).forEach(([w,y])=>{a[w]=(a[w]||0)+y});const b=[...Object.keys(f)||[],...Object.keys(x)||[]];b.length>0&&b.map(w=>s.add(w))});const o={};s.forEach(p=>o[p]=0);const r={...o,...a},l=Object.values(r),c=l.length,i=l.reduce((p,f)=>p+f,0),u=i/c,m=u*(c-1)+(i-u),d=l.reduce((p,f)=>p+Math.abs(f-u),0),g=m-d,h=Math.round(100/m*g);return isNaN(h)?0:h},Ko=({batch:e=[],dataKey:t="comments"})=>{const s=e.length,o=e.filter(l=>!l[t]).length;return o>0?Math.round((s-o)/s*100):0},qo=({batch:e,dataKey:t})=>{const s=e.length,a=e.sort(Ne([t])),o=Math.floor(s/2);return a[o][t]||0},Go=({batch:e})=>e.reduce((s=0,a)=>{if(!("prSize"in a))return s;const{additions:o=0,deletions:r=0}=a;return s+(o-r)},0),Uo=({dataKey:e,groupMath:t="average"},s=[])=>{const a=[];return s.forEach(o=>{const r=o.length;if(r>0){const l={average:()=>r>0?Math.round($t(e)(o)/r):0,trimmedAverage:Lo,sum:()=>$t(e)(o),count:()=>r,averagePerDev:Fo,median:qo,percentWith:Ko,teamDistribution:Vo,growth:Go};a.push({y:l[t]({batch:o,dataKey:e}),x:Bo(o[0].mergedAt)})}}),a},hs=({lines:e=[]})=>{const t=[];return e.forEach(s=>{const{label:a,color:o,data:r}=s,l=hn(r),c=Uo(s,l);c.length&&t.push({id:a,color:o,data:c})}),t},zo=(e,t,s)=>{let a,o;s.forEach(({data:i=[]})=>{const u=i[0].x,m=i[i.length-1].x;(!a||new Date(u)<a)&&(a=new Date(u)),(!o||new Date(m)>o)&&(o=new Date(m))});const r={MAJOR:"primary",MINOR:"secondary",PATCH:"tertiary",EVENT:"primary"},l=[0,18,36,54,72,90];return e.filter(({date:i,releaseType:u})=>{const m=new Date(i);return u!=="PATCH"&&m>a&&m<o}).map((i,u)=>({axis:"x",value:new Date(i.date).getTime(),legend:i.description,...t.markers[r[i.releaseType]]||{},legendOffsetY:l[u%l.length]}))},Ho=e=>{const t=`${e}`,s=Math.ceil(t.length*.4),[a]=t.split("").reduceRight(([r=[],l=!1],c,i)=>{const u=parseInt(c),m=l?u+1:u,d=i!==0&&(m>9||i>s&&m>4),g=d||i>s?0:m;return[[...r,g],d]},[[],!1]);return a.reverse().join("")},Te=(e=[])=>{var i,u,m,d;const t=hn(e),s=t.at(0)||[],a=t.at(-1)||[],o=s.at(0)&&new Date(((i=s.at(0))==null?void 0:i.mergedAt)||((u=s.at(0))==null?void 0:u.createdAt)),r=a.at(0)&&new Date(((m=a.at(0))==null?void 0:m.mergedAt)||((d=a.at(0))==null?void 0:d.createdAt)),l=o&&r?he(r,o):0,c=[];return t.forEach((g=[])=>{const h=c.length,p=new Date((g.at(0)||{}).mergedAt||(g.at(0)||{}).createdAt),f=he(p,o),x=Math.floor(f/l*100),v=10*h;h<1||x>=v&&h<10?c.push(g):c.at(-1).push(...g)}),c},Wo=(e=[])=>{const t=[];return e.forEach(({data:s=[]})=>{t.push(new Date(s.at(0).x)),t.push(new Date(s.at(-1).x))}),t},Yo=(e=[],t=[])=>{const s=Wo([...e,...t]),a=Ta(s),o=ka(s);return Ia(o,a)},pn=({pullRequests:e=[],showNames:t=!0,usersInfo:s={}})=>{const a={};return e.forEach(l=>{const{author:c}=l,i=a[c]||[];i.push(l),a[c]=i}),[{lines:Object.entries(a).map(([l="",c=[]],i)=>{var m;const u=c.map(d=>({value:1,mergedAt:d.mergedAt}));return{label:t?((m=s[l])==null?void 0:m.name)||l:`${Array(i).fill(" ").join("")}Spartacus`,color:E[i%E.length],dataKey:"value",groupMath:"count",data:u}}),xAxis:"left"}]},fn=(e="repo",t={})=>{const s=Object.entries(t).sort(([,i],[,u])=>i-u),a=s.slice(-20),o=s.length>19?a.map(([i])=>i):Object.keys(t),r=a.map(([i,u],m)=>({id:i,label:i,color:E[m%E.length],value:u})),l=s.length>o.length?`PR rainbow split by top 20 ${e}s out of ${s.length}`:`PR ${e} rainbow (${o.length})`;return{pieData:r,reportItems:o,pieTitle:`PR by ${e} rainbow`,sectionTitle:l}},Qo=e=>{var a;const t=o=>{const r=o.data.yFormatted,l=o.data.originalY;return/[\d.]/.test(l)?l:r},s=((a=e==null?void 0:e.slice)==null?void 0:a.points)||[];return n.jsx(Fs,{rows:s.map((o,r)=>[n.jsx("span",{style:{display:"block",width:"12px",height:"12px",background:o.serieColor}},r),o.serieId,n.jsx("strong",{children:t(o)},r)])})},_o=(e=[])=>({series:t,lineGenerator:s,xScale:a,yScale:o})=>t.map((r={})=>{const{id:l,data:c,color:i}=r,{lineStyles:u={strokeWidth:2}}=e.find(m=>m.label===l)||{};return n.jsx("path",{d:s(c.map(m=>({x:a(m.data.x),y:o(m.data.y)}))),fill:"none",stroke:i,style:u},l)}),gs=(e=[])=>e.filter(t=>t.yMax).map(t=>t.yMax),ps=(e,t)=>t-e,Q=({title:e,combineTitles:t=!1,blockHeading:s=!1,data:a=[],markers:o=[],showLegends:r=!1,tableData:l=[],tableKeys:c=[],graphInfo:i,setGraph:u=()=>{},graphs:m=[],tableOpenedByDefault:d=!1}={})=>{const{theme:g}=G(),h=ot(g),{showNumbers:p}=at(),f=a.find(({xAxis:A})=>A==="left")||{data:[],lines:[],xAxis:"left"},x=gs(f.lines),v=hs(f),[b]=[...x,ms(v)].sort(ps),w=us(v),y=a.find(({xAxis:A})=>A==="right")||{data:[],lines:[],xAxis:"right"},P=gs(y.lines),N=hs(y),[T]=[...P,ms(N)].sort(ps),S=us(N),B=b||T,H=w>S?S:w,ne=[];N.forEach(A=>{const $=A.data.map(F=>({y:F.y<0?F.y:Math.round(F.y*(B/T)),x:F.x,originalY:F.y}));$.length&&ne.push({...A,data:$})});const M=f.lines,U=!t&&e||s?[]:M,le=y.lines,ae=[...f.lines,...y.lines],X=ae.map(A=>({label:A.label,default:A.color,current:A.color,clicked:!1})),[W=[],z]=j.useState(X);(X.length!==W.length||W.length===1&&W[0].color!==X[0].color)&&z(X);const q="rgba(120, 119, 120, 0.27)",fe=(A={})=>{const $=X.findIndex(F=>F.label===A.label);z(W.map((F,L)=>({...F,current:L===$||F.clicked?F.default:q})))},Pe=()=>{const A=W.some($=>$.clicked);z(W.map($=>({...$,current:A&&$.clicked||!A?$.default:q})))},Re=(A={})=>{const $=X.findIndex(L=>L.label===A.label),F=W.map((L,Z)=>{const me=Z===$&&!L.clicked;return{...L,current:me||Z!==$&&L.clicked?L.default:q,clicked:Z===$?me:L.clicked}});z(F)},xe={anchor:"top-right",direction:"column",justify:!1,translateX:-10,translateY:10,itemsSpacing:0,itemDirection:"right-to-left",itemWidth:80,itemHeight:20,itemOpacity:1,symbolSize:12,symbolShape:"square",symbolBorderColor:"rgba(0, 0, 0, .9)",itemTextColor:h.textColor},ve=[];if(y.lines.length<1&&M.length>10){const A=[],$=[],F=Math.ceil(M.length/2);M.forEach(({label:L,color:Z},me)=>{const{current:_e}=W.find(ye=>ye.label===L)||{},ee={label:L,color:_e||Z};me<F?A.push(ee):$.push(ee)}),ve.push({...xe,data:A,anchor:"top-left",direction:"column",translateX:10,itemDirection:"left-to-right"},{...xe,data:$})}const Ye=ve.length>0?ve.map(A=>({...A,onMouseEnter:fe,onMouseLeave:Pe,onClick:Re})):[{...xe,onMouseEnter:fe,onMouseLeave:Pe,onClick:Re}],De=v.concat(ne),Ie=zo(o,h,De),Me=A=>A.some($=>(($==null?void 0:$.data)||[]).length),Qe=Yo(v,N)>90?"%Y":"%y/%m";return Me(De)&&n.jsxs("div",{className:"z-10 w-full max-w-mw",children:[i&&m.length>0&&n.jsx(rn,{graphInfo:i,setGraph:u,graphs:m}),n.jsxs("div",{className:"flex flex-wrap justify-between",children:[n.jsx(qe,{type:"line",text:e,items:U}),!s&&le.length>0&&n.jsx(qe,{type:"line",items:le})]}),n.jsx("div",{className:"chart-wrap",children:n.jsx(Ma,{margin:{top:14,right:50,bottom:50,left:50},data:De,colors:W.map(A=>A.current),lineWidth:2,curve:"monotoneX",animate:!1,isInteractive:p,xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:H,max:B},axisBottom:{format:Qe,tickSize:0,tickPadding:10,tickRotation:-45},legends:r?Ye:[],axisLeft:{...!p&&{renderTick:void 0},tickSize:0,tickValues:8},pointLabelYOffset:0,...Ie.length&&{markers:Ie},...ne.length&&{axisRight:{...!p&&{renderTick:void 0},tickSize:0,tickValues:8,format:A=>{const $=Math.round(A*(T/B));return A<0?A:Ho($)}}},enableGridX:!1,enableSlices:"x",sliceTooltip:Qo,theme:h,layers:["grid","markers","areas",_o(ae),"slices","points","axes","legends"]})}),l.length>0&&n.jsx(Do,{data:l,dataKeys:c,tableOpenedByDefault:d})]})},Jo=(e,t)=>{const s=(e==null?void 0:e.date)||"",a=(t==null?void 0:t.date)||"";return new Date(s).getTime()-new Date(a).getTime()},et=e=>(e==null?void 0:e.description)||"",Xo=(e,t)=>{let s;try{s=Ls.lt(et(e),et(t))?-1:1}catch{s=0}return s},Zo=(e=[])=>{const t=e.filter(r=>/^v?\d+\.\d+\.\d+$/.test(et(r))).sort(Xo),s=t.map((r,l)=>{const c=et(r);let i="";try{const d=l>0?et(t[l-1]):"v0.0.0",g=Ls.diff(d,c)||"EMPTY";i={minor:"MINOR",major:"MAJOR",patch:"PATCH",premajor:"PATCH",preminor:"PATCH",prepatch:"PATCH",prerelease:"PATCH",EMPTY:"PATCH"}[g]||"PATCH"}catch{i="PATCH"}const u=/T/.test(r.date)?r.date.split("T")[0]:r.date;return{...r,date:u,releaseType:i||"MAJOR"}}),a=s.length>70?r=>r.releaseType!=="PATCH":()=>!0;return s.filter(a).sort((r,l)=>Jo(r,l))},ke=({usersInfo:e={},releases:t=[],events:s=[]})=>{const a=[];Object.values(e).forEach(({name:c="",userId:i="",dates:u=[]})=>{u.forEach(m=>{const{startDate:d,endDate:g}=m;d&&a.push({date:d,description:c||i,releaseType:"MINOR"}),g&&a.push({date:g,description:c||i,releaseType:"PATCH"})})});const o=s.map(({date:c,name:i}={})=>({date:c,description:i,releaseType:"EVENT"})),r=(c,i)=>{const u=(c==null?void 0:c.date)||"",m=(i==null?void 0:i.date)||"";return new Date(u).getTime()-new Date(m).getTime()};return[...a,...o,...t].sort(r)},xn=(e,t,s=[])=>new Promise((a,o)=>{const[r,...l]=e;Promise.all(r.map(c=>t(c))).then(c=>l&&l.length?xn(l,t,c).then(i=>a(s.concat(i))).catch(o):a(s.concat(c))).catch(o)}),tt=(e=[],t,s=2)=>{const a=Ea(s,e);return e.length?xn(a,t):[]},qt=(e,t="DESC",s="")=>a=>{const o=I("",e,a),r=o&&new Date(o),l=s?new Date(s):new Date;return t==="DESC"?r&&nt(r,l):r&&Ue(r,l)},xt=e=>e?` after:"${e}" `:"",Gt=(e,{oldest:t,newest:s})=>{const a=e==="DESC"?t:s,r=a?` ${e==="DESC"?"after":"before"}:"${a}" `:"",l=r?50:10;return`
    ${e==="DESC"?`last: ${l}`:`first: ${l}`}
    ${r}
  `},Ut=e=>({oldest:t,newest:s})=>xt(e==="DESC"?t:s),ge="pageInfo { endCursor hasNextPage hasPreviousPage startCursor }",Ge=e=>`
    comments(first: ${e?100:10} ${xt(e)}) {
      totalCount
      edges {
        node {
          author {
            login
            url
          }
          publishedAt
          body
        }
      }
      ${ge}
    }
`,vn=e=>t=>`
pullRequests(
  first: 50
  ${Ut(e)(t)}
  states: [MERGED]
  orderBy: {field: CREATED_AT direction: ${e}}
) {
  totalCount
  edges {
    node {
      id
      url
      author {
        login
        url
      }
      repository {
        name
        owner {
          login
        }
      }
      additions
      deletions
      mergedAt
      createdAt
      commits(first:1) {
        edges {
          node {
            commit {
              committedDate
            }
          }
        }
      }
      ${wn(void 0)}
      ${Ge(void 0)}
    }
  }
  ${ge}
}`,yn=e=>t=>`
issues(
  ${Ut(e)(t)}
  first: 50
  orderBy: { field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      title
      url
      createdAt
      closedAt
      state
      labels(first:5) {
        edges {
          node {
            name
          }
        }
      }
    }
  }
  ${ge}
}`,er=e=>t=>`
releases(
  ${Ut(e)(t)}
  first: 50
  orderBy:{ field:CREATED_AT direction: ${e} }
) {
  totalCount
  edges {
    node {
      id
      name
      createdAt
      tag {
        name
      }
    }
  }
  ${ge}
}`,wn=e=>`
    reviews(first: ${e?100:10} ${xt(e)}) {
      edges {
        node {
          id
          state
          author {
            login
            url
          }
          ${Ge(void 0)}
        }
      }
      ${ge}
    }
`,bn=(e={},t="",s={},a)=>o=>{const{hasNextPage:r=!1,startCursor:l,endCursor:c}=I({},["data","result",o,"pageInfo"],s),i=I([],["data","result",o,"edges"],s),u=o==="pullRequests"?"mergedAt":"createdAt",m=se(t)?i.filter(qt(["node",u],a,t)):[],d={pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"},h=I(a==="DESC"?c:l,[d[o],"oldest"],e),f=I(a==="ASC"?c:l,[d[o],"newest"],e),x=m.length,v=ie([[R(r===!1),re],[R(!se(t)),R(r)],[R(x===0),re],[R(x>0&&i.length>x),re],[K,R(r)]])();return{newest:a==="ASC"&&c?c:f,oldest:a==="DESC"&&c?c:h,hasNextPage:r,hasNextPageForDate:v}},tr=(e={},t="",s={},a)=>o=>{const r=o==="usersReviews"?["data","result"]:["data","result",o],{hasNextPage:l=!1,hasPreviousPage:c=!1,startCursor:i,endCursor:u}=I({},[...r,"pageInfo"],s),m=I([],[...r,"edges"],s),d=["pullRequests","usersReviews"].includes(o)?"mergedAt":"createdAt",g=se(t)?m.filter(qt(["node",d],a,t)):[],h={commitComments:"commitCommentsPagination",issueComments:"issueCommentsPagination",usersReviews:"usersReviewsPagination"},p=o==="usersReviews"||a==="ASC"?"right":"left",x=I(p==="right"?u:i,[h[o],"oldest"],e),b=I(p==="right"?i:u,[h[o],"newest"],e),w=p==="right"?l:c,y=g.length,P=ie([[R(w===!1),re],[R(!se(t)),R(w)],[R(y===0),re],[R(y>0&&m.length>y),re],[K,R(w)]])();return{newest:p==="right"&&u?u:b,oldest:p==="left"&&i?i:x,hasNextPage:w,hasNextPageForDate:P}},sr=(e={},t="",s={},a)=>{const{hasNextPage:o=!1,hasPreviousPage:r=!1,startCursor:l,endCursor:c}=I({},["data","result","pageInfo"],s),i=I([],["data","result","edges"],s),u=se(t)?i.filter(qt(["node","mergedAt"],a,t)):[],d=I(a==="DESC"?c:l,["usersReviewsPagination","oldest"],e),h=I(a==="DESC"?l:c,["usersReviewsPagination","newest"],e),p=a==="DESC"?o:r,f=u.length,x=ie([[R(p===!1),re],[R(!se(t)),R(p)],[R(f===0),re],[K,R(p)]])();return{newest:a==="ASC"&&l?l:h,oldest:a==="DESC"&&c?c:d,hasNextPage:p,hasNextPageForDate:x}},zt=e=>{const t=["issues","pullRequests","releases"],[s]=t.map(a=>{var o,r,l;return((l=(r=(o=e==null?void 0:e.data)==null?void 0:o.result)==null?void 0:r[a])==null?void 0:l.totalCount)||0}).sort((a,o)=>o-a);return Math.ceil(s/50)-1},nr=e=>t=>`
    commitComments(
      ${Gt(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          commit {
            repository {
              nameWithOwner
            }
            url
            associatedPullRequests(last: 10) {
              edges {
                node {
                  number
                  url
                }
              }
            }
          }
          body
        }
      }
      ${ge}
    }
`,ar=e=>t=>`
    issueComments(
      ${Gt(e,t)}
    ) {
      edges {
        cursor
        node {
          createdAt
          url
          repository {
            nameWithOwner
          }
          issue {
            number
          }
          pullRequest {
            number
          }
          body
        }
      }
      ${ge}
    }
`,or=e=>({user:t,sortDirection:s="DESC",amountOfData:a,usersReviewsPagination:o={}})=>({query:`{
    result: search(
      query: "type:pr state:closed reviewed-by:${t}"
      type: ISSUE
      ${Gt(s,o)}
    ) {
      issueCount
      ${ge}
      edges {
        node {
          ... on PullRequest {
            id
            number
            url
            author {
              login
              url
            }
            repository {
              name
              owner {
                login
              }
            }
            additions
            deletions
            mergedAt
            createdAt
            ${Ge(void 0)}
            reviews(last: 10 states: [COMMENTED,APPROVED,CHANGES_REQUESTED] author: "${t}") {
              ${ge}
              edges {
                node {
                  id
                  state
                  author {
                    login
                    url
                  }
                  ${Ge(void 0)}
                }
              }
            }
          }
        }
      }
    }
  }`,sortDirection:s,user:t,resultInfo:r=>{const l=sr({usersReviewsPagination:o,amountOfData:a},e,r,s),c=ie([[R(a==="all"),R(a)],[R(se(e)),R(a)],[R(Number.isInteger(a)),R(a-1)],[K,zt]])(r),i={usersReviewsPagination:Object.assign(l,{hasNextPage:!1})},u=se(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:i.usersReviewsPagination[u]===!0,nextPageInfo:{...i,amountOfData:c}}},fillerType:"pullRequests",hasMoreResults:[o.hasNextPage].some(r=>r!==!1)}),Ve=e=>{const{hasNextPageForDate:t}=e;return t!==!1},jn=e=>({user:t,sortDirection:s="DESC",amountOfData:a,issuesPagination:o={},prPagination:r={},commitCommentsPagination:l={},issueCommentsPagination:c={}})=>({query:`{
    result: user(login: "${t}") {
      login
      ${Ve(c)?ar(s)(c):""}
      ${Ve(l)?nr(s)(l):""}
      ${Ve(r)?vn(s)(r):""}
      ${o[e?"hasNextPageForDate":"hasNextPage"]!==!1?yn(s)(o):""}
    }
  }`,sortDirection:s,user:t,resultInfo:i=>{const u=bn({issuesPagination:o,prPagination:r,amountOfData:a},e,i,s),m=tr({commitCommentsPagination:l,issueCommentsPagination:c,amountOfData:a},e,i,s),d=ie([[R(a==="all"),R(a)],[R(se(e)),R(a)],[R(Number.isInteger(a)),R(a-1)],[K,zt]])(i);Object.assign(u("pullRequests"),{hasNextPage:!1});const g={prPagination:Object.assign(u("pullRequests"),{hasNextPage:!1}),issuesPagination:Object.assign(u("issues"),{hasNextPage:!1}),commitCommentsPagination:Object.assign(m("commitComments"),{hasNextPage:!1}),issueCommentsPagination:Object.assign(m("issueComments"),{hasNextPage:!1})},h=se(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(g).some(f=>f[h]===!0),nextPageInfo:{...g,amountOfData:d}}},hasMoreResults:[r.hasNextPage,o.hasNextPage,l.hasNextPage,c.hasNextPage].some(i=>i!==!1)}),Nn=e=>({org:t,repo:s,sortDirection:a="DESC",amountOfData:o,issuesPagination:r={},releasesPagination:l={},prPagination:c={}})=>({query:`{
      result: repository(name: "${s}" owner: "${t}") {
        id
        description
        name
        owner {
          org: login
        }
        ${Ve(c)?vn(a)(c):""}
        ${Ve(r)?yn(a)(r):""}
        ${Ve(l)?er(a)(l):""}
      }
    }`,sortDirection:a,resultInfo:i=>{const u=bn({issuesPagination:r,releasesPagination:l,prPagination:c},e,i,a),m=ie([[R(o==="all"),R(o)],[R(se(e)),R(o)],[R(Number.isInteger(o)),R(o-1)],[K,zt]])(i),d={prPagination:Object.assign({hasNextPage:!1},u("pullRequests")),issuesPagination:Object.assign({hasNextPage:!1},u("issues")),releasesPagination:Object.assign({hasNextPage:!1},u("releases"))},g=se(e)?"hasNextPageForDate":"hasNextPage";return{hasNextPage:Object.values(d).some(p=>p[g]===!0),nextPageInfo:{...d,amountOfData:m}}},fillerType:"batchedQuery",hasMoreResults:[c.hasNextPage,r.hasNextPage,l.hasNextPage].some(i=>i!==!1)}),rr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.comments)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.comments)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:""}),lr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequest {
            id
            ${wn(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.reviews)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.reviews)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.reviews)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:"pullRequestReviewComments"}),cr=({nodeId:e,cursor:t})=>({query:`{
      node(id:"${e}") {
          ... on PullRequestReview {
            id
            ${Ge(t)}
          }
        }
    }`,resultInfo:s=>{var a,o,r,l,c,i,u,m,d,g,h,p,f;return{rawData:s,results:((r=(o=(a=s==null?void 0:s.data)==null?void 0:a.node)==null?void 0:o.comments)==null?void 0:r.edges)||[],hasNextPage:((u=(i=(c=(l=s==null?void 0:s.data)==null?void 0:l.node)==null?void 0:c.comments)==null?void 0:i.pageInfo)==null?void 0:u.hasNextPage)||!1,nextArgs:{nodeId:((d=(m=s==null?void 0:s.data)==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((f=(p=(h=(g=s==null?void 0:s.data)==null?void 0:g.node)==null?void 0:h.comments)==null?void 0:p.pageInfo)==null?void 0:f.endCursor)||""}}},fillerType:""}),ir=({org:e,orgPagination:t={}})=>({query:`{
    organization(login: "${e}") {
      repositories(
        first:100
        ${xt(t==null?void 0:t.cursor)}
        orderBy: {field: NAME, direction: ASC}
      ) {
        edges {
          node {
            name
          }
          cursor
        }
        pageInfo {
          endCursor
          hasNextPage
        }
      }
    }
  }`,fillerType:"org",resultInfo:s=>{var r,l,c,i,u,m,d,g,h,p,f,x,v,b,w;const a=((i=(c=(l=(r=s==null?void 0:s.data)==null?void 0:r.organization)==null?void 0:l.repositories)==null?void 0:c.pageInfo)==null?void 0:i.hasNextPage)||!1,o=((g=(d=(m=(u=s==null?void 0:s.data)==null?void 0:u.organization)==null?void 0:m.repositories)==null?void 0:d.pageInfo)==null?void 0:g.endCursor)||"";return{rawData:s,results:((f=(p=(h=s==null?void 0:s.data)==null?void 0:h.organization)==null?void 0:p.repositories)==null?void 0:f.edges)||[],hasNextPage:((w=(b=(v=(x=s==null?void 0:s.data)==null?void 0:x.organization)==null?void 0:v.repositories)==null?void 0:b.pageInfo)==null?void 0:w.hasNextPage)||!1,nextPageInfo:{orgPagination:{cursor:o,hasNextPage:a,hasNextPageForDate:a},amountOfData:"all"}}}}),dr=({org:e,team:t})=>({query:`{
    organization(login: "${e}") {
      team(slug:"${t}") {
        members(
          first:100
        ) {
          edges {
            node {
              name
              email
              login
              createdAt
            }
          }
          pageInfo {
            endCursor
            hasNextPage
          }
        }
      }
    }
  }`,fillerType:"team",resultInfo:s=>{var a,o,r,l,c;return{results:((c=(l=(r=(o=(a=s[0])==null?void 0:a.data)==null?void 0:o.organization)==null?void 0:r.team)==null?void 0:l.members)==null?void 0:c.edges)||[],hasNextPage:!1}}}),mr=(e,t)=>{const a={org:["data","organization","repositories","edges"],team:["data","organization","team","members","edges"]}[e];return a?I([],a,t):t},ur=e=>{const t=u=>{const d={pullRequests:[i,l],pullRequestReviewComments:[r],batchedQuery:[i,l]}[u]||[];return g=>d.length?Promise.all(d.map(h=>h(g))).then(h=>h.reduce((p,f)=>f(p),g)):mr(u,g)},s=u=>m=>async(d=[])=>{const{hasNextPage:g}=m,{query:h,resultInfo:p,fillerType:f}=u(m),x=g?await e(h):{},{results:v=[],hasNextPage:b,nextArgs:w}=p(x),y=[...d,...v];return b&&f?s(u)(w)(y):await t(f)(y)},a=u=>m=>d=>{const g=Object.assign(u.node,{[m]:d});return Object.assign(u,{node:g})},o=u=>m=>{var d,g,h,p,f,x,v;return{nodeId:((d=m==null?void 0:m.node)==null?void 0:d.id)||"",cursor:((p=(h=(g=m==null?void 0:m.node)==null?void 0:g[u])==null?void 0:h.pageInfo)==null?void 0:p.endCursor)||"",hasNextPage:((v=(x=(f=m==null?void 0:m.node)==null?void 0:f[u])==null?void 0:x.pageInfo)==null?void 0:v.hasNextPage)||!1}},r=async(u=[])=>{const d=await tt(u,async g=>{var x,v;const h=((v=(x=g==null?void 0:g.node)==null?void 0:x.comments)==null?void 0:v.edges)||[],p=o("comments")(g),f=await s(cr)(p)(h);return a(g)("comments")({edges:f})},5);return()=>d},l=async u=>{var h,p,f;const m=((f=(p=(h=u==null?void 0:u.data)==null?void 0:h.result)==null?void 0:p.pullRequests)==null?void 0:f.edges)||[],g=await tt(m,async x=>{var y,P,N;const v=((P=(y=x==null?void 0:x.node)==null?void 0:y.reviews)==null?void 0:P.edges)||[],b=o("reviews")(x),w=await s(lr)(b)(v);return{nodeId:(N=x==null?void 0:x.node)==null?void 0:N.id,results:{edges:w}}},5);return x=>{const v=c(x)("reviews")(g);return{data:Object.assign((x==null?void 0:x.data)||{},{result:Object.assign(I({pullRequests:v},["data","result"],x))})}}},c=u=>m=>d=>{var f,x,v,b,w;const g=((x=(f=u==null?void 0:u.data)==null?void 0:f.result)==null?void 0:x.pullRequests)||{},p=(((w=(b=(v=u==null?void 0:u.data)==null?void 0:v.result)==null?void 0:b.pullRequests)==null?void 0:w.edges)||[]).map(y=>{var T;const P=((T=y==null?void 0:y.node)==null?void 0:T.id)||"",N=d.find(S=>S.nodeId===P);return N?a(y)(m)(N.results):y});return Object.assign(g,{edges:p})},i=async u=>{var h,p,f;const m=((f=(p=(h=u==null?void 0:u.data)==null?void 0:h.result)==null?void 0:p.pullRequests)==null?void 0:f.edges)||[],g=await tt(m,async x=>{var y,P,N;const v=((P=(y=x==null?void 0:x.node)==null?void 0:y.comments)==null?void 0:P.edges)||[],b=o("comments")(x),w=await s(rr)(b)(v);return{nodeId:((N=x==null?void 0:x.node)==null?void 0:N.id)||"",results:{edges:w}}},5);return x=>{var b;const v=c(x)("comments")(g);return{data:Object.assign((x==null?void 0:x.data)||{},{result:Object.assign(((b=x==null?void 0:x.data)==null?void 0:b.result)||{pullRequests:v})})}}};return t},hr=e=>new Promise((t,s)=>{e.json().then(a=>e.status===200?t(a):s(Object.assign(a,{status:e.status}))).catch(a=>{console.log("-=-=--parseJSON error",a),a.status=e.status,s(a)})}),fs=({message:e=""})=>/(You have triggered an abuse detection mechanism|You have exceeded a secondary rate limit)/.test(e),gr=({message:e=""})=>/Unexpected end of JSON input/.test(e),pr=e=>t=>fetch(e.enterpriseAPI||"https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({query:t})}).then(hr),fr=(e,{amountOfData:t})=>ie([[R(e===!1),re],[R(e&&typeof t=="number"&&t>=1),K],[R(e&&t==="all"),K],[K,re]])(),xr=(e=3e4)=>new Promise(t=>setTimeout(()=>t(),e));let xs=0;const vr=async(e,t)=>(console.log("-=-=--paused",Date.now()),await xr(),console.log("-=-=--resume",Date.now()),++xs,xs<=10?pe(e,t):{errorMessage:{level:"error",message:"Hit rate limit over ten times"},fetchInfo:e.fetchInfo,results:t,reviewResults:[]}),Pt=(e,t)=>t.reduce((a,o)=>{var l,c,i;const r=((i=(c=(l=o==null?void 0:o.data)==null?void 0:l.result)==null?void 0:c[e])==null?void 0:i.edges)||[];return a+r.length},0),yr=e=>(t,s=[])=>{var u,m,d,g;const o=I(!1,[{pullRequests:"prPagination",issues:"issuesPagination",releases:"releasesPagination"}[t],"hasNextPageForDate"],e),r=s[s.length-1]||{},l=((d=(m=(u=r==null?void 0:r.data)==null?void 0:u.result)==null?void 0:m[t])==null?void 0:d.edges)||[],c=l[l.length-1],i=t==="pullRequests"?"createdAt":"closedAt";return o&&((g=c==null?void 0:c.node)==null?void 0:g[i])||""},pe=async({fetchInfo:e,queryInfo:t},s=[])=>{const{query:a,resultInfo:o,fillerType:r,user:l,sortDirection:c}=t(e),i=yr(e),[u]=[i("pullRequests",s),i("issues",s),i("releases",s)].filter(Boolean).sort(Oo(c)),m={prCount:Pt("pullRequests",s),issueCount:Pt("issues",s),releasesCount:Pt("releases",s),latestItemDate:u,user:l,repo:e.repo,repos:e.repos||[],paused:!1};console.log("-=-=--statusPayload",m),k.setState({fetchStatus:m});const d=pr(e);try{const g=await d(a);if(fs(g))throw new Error("Abuse rate triggered");const h=await ur(d)(r)(g),p=[...s,h],{hasNextPage:f,nextPageInfo:x={}}=o(g),v=$a(e,x);return fr(f,v)?pe({fetchInfo:v,queryInfo:t},p):{fetchInfo:v,results:p,reviewResults:[]}}catch(g){const h=g,p=ie([[fs,K],[gr,K],[v=>v.status===500,K],[v=>v.status===502,K],[v=>v.message==="Abuse rate triggered",K],[we(rt(/ENOTFOUND|ECONNRESET/),Oe("","code")),K],[we(rt(/fetch/i),Oe("","message")),K],[K,re]]),x=ie([[p,R({level:"warn",message:"You may have triggered the api's abuse detection, please wait a minute before trying again"})],[we(rt(/50\d/i),Oe("","status")),R({level:"error",message:"GitHub API 500 error, could be CORS or rate limiting"})],[v=>v.status===401,R({level:"error",message:"GitHub token does not have correct settings, please see README"})],[we(rt(/40\d/i),Oe("","status")),v=>({level:"error",message:`Auth error: ${v.message||"UNKOWN"}`})],[v=>v.status===void 0,R({level:"error",message:"Error while processing data after, please check the console"})],[K,v=>({level:"error",message:`ERROR: ${v.message||"UNKOWN"}`})]])(h);if(p(h))return k.setState({fetchStatus:{...m,paused:!0}}),vr({fetchInfo:e,queryInfo:t},s);throw new Error(x.message)}},wr=async({fetchInfo:e,untilDate:t})=>{try{const a=e.userIds.map(c=>({fetchInfo:{...e,issuesPagination:e.issuesPagination[c]||{hasNextPage:!0},prPagination:e.prPagination[c]||{hasNextPage:!0},user:c},queryInfo:jn(t)})),o=await tt(a,pe,1),r=[];return o.forEach(({fetchInfo:c,results:i})=>{r.push(i);const u=(c==null?void 0:c.user)||"";c.issuesPagination[u]=c==null?void 0:c.issuesPagination,c.prPagination[u]=c==null?void 0:c.prPagination}),{fetchInfo:e,results:r.flat()}}catch(s){throw console.log("-=-=--getUsersData:error",s),s}},br=async({fetchInfo:e,untilDate:t})=>{var s,a,o,r;try{const[l]=e.userIds||[],i={fetchInfo:{...e,issuesPagination:(e==null?void 0:e.issuesPagination[l])||{hasNextPage:!0},prPagination:(e==null?void 0:e.prPagination[l])||{hasNextPage:!0},user:l},queryInfo:jn(t)},u=await pe(i),m=u.results,d={fetchInfo:{...e,usersReviewsPagination:((s=e.usersReviewsPagination)==null?void 0:s[l])||{hasNextPage:!0},user:l},queryInfo:or(t)},g=await pe(d),h=g.results,p={issuesPagination:{[l]:(a=u.fetchInfo)==null?void 0:a.issuesPagination},prPagination:{[l]:(o=u.fetchInfo)==null?void 0:o.prPagination},usersReviewsPagination:{[l]:((r=g.fetchInfo)==null?void 0:r.usersReviewsPagination)||{hasNextPage:!0}}};return{fetchInfo:{...e,...p},results:m.flat(),reviewResults:h.flat()}}catch(l){throw console.log("-=-=--getUserData:error",l),l}},jr=async({fetchInfo:e,untilDate:t})=>{try{const s=await pe({fetchInfo:e,queryInfo:ir}),o=((s==null?void 0:s.results.flat())||[]).filter(m=>{var d;return(d=m==null?void 0:m.node)==null?void 0:d.name}).map(m=>{var d;return(d=m==null?void 0:m.node)==null?void 0:d.name}),r=e.org,l=o.map(m=>({fetchInfo:{...e,issuesPagination:(e==null?void 0:e.issuesPagination[m])||{hasNextPage:!0},prPagination:(e==null?void 0:e.prPagination[m])||{hasNextPage:!0},org:r,repo:m,repos:o},queryInfo:Nn(t)})),c=await tt(l,pe,1),i=[];return c.forEach(({fetchInfo:m,results:d=[]})=>{i.push(d);const{repo:g,issuesPagination:h,releasesPagination:p,prPagination:f}=m;m.issuesPagination[g]=h,m.releasesPagination[g]=p,m.prPagination[g]=f}),{fetchInfo:e,results:i.flat(),reviewResults:[]}}catch(s){throw console.log("-=-=--getOrgData:error",s),s}},Nr=(e,t=[])=>{var r;const s=e==="DESC"?0:-1,a=t.at(s),o=((r=a==null?void 0:a.node)==null?void 0:r.mergedAt)||(a==null?void 0:a.mergedAt);return new Date(o)},Pr=(e,t=[])=>{const{untilDate:s="",amountOfData:a=0,sortDirection:o="DESC"}=e,r={months:a},l=we(Vs(String),jt("amountOfData")),c=we(d=>!(typeof d=="string"&&d.length>1),jt("untilDate")),i=we(d=>Ct(d,r),d=>d?new Date(d):new Date,jt("untilDate")),u=we(({prDate:d,sortDirection:g})=>g==="DESC"?Ct(d,r):At(d,r),d=>({prDate:Nr(d,t),sortDirection:d}),Oe("","sortDirection")),[,m]=[[l(e),""],[c(e)&&t.length>0,u(e)],[o==="DESC",i(e)],[o==="ASC",At(new Date(s),r)],[!0,""]].find(([d])=>d)||["",""];return m},Rr=e=>t=>{const s={};return t.forEach(a=>{const o=Oa(e,a);s[o]=(s[o]||0)+1}),s},Pn=Rr(["node","author","login"]),Dr=e=>{const t={};return e.forEach(({author:s="",score:a=0})=>{t[s]=(t[s]||0)+a}),t},vs=(e=[])=>{const t=new Ba,s=e.map(a=>{var l,c,i;const o=((l=a==null?void 0:a.node)==null?void 0:l.body)||"";return{author:((i=(c=a==null?void 0:a.node)==null?void 0:c.author)==null?void 0:i.login)||"",score:t.analyze(o).score}});return{sentimentScore:$t("score")(s),sentiments:Dr(s)}},Sr=e=>{var a,o;const t=((o=(a=e==null?void 0:e.node)==null?void 0:a.reviews)==null?void 0:o.edges)||[],s=[];return t.forEach(r=>{var c,i;const l=((i=(c=r==null?void 0:r.node)==null?void 0:c.comments)==null?void 0:i.edges)||[];s.push(...l)}),s},Rn=e=>t=>{var s,a;return e.includes((a=(s=t==null?void 0:t.node)==null?void 0:s.author)==null?void 0:a.login)},Cr=e=>t=>{var o,r;const s=!Rn(e)(t);return!/\/apps\//.test(((r=(o=t==null?void 0:t.node)==null?void 0:o.author)==null?void 0:r.url)||"")&&s},Rt=(e,t,s)=>{var p,f;const a=(f=(p=s==null?void 0:s.node)==null?void 0:p.author)==null?void 0:f.login,o=I([],["node","comments","edges"],s),r=Sr(s),c={general:o,code:r,all:[...r,...o]}[e]||[],i=c.filter(Cr([...t,a])),{sentimentScore:u=0,sentiments:m={}}=vs(i),d=c.filter(Rn([a])),{sentimentScore:g=0}=vs(d),h=e==="all"?"c":`${e}C`;return{[`${h}omments`]:i.length,[`${h}ommenters`]:Pn(i),[`${h}ommentSentimentScore`]:u,[`${h}ommentSentiments`]:m,[`${h}ommentsAuthor`]:d.length,[`${h}ommentAuthorSentimentScore`]:g,[`${h}ommentSentimentTotalScore`]:(g||0)+(u||0)}},Ar=(e,t)=>{const s=Rt("general",e,t),a=Rt("code",e,t),o=Rt("all",e,t);return{...s,...a,...o}},Tr=e=>{var o,r;const s=(((r=(o=e==null?void 0:e.node)==null?void 0:o.reviews)==null?void 0:r.edges)||[]).filter(l=>{var c;return((c=l==null?void 0:l.node)==null?void 0:c.state)==="APPROVED"}),a=Pn(s);return{approvals:s.length,approvers:a}},kr=(e=[],t)=>{var v,b,w,y,P,N;const s=I("",["node","repository","owner","login"],t),a=I("",["node","repository","name"],t),o=I("",["node","author","login"],t),r=I("",["node","author","url"],t),l=I("",["node","url"],t),c=I(0,["node","additions"],t),i=I(0,["node","deletions"],t),u=I("",["node","createdAt"],t),m=I("",["node","mergedAt"],t),d=((N=(P=(y=(w=(b=(v=t==null?void 0:t.node)==null?void 0:v.commits)==null?void 0:b.edges)==null?void 0:w[0])==null?void 0:y.node)==null?void 0:P.commit)==null?void 0:N.committedDate)||"",g=Ue(new Date(d),new Date(u))?d:u,h=Ar(e,t),{approvals:p,approvers:f}=Tr(t);return{repo:a,org:s,author:/\/apps\//.test(r)?"GIT_APP_PR":o,url:l,additions:c,deletions:i,prSize:c+i,mergedAt:m,cycleTime:he(new Date(m),new Date(g))||1,age:he(new Date(m),new Date(u))||1,approvals:p,approvers:f,...h}},Dn=(e,t)=>(s,a)=>{const o=s[e],r=a[e];return t==="DESC"?new Date(r).getTime()-new Date(o).getTime():new Date(o).getTime()-new Date(r).getTime()},ys=(e,t=[])=>{const{excludeIds:s=[]}=e;return t.map(o=>{var r,l,c,i,u;return((c=(l=(r=o==null?void 0:o.data)==null?void 0:r.result)==null?void 0:l.pullRequests)==null?void 0:c.edges)||((u=(i=o==null?void 0:o.data)==null?void 0:i.result)==null?void 0:u.edges)}).flat().map(o=>kr(s,o))},Ir=(e="")=>({startDate:t="",endDate:s=""}={})=>{const a=new Date(e),o=t?nt(a,new Date(t))||Ke(a,new Date(t)):!0,r=s?Ue(a,new Date(s))||Ke(a,new Date(s)):!0;return o&&r},Mr=(e,t=[])=>{const s=e.usersInfo||{};return t.filter(o=>{const r=o.author,{dates:l=[]}=s[r]||{},c=Ir(o.mergedAt);return l.length>0?l.some(c):!0})},ws=({excludeIds:e=[]},{reportStartDate:t="",reportEndDate:s=""},a=[])=>{const o=[];return[a.filter(l=>{const c=Oe("","author",l),i=["GIT_APP_PR",...e].some(h=>h===c),u=l.mergedAt,m=Ke(new Date(u),new Date(t))||Ke(new Date(u),new Date(s)),d=nt(new Date(u),new Date(t))&&Ue(new Date(u),new Date(s)),g=(m||d)&&!i;return!g&&o.push(l),g}).sort(Dn("mergedAt","ASC")),o]},Sn=e=>({reportStartDate:t="",reportEndDate:s=""},a=[])=>{const o=[];return[a.filter(l=>{const c=l==null?void 0:l[e],i=Ke(new Date(c),new Date(t))||Ke(new Date(c),new Date(s)),u=nt(new Date(c),new Date(t))&&Ue(new Date(c),new Date(s)),m=i||u;return!m&&o.push(l),m}).sort(Dn(e,"ASC")),o]},Er=Sn("mergedAt"),$r=Sn("date"),Or=e=>{var l,c,i,u,m,d;const t=((l=e==null?void 0:e.node)==null?void 0:l.createdAt)||"",s=((c=e==null?void 0:e.node)==null?void 0:c.closedAt)||"",a=((i=e==null?void 0:e.node)==null?void 0:i.title)||"",o=((u=e==null?void 0:e.node)==null?void 0:u.url)||"",r=((d=(m=e==null?void 0:e.node)==null?void 0:m.labels)==null?void 0:d.edges)||[];return{mergedAt:t,createdAt:t,age:he(new Date(s),new Date(t))||1,url:o,isBug:/bug/i.test(a)||r.some(g=>{var h;return/bug/i.test((h=g==null?void 0:g.node)==null?void 0:h.name)})}},Br=(e=[])=>{const t=e.map(r=>{var l,c,i;return((i=(c=(l=r==null?void 0:r.data)==null?void 0:l.result)==null?void 0:c.issues)==null?void 0:i.edges)||[]});return Ks(t).filter(Boolean).map(r=>Or(r))},Fr=e=>{var a,o,r;const t=((a=e==null?void 0:e.node)==null?void 0:a.createdAt)||"",s=((r=(o=e==null?void 0:e.node)==null?void 0:o.tag)==null?void 0:r.name)||"";return{date:t,description:s}},Lr=(e=[])=>{const t=e.map(r=>{var l,c,i;return((i=(c=(l=r==null?void 0:r.data)==null?void 0:l.result)==null?void 0:c.releases)==null?void 0:i.edges)||[]});return Ks(t).filter(Boolean).map(r=>Fr(r))},Cn=e=>typeof e=="string"&&e.length&&e||/^-?[\d.]+$/.test(`${e}`)&&/^-?[^0]/.test(`${e}`)&&e||Array.isArray(e)&&e.length&&Vr(e)||e&&Object.keys(e).length&&An(e)||typeof e=="boolean"&&e,Vr=e=>{const t=[];return e.forEach(s=>{const a=Cn(s);a&&t.push(a)}),t.length&&t},An=e=>{const t={};return Object.entries(e).forEach(([s,a])=>{const o=Cn(a);o&&(t[s]=o)}),Object.keys(t).length&&t},mt={author:"",approvalsGiven:0,approvalsByUser:{},commentsGiven:0,commentsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,totalPRs:0,uniquePRsContributedTo:0,commentsByUser:{},prSizes:[],prTotalAdditions:0,prTotalDeletions:0,prAdditions:[],prDeletions:[],prAges:[],sentimentTotalScores:[],orgs:new Set,repos:new Set,sentimentTotalPositiveScore:0,sentimentAveragePositiveScore:0,sentimentPositiveCount:0,sentimentTotalNegativeScore:0,sentimentNegativeCount:0,sentimentAverageNegativeScore:0},Ze=(e,t,s,a)=>{const o={};return Object.entries(s).forEach(([r,l])=>{const c=e[r]||{},i={...mt,...c,user:r,[t]:(c[t]||0)+(a||l)};o[r]=i}),o},bs=(e,t,s,a,o,r)=>{const l={};return Object.entries(s).filter(([c])=>r&&a!==r?c===r:!0).forEach(([c,i])=>{const u=e[c]||{},m=u[t]||{},d={...m,[a]:(m[a]||0)+(o||i||0)},g={...mt,...u,author:c,[t]:d};l[c]=g}),l},vt=(e=[],t={},s="")=>{const a=new Set,o={};e.forEach(i=>{var _e;const{org:u,repo:m,author:d,additions:g=0,deletions:h=0,age:p=0,approvals:f=0,approvers:x={},comments:v=0,commenters:b={},codeComments:w=0,codeCommenters:y={},generalComments:P=0,generalCommenters:N={},commentSentimentTotalScore:T=0,commentSentimentScore:S=0,commentAuthorSentimentScore:B=0}=i;a.add(d);const H=bs(o,"commentsByUser",b,d,0,s);Object.assign(o,H);const ne=bs(o,"approvalsByUser",x,d,1,s);Object.assign(o,ne);const M=Ze(o,"commentsGiven",b);Object.assign(o,M);const U=Ze(o,"codeCommentsGiven",y);Object.assign(o,U);const le=Ze(o,"generalCommentsGiven",N);Object.assign(o,le);const ae=Ze(o,"approvalsGiven",x);Object.assign(o,ae);const X=Ze(o,"uniquePRsApproved",x,1);Object.assign(o,X),[...new Set([...Object.keys(y),...Object.keys(N),...Object.keys(x)])].forEach(ee=>{const ye=o[ee]||{},da={...mt,...ye,author:ee,uniquePRsContributedTo:(ye.uniquePRsContributedTo||0)+1};o[ee]=da}),o[d]||(o[d]={...mt}),o[d].orgs.add(u),o[d].repos.add(m);const z=T||S+B;o[d].sentimentTotalScores.push(z);const q=(ee="",ye=0)=>(o[d][ee]||0)+ye,fe=q("totalPRs",1),Pe=q("prTotalAge",p),Re=Math.round(Pe/fe),xe=q("prTotalAdditions",g),ve=q("prTotalDeletions",h),Ye=Math.round((xe+ve)/fe),De=z>0?z:0,Ie=z>0?1:0,Me=q("sentimentTotalPositiveScore",De),Ee=q("sentimentPositiveCount",Ie),Qe=Ee?Math.round(Me/Ee):0,A=z<0?z:0,$=z<0?1:0,F=q("sentimentNegativeCount",$),L=q("sentimentTotalNegativeScore",A),Z=F?Math.round(L/F):0,me={author:d,name:((_e=t[d])==null?void 0:_e.name)||d,user:d,totalPRs:fe,age:Re,prTotalAge:Pe,prSize:Ye,prTotalAdditions:xe,prTotalDeletions:ve,approvalsReceived:q("approvalsReceived",f),commentsReceived:q("commentsReceived",v),codeCommentsReceived:q("codeCommentsReceived",w),generalCommentsReceived:q("generalCommentsReceived",P),commentSentimentTotalScore:q("commentSentimentTotalScore",z),sentimentPositiveCount:Ee,sentimentTotalPositiveScore:Me,sentimentAveragePositiveScore:Qe,sentimentNegativeCount:F,sentimentTotalNegativeScore:L,sentimentAverageNegativeScore:Z,orgCount:o[d].orgs.size,repoCount:o[d].repos.size};Object.assign(o[d],me)});const r=Object.values(o).filter(({author:i})=>a.has(i)).map((i={})=>qs(["author","user","name","approvalsGiven","approvalsByUser","uniquePRsApproved","commentsGiven","commentsReceived","codeCommentsGiven","codeCommentsReceived","generalCommentsGiven","generalCommentsReceived","totalPRs","uniquePRsContributedTo","commentsByUser","prTotalAdditions","prTotalDeletions","orgCount","repoCount","user","approvalsReceived","prSize","prTotalAge","age","sentimentAveragePositiveScore","sentimentTotalPositiveScore","sentimentAverageNegativeScore","sentimentTotalNegativeScore"],i)),l=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"];return r.filter(({author:i})=>Object.keys(t).length>0?t[i]:!0).sort(Ne(l))},js=Gs(Va(","),Fa(La),Us(Boolean)),Kr=e=>{const{org:t="",repo:s="",token:a="",userIds:o=[]}=e,r=[a];t&&r.push(t),s&&r.push(s);const l=r.every(m=>typeof m=="string"&&m.length>0),i=(o.length?[o]:[]).every(m=>m.length>0);if(!(l&&i))throw new Error("Not a valid request")},qr=(e="",t="")=>(s="mergedAt",a=[])=>{const o=[],r=[],l=[],c=(i=[])=>i.forEach(u=>{const m=new Date(u[s]);Ue(m,new Date(e))?o.push(u):nt(m,new Date(t))?l.push(u):r.push(u)});return a.forEach(c),[o,r,l]},Tn=(e=[])=>{const{mergedAt:t=""}=e.at(0)||{mergedAt:""},{mergedAt:s=""}=e.at(-1)||{mergedAt:""};return[t,s]},kn=async e=>{var t,s,a,o,r,l;try{Kr(e),Mn();const{filteredPRs:c=[],pullRequests:i=[],filteredReviewedPRs:u=[],reviewedPullRequests:m=[],issues:d=[],filteredIssues:g=[],releases:h=[],filteredReleases:p=[]}=D.getState(),f=Pr(e,i),{usersInfo:x,reportType:v,sortDirection:b="DESC",userIds:w=[]}=e,y=f,P={user:async()=>br({fetchInfo:e,untilDate:y}),team:async()=>wr({fetchInfo:e,untilDate:y}),repo:async()=>pe({fetchInfo:e,queryInfo:Nn(y)}),org:async()=>jr({fetchInfo:e,untilDate:y})},{fetchInfo:N,results:T=[],reviewResults:S=[]}=await P[v](),B=ys(e,T),H=Mr(e,B),ne=i.concat(c).concat(H),M=(s=(t=i.at(-1))==null?void 0:t.mergedAt)==null?void 0:s.slice(0,10),U=(o=(a=i.at(0))==null?void 0:a.mergedAt)==null?void 0:o.slice(0,10),le=(l=(r=B.at(-1))==null?void 0:r.mergedAt)==null?void 0:l.slice(0,10),ae=new Date().toISOString().slice(0,10),X=b==="DESC"?{reportStartDate:y||le,reportEndDate:M||ae}:{reportStartDate:U,reportEndDate:y||ae},[W,z]=ws(e,X,ne),fe=ys(e,S).filter(({author:L="",mergedAt:Z=""})=>Z&&L!==w[0]),Pe=m.concat(u).concat(fe),[Re=[],xe=[]]=ws(e,X,Pe),ve=Tn(W),Ye=Lr(T),De=Zo([...p,...h,...Ye]),[Ie,Me]=$r(X,De),Ee=Br(T),Qe=d.concat(g).concat(Ee),[A,$]=Er(X,Qe),F=(L={})=>{const Z=qs(["newest","oldest"]),me={};return Object.entries(L).filter(([,ee])=>Vs(Object,ee)&&Ka(Z(ee)).length>0).forEach(([ee,ye])=>{me[ee]=Z(ye)}),{...Z(L),...me}};D.setState(L=>({...L,pullRequests:W,filteredPRs:z,reviewedPullRequests:Re,filteredReviewedPRs:xe,itemsDateRange:ve,usersData:vt(W.concat(Re),x),releases:Ie,filteredReleases:Me,issues:A,filteredIssues:$})),k.setState(L=>({...L,...N,reportType:v,fetching:!1,fetchStatus:{},prPagination:F(N.prPagination),usersReviewsPagination:F(N.usersReviewsPagination),releasesPagination:F(N.releasesPagination),issuesPagination:F(N.issuesPagination)}))}catch(c){const i=c;En({level:"error",message:(i==null?void 0:i.message)||"Unknown error"})}},Gr=e=>new Promise((t,s)=>{e.json().then(a=>e.status===200?t(a):s(new Error(`Error status code ${e.status}`))).catch(a=>{const o=a;console.log("-=-=--parseJSON error",o),o.status=e.status,s(o)})}),Ot=async({fileName:e="",externalURL:t="",localData:s})=>{In(),Mn({fetchStatus:{savedReportName:e}});try{if(s)return Ps(s);const a=t?`${t}${e}.json`:`https://n07734.github.io/community-health/data/${e}.json`,o=await fetch(a).then(Gr);Ps(o)}catch(a){const o=a;console.log("-=-=--api data error",o,o.status);const r=o.status!==200?`Error status code ${o.status} loading ${e}`:`${o.message} loading ${e}`;En({level:"error",message:r||"Unknown error"})}},Ur=()=>{const e=D.getState(),t=k.getState(),s={...e,fetches:t},{repo:a,org:o,teamName:r,userIds:l=[]}=(s==null?void 0:s.fetches)||{},c=(l==null?void 0:l.length)===1?l[0]:"",i=r||c||`${o}${a?`-${a}`:""}`,m=Gs(as("HOW_TO","1: Add this file to ./src/myReports 2: Run the app. If you want multiple reports you will need to edit ./src/myReports/myReportsConfig.js."),qa(["fetches","pullRequests","filteredPRs","reviewedPullRequests","filteredReviewedPRs","userData","issues","filteredIssues","releases","teamName","chartConfig"]),$e(["fetches","token"]),$e(["fetches","sortDirection"]),$e(["fetches","amountOfData"]),$e(["fetches","prPagination","hasNextPage"]),$e(["fetches","issuesPagination","hasNextPage"]),$e(["fetches","releasesPagination","hasNextPage"]),as("preFetchedName",i),An)(s),d=JSON.stringify(m,null,2),g=new Blob([d],{type:"application/json"});return{href:URL.createObjectURL(g),download:`${i}.json`}},zr=[{graphId:1,left:[{label:"*Trimmed Average PR Age (days)",color:E[2],dataKey:"age",groupMath:"trimmedAverage"}],right:[{label:"*Trimmed Average PR Size",color:E[0],dataKey:"prSize",groupMath:"trimmedAverage"}]}],Ht={fetching:!1,error:{level:"",message:""},fetchStatus:{},preFetchedError:{level:"",message:""},usersInfo:{},events:[],repo:"",org:"",teamName:"",excludeIds:[],token:"",sortDirection:"ASC",amountOfData:"all",enterpriseAPI:"",reportType:"repo",userIds:[],formUntilDate:"",prPagination:{},usersReviewsPagination:{},releasesPagination:{},issuesPagination:{}},Wt={reportDescription:"",pullRequests:[],reviewedPullRequests:[],issues:[],releases:[],usersData:[],filteredPRs:[],filteredReviewedPRs:[],filteredReleases:[],filteredIssues:[],trimmedItems:{trimmedPRs:{trimmedLeftPrs:[],trimmedRightPrs:[]},trimmedReviewedPRs:{trimmedLeftReviewedPrs:[],trimmedRightReviewedPrs:[]},trimmedReleases:{trimmedLeftReleases:[],trimmedRightReleases:[]},trimmedIssues:{trimmedLeftIssues:[],trimmedRightIssues:[]}},preFetchedName:"",chartConfig:zr,itemsDateRange:["",""]},D=zs(()=>Wt),k=zs(()=>Ht),Ns=(e="",t="")=>{console.log("trimItems",e,t);const{trimmedItems:{trimmedPRs:{trimmedLeftPrs:s=[],trimmedRightPrs:a=[]}={},trimmedReviewedPRs:{trimmedLeftReviewedPrs:o=[],trimmedRightReviewedPrs:r=[]}={},trimmedReleases:{trimmedLeftReleases:l=[],trimmedRightReleases:c=[]}={},trimmedIssues:{trimmedLeftIssues:i=[],trimmedRightIssues:u=[]}={}}={},pullRequests:m=[],reviewedPullRequests:d=[],releases:g=[],issues:h=[]}=D.getState(),{usersInfo:p}=k.getState(),f=qr(e,t),x=[s,m,a],[v,b,w]=f("mergedAt",x),y=[o,d,r],[P,N,T]=f("mergedAt",y),S=[l,g,c],[B,H,ne]=f("date",S),M=[i,h,u],[U,le,ae]=f("mergedAt",M);D.setState({pullRequests:b,reviewedPullRequests:N,usersData:vt(b.concat(N),p),releases:H,issues:le,trimmedItems:{trimmedPRs:{trimmedLeftPrs:v,trimmedRightPrs:w},trimmedReviewedPRs:{trimmedLeftReviewedPrs:P,trimmedRightReviewedPrs:T},trimmedReleases:{trimmedLeftReleases:B,trimmedRightReleases:ne},trimmedIssues:{trimmedLeftIssues:U,trimmedRightIssues:ae}}})},In=()=>{D.setState(Wt),k.setState(Ht)},lt=e=>D.setState({chartConfig:e}),Mn=(e={})=>k.setState({fetching:!0,error:{level:"",message:""},...e}),En=e=>k.setState({fetching:!1,error:e}),$n=e=>{const{token:t,sortDirection:s,amountOfData:a,excludeIds:o,events:r,reportType:l,enterpriseAPI:c}=e,u=js(r).map((d="")=>{const[g="",h=""]=d.split("=");return{name:g.trim(),date:h.trim()}});return{reportType:l,...l==="repo"&&{repo:e.repo,org:e.org},...l==="org"&&{org:e.org},...l==="user"&&{[e.userId]:{userId:e.userId,name:e.name}},...l==="team"&&{teamName:e.teamName,usersInfo:e.usersInfo,userIds:Object.keys(e.usersInfo)},sortDirection:s,amountOfData:a,token:t,excludeIds:js(o)||[],events:u,enterpriseAPI:c}},Hr=e=>{const{teamName:t="",userIds:s=[],repo:a="",org:o=""}=e;return t&&"team"||s.length===1&&"user"||!a&&o&&"org"||"repo"},Ps=e=>{const{usersData:t=[],fetches:{usersInfo:s={}},pullRequests:a=[],reviewedPullRequests:o=[]}=e,r=Tn(a),l={...e,fetching:!1,itemsDateRange:r,usersData:t.length?t:vt(a.concat(o),s)};l.fetches={},D.setState(()=>({...Wt,...l}));const c=Hr(e.fetches);k.setState(()=>({...Ht,...e.fetches,reportType:c}))},Wr=(e=[],t=[])=>s=>{const a=u=>{const m=u.dataKey;return["isBug","isFeature"].includes(m)?t.filter(({isBug:h=!1})=>h&&m==="isBug"||!h&&m==="isFeature"):e},{left:o=[],right:r=[]}=s,l={lines:o.map(u=>({...u,data:a(u)})),xAxis:"left"},c={lines:r.map(u=>({...u,data:a(u)})),xAxis:"right"};return[...o.length>0?[l]:[],...r.length>0?[c]:[]]},Yr=e=>{const t=[...(e==null?void 0:e.left)||[],...(e==null?void 0:e.right)||[]].map(a=>a.dataKey);return t.length>0?[...t,"author"]:["comments","approvals","age","prSize","author"]};let Qr=1;const _r=()=>++Qr,Jr=(e=[])=>{const t=[];return e.forEach(({left:s=[],right:a=[]})=>{s.forEach(o=>(o==null?void 0:o.groupMath)&&t.push(o.groupMath)),a.forEach(o=>(o==null?void 0:o.groupMath)&&t.push(o.groupMath))}),t},Xr=(e=[])=>Jr(e).includes("trimmedAverage"),yt=({chunkyData:e=[],pullRequests:t=[],tableOpenedByDefault:s=!1})=>{const a=D(d=>d.issues),o=D(_(d=>d.releases)),r=D(d=>d.chartConfig),l=k(d=>d.usersInfo),c=k(d=>d.events),i=ke({events:c,releases:o,usersInfo:l}),u=Xr(r),m=Wr(t,a);return t.length>0&&n.jsxs(J,{children:[n.jsxs(de,{title:"Your graphs",expandText:"guidance",children:[n.jsx("p",{children:"You can build multiple graphs with data you want to see to help you find insights and track trends."}),n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"What metrics do you want to look and and compare against?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"}),n.jsx("li",{children:"This graph initially had PR age and size as they are often impactful metrics, what do you think about the trends of these metrics?"})]})]}),n.jsxs(je,{children:[r.map((d,g)=>{var p,f;const h=m(d);return((p=d==null?void 0:d.left)==null?void 0:p.length)<1&&((f=d==null?void 0:d.right)==null?void 0:f.length)<1?n.jsx(rn,{graphInfo:d,setGraph:lt,graphs:r},g):n.jsx(Q,{graphInfo:d,setGraph:lt,graphs:r,blockHeading:!0,markers:i,showLegends:!1,data:h,tableKeys:Yr(d),tableData:e,tableOpenedByDefault:g===0&&s},g)}),u&&n.jsx("p",{children:"*Trimmed average is the average after the top and bottom 5% is trimmed."})]}),n.jsxs("div",{className:"flex flex-nowrap basis-full justify-center gap-x-3 mb-08",children:[r.length>1&&n.jsx(O,{variant:"secondary",onClick:d=>{d.preventDefault(),lt(r.slice(0,-1))},children:"Remove above graph"}),n.jsx(O,{onClick:d=>{d.preventDefault(),lt([...r,{graphId:_r(),left:[],right:[]}])},children:"Add another custom graph"})]})]})},On=(e,t)=>t.some(s=>e.some(a=>a[s])),ut=({data:e=[],bars:t=[],sortBy:s="",indexBy:a="user",max:o=20,title:r=""})=>{const{theme:l}=G(),c=ot(l),{showNumbers:i}=at(),u=Us(p=>t.some(f=>p[f.dataKey]),e),m=p=>(f,x)=>+((f[p]||0)<(x[p]||0))||+((f[p]||0)===(x[p]||0))-1,d=s?u.sort(m(s)):u,g=o?d.slice(0,o):d,h=t.map(p=>p.dataKey);return On(e,h)&&n.jsxs("div",{className:"flex flex-col justify-between w-full max-w-mw mb-4",children:[n.jsx(qe,{text:r,items:t}),n.jsx("div",{className:"chart-wrap",children:n.jsx(Ga,{data:g,keys:h,indexBy:a,margin:{top:5,right:50,bottom:60,left:50},padding:.3,groupMode:"grouped",layout:"vertical",valueFormat:p=>`${p}`,colors:t.map(p=>p.color),axisBottom:{tickSize:0,tickRotation:-45},axisLeft:{...!i&&{renderTick:void 0},tickSize:0},isInteractive:i,enableLabel:!1,animate:!1,theme:c})})]})},Zr=(e,t,s=!1)=>{const a={},o={};e.forEach(d=>{const g=d.author,h=d[t]||{},p=Tt(Object.values(h));a[g]=p,o[g]=d.name||g});const r=Object.entries(a).sort(([,d],[,g])=>g-d),l=Tt(Object.values(a)),c=d=>{const g=100/l;return d*g},i=[];r.forEach(([d,g])=>{const h=c(g);g>0&&h>5&&i.push(d)});const u=i.length===e.length-1?r.map(([d])=>d):i,m=s?e.filter(d=>u.includes(d.author)).map(d=>d.author):u;return[m,m.map(d=>o[d]||d)]},el=(e=[],t)=>{const s=Object.entries(t).filter(([o])=>!e.some(r=>r===o));return Tt(s.map(o=>o[1]))},tl=(e=[],t,s=[],a=!1)=>{const o=c=>[...s.map(i=>{var u;return((u=c==null?void 0:c[t])==null?void 0:u[i])||0}),...a?[el(s,c[t])]:[]],r=s.map(c=>{const i=e.find(u=>u.author===c);return o(i)});let l=[];return e.forEach(c=>{if(!s.some(i=>i===c.author)){const u=o(c).map((m,d)=>m+(l[d]||0));l=[...u.slice(0,u.length-1),0]}}),[...r,...l.length?[l]:[]]},sl=({data:e,dataKey:t,preSorted:s,showNames:a=!0})=>{const[o,r]=Zr(e,t,s),l=r.length<e.length,c=tl(e,t,o,l),i=[...r,...l?["Others"]:[]];return{names:a?i:i.map((u,m)=>`Spartacus${Array(m).fill(" ").join("")}`),matrix:c}},ht=({title:e,data:t=[],preSorted:s=!1,dataKey:a})=>{const{theme:o}=G(),r=ot(o),{showNumbers:l}=at(),{showNames:c}=be(),{names:i,matrix:u}=sl({data:t,dataKey:a,preSorted:s,showNames:c});return(d=>d.some(g=>g.some(Boolean)))(u)&&n.jsxs("div",{children:[n.jsx(qe,{text:e,className:"text-center"}),n.jsx("div",{className:"chord-wrap",children:n.jsx(Ua,{label:"id",data:u,keys:i,margin:{top:0,right:10,bottom:10,left:10},arcBorderColor:{from:"color",modifiers:[["darker",.4]]},ribbonOpacity:.5,ribbonBorderWidth:.5,ribbonBorderColor:{from:"color",modifiers:[["darker",.4]]},innerRadiusRatio:.85,labelRotation:0,padAngle:.06,innerRadiusOffset:.03,labelOffset:-23,labelTextColor:{from:"color",modifiers:[["darker",2]]},colors:E,isInteractive:l,activeArcOpacity:1,inactiveArcOpacity:1,activeRibbonOpacity:.75,inactiveRibbonOpacity:.25,animate:!1,motionConfig:"stiff",theme:r})})]})},Bn=({title:e="",data:t=[]})=>{const{theme:s}=G(),a=ot(s),{showNumbers:o}=at();return t.length&&n.jsxs("div",{className:"z-10 w-full max-w-mw",children:[n.jsx("div",{className:"flex flex-wrap justify-between",children:n.jsx(qe,{type:"line",text:e})}),n.jsx("div",{className:"pie-wrap",children:n.jsx(za,{data:t,colors:{datum:"data.color"},margin:{top:15,right:80,bottom:0,left:80},animate:!1,innerRadius:.65,padAngle:1,cornerRadius:4,activeOuterRadiusOffset:5,borderWidth:1,startAngle:-90,endAngle:90,enableArcLabels:!1,arcLinkLabelsSkipAngle:4,arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLinkLabelsDiagonalLength:10,arcLinkLabelsStraightLength:15,arcLinkLabelsTextColor:a.textColor,theme:a,isInteractive:o})})]})},Yt=({pullRequests:e=[],chunkyData:t=[],allRepos:s={}})=>{var N,T;const a=D(S=>S.usersData),o=D(S=>S.releases),{userIds:r=[],usersInfo:l={},events:c=[]}=k(_(S=>S)),{theme:i}=G(),u=V[i].secondary,m=V[i].primary,{showNames:d}=be(),g=ke({events:c,releases:o,usersInfo:l}),h=r.length||15,p=["commentsGiven","approvalsGiven"],f=a.sort(Ne(p)),x=f.map((S,B)=>{var H;return{commentsGiven:S.commentsGiven,commentsReceived:S.commentsReceived,uniquePRsApproved:S.uniquePRsApproved,totalPRs:S.totalPRs,author:d?S.author:`${Array(B).fill(" ").join("")}Spartacus`,name:d?((H=l[S.author])==null?void 0:H.name)||S.author:`${Array(B).fill(" ").join("")}Spartacus`}}),v=f.map(S=>{var B;return{...S,name:((B=l[S.author])==null?void 0:B.name)||S.author}}),b=fn("repo",s),w=pn({pullRequests:e,showNames:d,usersInfo:l}),y=v.filter(S=>S.approvalsGiven>0).length,P=v.filter(S=>S.commentsGiven>0).length;return a.length>0&&n.jsxs(J,{children:[n.jsxs(de,{title:"Contributions",expandText:"guidance*",children:[n.jsx("p",{children:"*Received comments can also come from out of team so can be higher."}),n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"Is there a bus factor risk?"}),n.jsx("li",{children:"Are there any data points that stand out?"}),n.jsx("li",{children:"How do the given and received metrics look?"}),n.jsx("li",{children:"How well spread are the collaboration metrics?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),n.jsxs(je,{children:[n.jsxs("div",{className:"grid grid-cols-2 w-full max-mm:grid-cols-1",children:[n.jsx(ut,{data:x,indexBy:"name",title:"Comments",sortBy:"commentsGiven",max:h,bars:[{dataKey:"commentsGiven",color:u,label:"given"},{dataKey:"commentsReceived",color:m,label:"*received"}]}),n.jsx(ut,{data:x,indexBy:"name",title:"PRs",sortBy:"uniquePRsApproved",max:h,bars:[{dataKey:"uniquePRsApproved",color:u,label:"approved"},{dataKey:"totalPRs",color:m,label:"opened"}]})]}),(P>0||y>0)&&n.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[P>0&&n.jsx(ht,{data:v,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),y>0&&n.jsx(ht,{data:v,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),n.jsx("p",{children:"These chord charts show how contributions are given and received, the dominant colour indicates more contribution"}),w.length>0&&((T=(N=w==null?void 0:w[0])==null?void 0:N.lines)==null?void 0:T.length)<21&&n.jsx(Q,{title:"PRs by author",markers:g,showLegends:!0,data:w,tableData:t,tableKeys:["author","repo"]}),b.pieData.length>0&&n.jsx(Bn,{data:b.pieData,title:b.sectionTitle})]})]})},Fn=j.forwardRef(({className:e,...t},s)=>n.jsx(Hs,{className:C("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:s,children:n.jsx(Ha,{className:C("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Fn.displayName=Hs.displayName;const nl={warn:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),error:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 fill-current",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})})},Qt=({error:{level:e="error",message:t},className:s})=>{const a=e==="error"?"bg-error":"bg-warn";return n.jsxs("div",{className:`${a} p-3 flex items-center rounded-sm ${s}`,children:[e&&nl[e],n.jsx("p",{className:"m-0 ml-2 p-0",children:t})]})},al=(e,t)=>[e&&"fetching",t.length&&"Get more data","Get data"].find(Boolean),Ln=({qaId:e=""})=>{const t=D(o=>o.pullRequests),{fetching:s=!1,error:a}=k(o=>o);return n.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2",children:[n.jsx(O,{className:"m-0 w-full col-span-full",type:"submit",disabled:s,color:"primary","data-qa-id":e,children:al(s,t)}),(a==null?void 0:a.message)&&n.jsx(Qt,{error:a,className:"col-span-full"})]})},Vn=e=>{const{setValue:t,amountOfData:s,className:a=""}=e,o=D(i=>i.preFetchedName),r=D(i=>i.pullRequests),l=!o&&r.length>0,c=i=>`Get ${i} ${i===1?"month":"months"} ${l?"more ":""}data`;return n.jsxs(Be,{onValueChange:i=>t("amountOfData",i==="all"?i:Number(i)),value:`${s}`,children:[n.jsx(Ce,{className:`w-auto ${a}`,children:n.jsx(Le,{children:s==="all"?"Get it all!":c(Number(s))})}),n.jsx(Ae,{children:n.jsxs(Fe,{children:[n.jsx(te,{value:"1",children:c(1)}),n.jsx(te,{value:"3",children:c(3)}),n.jsx(te,{value:"6",children:c(6)}),n.jsx(te,{value:"12",children:c(12)}),n.jsx(te,{value:"24",children:c(24)}),n.jsx(te,{value:"all",children:"Get it all!"})]})})]})},Kn=j.forwardRef(({className:e,type:t,...s},a)=>n.jsx("input",{type:t,"data-qa-id":`input-${t}`,className:C("flex mt-8 h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground  focus:border-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring  disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));Kn.displayName="Input";const qn={org:"Organization",repo:"Repository",team:"Team name (from GitHub Org team url)",gitTeamUrl:"Org's team url",token:"Token",excludeIds:"Exclude GitHub users e.g. remove bot PRs and comments, ',' separated",enterpriseAPI:"Enterprise API full url",userIds:"Comma separated list GitHub users",userId:"GitHub user ID",startDate:"Joined yyyy/mm/dd",endDate:"Left yyyy/mm/dd",events:"Comma separated list of events (optional)",teamName:"Team name",name:"Name"},ol=({dates:e=[]})=>{const t=e.every(({startDate:r="",endDate:l=""})=>{const c=!r||kt(new Date(r)),i=!l||kt(new Date(l));return c&&i}),s=[];e.forEach(({startDate:r="",endDate:l=""})=>{r&&s.push(r),l&&s.push(l)});const a=Ya((r,l)=>new Date(r).getTime()-new Date(l).getTime(),s),o=ue(s,a);return t&&o},rl=(e={})=>{const t=Object.values(e).every(s=>ol(s));return Object.keys(e).length>0&&t},Rs=(e="")=>!e||/^\d{4}[/-]\d{2}[/-]\d{2}$/.test(e)&&kt(new Date(e)),Gn=({key:e,value:t})=>ie([[ue("gitTeamUrl"),R(/^(https:\/\/.+\..+$)/.test(t))],[ue("enterpriseAPI"),R(/^(https:\/\/.+\..+|^$)/.test(t))],[ue("excludeIds"),R(/^([\w-.,\s]+|)$/.test(t))],[ue("events"),R(/^([\w-.,&\s=]+|)$/.test(t))],[ue("name"),R(/.?/.test(t))],[ue("usersInfo"),()=>rl(t)],[ue("startDate"),()=>Rs(t)],[ue("endDate"),()=>Rs(t)],[K,R(/^[\w-_.]+$/.test(t))]])(e),ll=e=>t=>{const s=e[t];return!Gn({key:t,value:s})},Un=e=>{const t=ll(e),s={};return Object.keys(e).forEach(o=>{s[o]=t(o)}),{isValid:Object.values(s).every(o=>!o),validationErrors:s}},Bt=(e,t)=>{const s=e[t],a=typeof s=="object"?"":s;return Array.isArray(s)?Wa(", ",s):a},Y=e=>{const{type:t,className:s="",inputError:a={},setInputError:o=()=>{},formInfo:r={},setValue:l}=e,c=a[t]?"border-red-500":"";return n.jsxs(st,{children:[n.jsx("p",{className:"mb-1 block",children:qn[t]}),n.jsx(Kn,{className:`${s} m-0 w-full ${c}`,value:Bt(r,t),type:t,onBlur:i=>{const u=I("",["target","value"],i),m=Gn({key:t,value:u});o({...a,[t]:!m}),m&&l(t,u)},onChange:i=>{const u=I("",["target","value"],i);o({...a,[t]:!1}),l(t,u)},onFocus:()=>o({...a,[t]:!1})}),n.jsx("p",{className:"text-red-500 text-xs",children:a[t]&&"Invalid input"})]})},zn=Ys,cl=Qs,Hn=Ws,_t=j.forwardRef(({className:e,...t},s)=>n.jsx(gt,{ref:s,className:C("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));_t.displayName=gt.displayName;const Wn=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Hn,{children:[n.jsx(_t,{}),n.jsxs(ze,{ref:a,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,n.jsxs(Vt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[n.jsx("path",{d:"M18 6 6 18"}),n.jsx("path",{d:"m6 6 12 12"})]}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Wn.displayName=ze.displayName;const Yn=j.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Hn,{children:[n.jsx(_t,{}),n.jsx(ze,{ref:a,className:C("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:t})]}));Yn.displayName=ze.displayName;const We=j.forwardRef(({className:e,...t},s)=>n.jsx(pt,{ref:s,className:C("text-lg font-semibold leading-none tracking-tight",e),...t}));We.displayName=pt.displayName;const il=j.forwardRef(({className:e,...t},s)=>n.jsx(ft,{ref:s,className:C("text-sm text-muted-foreground",e),...t}));il.displayName=ft.displayName;const dl=({onSubmit:e=()=>{},gitUsers:t=[],usersInfo:s={}})=>{const a=Object.entries(s).map(([v,{name:b="",dates:w=[]}])=>({userId:v,name:b,dates:w})),o=a.length>0?a:[{userId:"",name:"",dates:[]}],[r,l]=j.useState(o),c=v=>(b,w)=>{const y=[...r];y[v][b]=w,l(y)},i=(v,b)=>(w,y)=>{const P=[...r];P[v].dates[b][w]=y,l(P)},u=v=>{v.preventDefault();const b={};r.forEach(({userId:w,name:y,dates:P})=>{b[w]={userId:w,name:y,dates:P}}),e(b)},m=v=>{v.preventDefault(),l([...r,{userId:"",name:"",dates:[]}])},d=(v,b)=>{b.preventDefault();const w=[...r];w.splice(v,1),l(w)},g=(v,b)=>{b.preventDefault();const w=[...r],y={startDate:"",endDate:""};w[v].dates.push(y),l(w)},h=({userIndex:v,dateIndex:b})=>{const w=[...r],P=w[v].dates.filter((N,T)=>T!==b);w[v].dates=P,l(w)},[p,f]=j.useState({}),x=t.length>0&&"Edit Github Team members"||Object.keys(s).length>0&&"Edit team members"||"Or manually add team members";return n.jsxs("form",{children:[n.jsx("h4",{children:x}),r.map((v,b)=>n.jsxs("div",{className:"grid grid-cols-1 gap-2 max-mm:grid-cols-2 mb-8",children:[n.jsx(Y,{type:"userId",formInfo:v,inputError:p,setInputError:f,setValue:c(b)}),n.jsx(Y,{type:"name",formInfo:v,setValue:c(b),inputError:p,setInputError:f}),v.dates.map((w,y)=>n.jsxs("div",{className:"flex items-stretch gap-2 justify-between col-span-full",children:[n.jsx(Y,{type:"startDate",formInfo:w,inputError:p,setInputError:f,setValue:i(b,y)}),n.jsx(Y,{type:"endDate",inputError:p,formInfo:w,setInputError:f,setValue:i(b,y)}),n.jsx("svg",{onClick:()=>h({userIndex:b,dateIndex:y}),className:"w-6 fill-current min-h-12 rounded-sm bg-destructive test-[#CCC] px-0 py-2 h-auto",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"DeleteIcon",children:n.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})})]},y)),n.jsx(O,{className:"min-h-12 m-0",color:"primary",onClick:w=>g(b,w),children:`Add ${v.dates.length>0?"more dates":"dates"}`}),n.jsx(O,{className:"bg-destructive text=[#CCC] min-h-12 m-0",onClick:w=>d(b,w),children:"Remove User"})]},b)),n.jsx(O,{className:"mr-0 w-full min-h-12",color:"primary",onClick:v=>m(v),children:"Create new user"}),n.jsx(O,{className:"mr-0 w-full min-h-12",color:"primary",onClick:v=>u(v),children:"Save and close"})]})},ml=async({fetchInfo:e,setGitUsers:t,setInputError:s})=>{try{const{results:a=[]}=await pe({fetchInfo:e,queryInfo:dr}),o=[];a.flat().forEach(({node:r})=>{const{name:l,email:c,login:i}=r,u=l?l.replace(",",""):c.split(".")[0];o.push({userId:i,name:u})}),t(o)}catch(a){const o=a;s({level:"error",message:`Api call error: ${(o==null?void 0:o.message)||"unknown"}`})}},ul=e=>{var u;const{setGitUsers:t}=e,[s,a]=j.useState({}),o={gitTeamUrl:"",token:""},[r,l]=j.useState(o),i={inputError:s,setInputError:a,formInfo:r,setValue:(m,d)=>l({...r,[m]:d})};return n.jsxs("form",{onSubmit:m=>{m.preventDefault();const{gitTeamUrl:d="",token:g=""}=r,h=d.split("/"),p=h.at(-2)||"",f=h.at(-2)||"";[p,f,g].every(v=>v&&v.length>0)?ml({fetchInfo:{name:p,org:f,token:g},setGitUsers:t,setInputError:a}):a({level:"error",message:"Invalid inputs"})},children:[n.jsx("h4",{children:"Getting team members from a GitHub Org team page"}),n.jsx(Y,{type:"gitTeamUrl",...i},"gitTeamUrl"),n.jsx(Y,{type:"token",...i}),n.jsx(O,{className:"w-full mr-0 min-h-12",type:"submit",children:"Get team members"}),((u=s==null?void 0:s.message)==null?void 0:u.length)>0&&n.jsx(Qt,{error:s})]})},Qn=({setParentValues:e,usersInfo:t={}})=>{const[s,a]=j.useState(!1),[o,r]=j.useState([]),l=o.length>0&&"Edit Github Team members"||Object.keys(t).length>0&&"Edit team members"||"Fill in team by:";return n.jsxs("div",{children:[n.jsxs("p",{className:"mb-1",children:["Team members: ",Object.values(t).map(({name:c,userId:i})=>c||i).join(", ")||"None"]}),n.jsxs(zn,{open:s,onOpenChange:a,children:[n.jsx(cl,{asChild:!0,children:n.jsx(O,{className:"w-full",type:"button",children:Object.keys(t).length===0?"Add team members":"Edit team members"})}),n.jsxs(Wn,{className:"overflow-scroll max-h-full w-4/5",children:[n.jsx(We,{children:l}),Object.keys(t).length===0&&n.jsx(ul,{setGitUsers:r}),n.jsx(dl,{gitUsers:o,usersInfo:t,onSubmit:c=>{const i=Object.keys(c).filter(Boolean).length>0;e(i?{usersInfo:c}:{usersInfo:{}}),a(!1)}})]})]})]})},_n=()=>{const e=D(a=>a.pullRequests),t=k(a=>a.fetching),s=Ur();return!t&&e.length>0?n.jsx("p",{children:n.jsx("a",{className:"text-primary",...s,children:"Download report data"})}):null},hl=()=>{const e=k(M=>M),{repo:t="",org:s="",fetching:a=!1,excludeIds:o=[],events:r=[],usersInfo:l={},token:c="",amountOfData:i="all",enterpriseAPI:u="",reportType:m}=e,d="ASC",g=r.map(({name:M,date:U})=>`${M}=${U}`).join(", "),h=o.join(", "),p={repo:{reportType:"repo",org:s,repo:t},org:{reportType:"org",org:s},team:{reportType:"team",usersInfo:l,teamName:""},user:{reportType:"user",userId:s,name:""}},[f,x]=j.useState({sortDirection:d,amountOfData:i,token:c,excludeIds:h,enterpriseAPI:u,events:g,...p[m]}),[v,b]=j.useState({}),[w,y]=j.useState(!1),P=(M,U)=>x({...f,[M]:U}),N=(M={})=>{const U={...f,...M};x(U)},T={inputError:v,setInputError:b,formInfo:f,setValue:P},S=M=>{M.preventDefault();const{isValid:U,validationErrors:le}=Un(f);if(b(le),U&&!a){const ae=$n(f);kn({...e,...ae}),y(!0)}},ne=[...{repo:["org","repo"],org:["org"],team:["teamName"],user:["userId","name"]}[m],"enterpriseAPI"];return n.jsx(de,{className:"mb-0 col-span-full",title:"",expandText:"here",intro:"Top up this report's data",expandQaId:"expand-prefetch-form",children:n.jsxs("div",{className:"mb-3",children:[n.jsxs("form",{onSubmit:S,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end mb-4",children:[n.jsxs("div",{className:"col-span-full",children:[ne.filter(M=>Bt(e,M)).map(M=>n.jsxs("p",{children:[qn[M],": ",n.jsx("b",{children:Bt(e,M)})]},M)),m==="team"&&n.jsx(Qn,{usersInfo:l,setParentValues:N})]}),n.jsx(Y,{type:"events",className:"col-span-full",...T}),n.jsx("p",{className:"col-span-full",children:"Key events can impact the data e.g. starting or launching a new feature or major version. These events can help give more context while viewing the data. e.g. ProjectA=2013-12-01."}),n.jsx(Y,{type:"excludeIds",...T}),n.jsx(Y,{type:"token",...T}),n.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",n.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]}),n.jsxs(Be,{onValueChange:M=>P("sortDirection",M),value:f.sortDirection,children:[n.jsx(Ce,{className:"w-auto",children:n.jsx(Le,{children:f.sortDirection==="DESC"?"Prepend data":"Append data"})}),n.jsx(Ae,{children:n.jsxs(Fe,{children:[n.jsx(te,{value:"DESC",children:"Prepend data"}),n.jsx(te,{value:"ASC",children:"Append data"})]})})]}),n.jsx(Vn,{setValue:P,amountOfData:f.amountOfData})]}),n.jsx(Ln,{qaId:"prefetch-top-up"})]}),w&&n.jsx(_n,{})]})})},gl=()=>{const e=D(l=>l.pullRequests),t=D(l=>l.issues),s=k(l=>l.usersInfo),a=Object.keys(s).length,o=a>1?`by ${a} contributors`:"",r=t.length>0?`and ${t.length} issues`:"";return e.length>0&&n.jsx(n.Fragment,{children:n.jsxs("p",{className:"w-full",children:[n.jsxs("b",{children:["Showing ",e.length," PRs ",o," ",r]}),". Drag the points to change the date range of the report."]})})},Jn=j.forwardRef(({className:e,...t},s)=>n.jsxs(_s,{ref:s,className:C("relative flex w-full touch-none select-none items-center",e),...t,children:[n.jsx(Qa,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:n.jsx(_a,{className:"absolute h-full bg-primary"})}),n.jsx(os,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}),n.jsx(os,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Jn.displayName=_s.displayName;let Se=[];const Dt=({startDate:e,endDate:t,left:s,right:a})=>{const o=he(new Date(t),new Date(e)),r=o/100,l=Math.floor(r*s),c=Math.ceil(r*a),i=e?rs(At(new Date(e),{days:l}),{representation:"date"}):"",u=t?rs(Ct(new Date(t),{days:o-c}),{representation:"date"}):"";return[i,u]},pl=()=>{const e=D(_(d=>d.itemsDateRange)),[t,s]=e,[[a,o],r]=j.useState([0,100]),[l,c]=Dt({startDate:t,endDate:s,left:a,right:o}),i=d=>{Se=d,Array.isArray(d)&&d.length===2&&r(d)},u=d=>{const[g,h]=Se.length?Se:d,[p,f]=Dt({startDate:t,endDate:s,left:g,right:h});Se=[],Ns(p,f)},m=()=>{if(!Se.length)return;const[d,g]=Se,[h,p]=Dt({startDate:t,endDate:s,left:d,right:g});Se=[],Ns(h,p)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"w-full flex justify-between",children:[n.jsx("p",{className:"text-2xl mb-1",children:St(new Date(l),"do MMM yy")}),n.jsx("p",{className:"text-2xl mb-1",children:St(new Date(c),"do MMM yy")})]}),n.jsx(Jn,{value:[a,o],onValueChange:i,onValueCommit:u,className:"pb-08",onLostPointerCapture:m})]})},fl=e=>{const{repo:t="",org:s="",teamName:a="",usersInfo:o={},userIds:r=[],colorA:l="",colorB:c=""}=e,{userId:i="",name:u=""}=o[r[0]]||{},m=s||a||u||i,d=!a&&u&&i||t&&s!==t&&t||"",g=d?l:c;return n.jsxs(n.Fragment,{children:[n.jsx("span",{style:{color:g},children:m}),d&&n.jsxs(n.Fragment,{children:["/",n.jsx("span",{style:{color:c},children:d})]})]})},wt=()=>{const e=D(_(f=>f.preFetchedName)),t=D(_(f=>f.reportDescription)),s=D(f=>f.pullRequests),a=D(f=>f.issues),{repo:o,org:r,teamName:l,usersInfo:c,userIds:i=[]}=k(_(f=>f)),{theme:u}=G(),m=V[u].secondary,d=V[u].primary,{showNames:g,toggleShowNames:h}=be();return(s.length>0||a.length>0)&&n.jsxs(J,{children:[n.jsx("h2",{"data-qa-id":"report-title",className:"truncate",children:n.jsx(fl,{repo:o,org:r,teamName:l,usersInfo:c,userIds:i,colorA:m,colorB:d})}),t&&n.jsx("p",{children:t}),i&&i.length>1&&n.jsxs("p",{children:["Team's GitHub IDs: ",i.join(", ")]}),n.jsxs("div",{className:"flex items-center space-x-2 pb-08",children:[n.jsx(Fn,{id:"spartacus-mode",onCheckedChange:h,checked:!g,name:"checkedA",className:"dark:data-[state=unchecked]:bg-white"}),n.jsx(st,{htmlFor:"spartacus-mode",children:g?"Who is Spartacus?":"Spartacus mode can help look for trends."})]}),n.jsx(gl,{}),n.jsx(pl,{}),e.length>0&&n.jsx(hl,{})]})},Xn=({chunkyData:e=[],pullRequests:t=[]})=>{const s=D(_(p=>p.releases)),a=k(p=>p.userIds),o=k(p=>p.usersInfo),r=k(p=>p.events),{theme:l}=G(),c=V[l].secondary,i=V[l].primary,u=V[l].tertiary,{showNames:m}=be(),d=a.length>0,g=d?pn({pullRequests:t,showNames:m,usersInfo:o}):[],h=ke({events:r,releases:s,usersInfo:o});return t.length>0&&n.jsxs(J,{children:[n.jsx(de,{title:"Pull Request trends",children:s.length>1&&n.jsx("div",{children:n.jsx("p",{children:"Vertical lines are releases: Green is a Major release, solid purple is Minor and dotted purple is Patch or Alpha"})})}),n.jsxs(je,{children:[d&&n.jsx(n.Fragment,{children:n.jsx(Q,{title:"PRs by author",markers:h,showLegends:!0,data:g,tableData:e,tableKeys:["author","repo"]})}),n.jsx(Q,{markers:h,data:[{lines:[{label:"PRs over time",color:c,dataKey:"url",groupMath:"count",data:t}],xAxis:"left"}],tableData:e,tableKeys:["author"]}),n.jsx(Q,{markers:h,data:[{lines:[{label:"Comments",color:c,dataKey:"comments",data:t},{label:"Approvals",color:i,dataKey:"approvals",data:t}],xAxis:"left"},{lines:[{label:"PR Size",color:u,dataKey:"prSize",data:t}],xAxis:"right"}],tableData:e,tableKeys:["comments","approvals","prSize","author"]}),n.jsx(Q,{markers:h,data:[{lines:[{label:"Age (days)",color:i,dataKey:"age",data:t}],xAxis:"left"},{lines:[{label:"PR Size",color:u,dataKey:"prSize",data:t}],xAxis:"right"}],tableData:e,tableKeys:["age","prSize","author"]})]})]})},xl=()=>{const e=D(a=>a.pullRequests),t={};e.forEach(a=>{t[a.repo]=(t[a.repo]||0)+1});const s=Te(e);return n.jsxs(n.Fragment,{children:[n.jsx(wt,{}),n.jsx(Yt,{pullRequests:e,chunkyData:s,allRepos:t}),n.jsx(yt,{pullRequests:e,chunkyData:s,tableOpenedByDefault:!0}),n.jsx(Xn,{pullRequests:e,chunkyData:s})]})},vl=(e=[])=>e.map(t=>({mergedAt:t.mergedAt,...t.isBug?{bug:1}:{issue:1}})),Jt=()=>{const e=D(_(g=>g.releases)),t=D(g=>g.issues),s=k(g=>g.usersInfo),a=k(g=>g.events),{theme:o}=G(),r=V[o].secondary,l=V[o].primary,c=vl(t),i=Te(t),u=ke({events:a,releases:e,usersInfo:s}),m=[],d=[];return c.forEach(g=>{g.issue&&m.push(g),g.bug&&d.push(g)}),c&&c.length>0&&n.jsxs(J,{children:[n.jsx(de,{title:"Feature and bug trends"}),n.jsx(je,{children:n.jsx(Q,{markers:u,data:[{lines:[{label:"Issues",color:r,dataKey:"issue",groupMath:"count",data:m},{label:"Bugs*",color:l,dataKey:"bug",groupMath:"count",data:d}],xAxis:"left"}],tableKeys:["isBug"],tableData:i})}),n.jsx("p",{className:"w-full text-center",children:"*Bugs in this graph are issues that have a title or a label that contains the word 'bug'"})]})},yl=({chunkyData:e=[],pullRequests:t=[]})=>{const s=D(_(_(m=>m.releases))),{userIds:a=[],usersInfo:o={},events:r=[]}=k(_(m=>m)),{showNames:l}=be(),c=ke({events:r,releases:s,usersInfo:o}),i={};t.forEach(m=>{const d=m.author;i[d]||(i[d]=[]),i[d].push(m)});const u=a.map((m,d)=>{const g=l?m:`Spartacus${Array(d).fill(" ").join("")}`;return[{label:`To ${g}`,color:E[d%E.length],dataKey:"commentSentimentScore",data:i[m]},{label:`From ${g}`,color:E[d%E.length],dataKey:"commentAuthorSentimentScore",data:i[m]}]}).flat();return t.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{children:[n.jsx(de,{title:"Sentiment analysis*",children:n.jsxs("div",{children:[n.jsx("p",{children:"*Adding this is an experiment to see if it can provide useful insights."}),n.jsxs("p",{children:["Uses npm package ",n.jsx("a",{className:"text-primary",href:"https://github.com/thisandagain/sentiment",children:"sentiment"})," which uses AFINN-165 word list and Emoji ranking to perform sentiment analysis."]})]})}),n.jsxs(je,{children:[n.jsx(Q,{markers:c,showLegends:!0,title:"Sentiment in PRs between team and reviewers",data:[{lines:[{label:"To team",color:E[0],dataKey:"commentSentimentScore",data:t},{label:"From team",color:E[2],dataKey:"commentAuthorSentimentScore",data:t}],xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e}),a.length>0&&n.jsx(n.Fragment,{children:n.jsx(Q,{showLegends:!0,title:"Sentiment in PRs between authors and reviewers",data:[{lines:u,xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore","author"],tableData:e})})]})]})})},wl=e=>({index:t,data:s})=>{const a=e.find(r=>r.area===t),o=s.map(({id:r,color:l})=>[n.jsx(Xa,{color:l},r),r,a[`${r}Original`]]);return n.jsx(Fs,{title:n.jsx("strong",{children:t}),rows:o})},bl=({title:e="",showTitle:t=!0,data:s=[],keys:a=[],colors:o=[],width:r=410,height:l=300})=>{const{theme:c}=G(),i=ot(c),u=V[c].secondary,m=V[c].primary,d=o.length>0?o:[u,m],{showNumbers:g}=at();return On(s,a)&&n.jsxs("div",{children:[t&&n.jsx(qe,{className:"text-center",items:[{label:e,color:m}]}),n.jsx(Ja,{width:r,height:l,margin:{top:0,bottom:0,right:100,left:100},dotSize:8,dotBorderColor:i.dotColor,dotBorderWidth:2,colors:d,gridShape:"linear",enableDotLabel:!1,gridLabelOffset:10,gridLevels:3,animate:!1,indexBy:"area",keys:a,data:s,maxValue:100,theme:i,sliceTooltip:wl(s),isInteractive:g})]})},jl=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0},a=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],r=e.filter(g=>a.some(f=>g[f]>1)).sort(Ne(a)),l=Math.ceil(r.length/100*10),c=l>10?r.slice(0,l):r,i={};c.filter(g=>!t).forEach(g=>{Object.entries(g).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,p])=>{const f=i[h]||0;i[h]=+p+f})});const u=c.length,m={...s,user:"Peers",userCount:u};Object.entries(i).forEach(([g,h])=>{m[g]=Math.round(h/u)}),e.find(g=>g.author===t);const d=s;return e.forEach(g=>{Object.entries(g).filter(([,h])=>!Array.isArray(h)&&/^\d+$/.test(h)&&h>0).forEach(([h,p])=>{const f=d[h]||0,x=+p;d[h]=f>x?f:x})}),{averagedData:m,maxValues:d,users:e,user:{}}},Nl=({maxValues:e={},users:t=[]},s)=>{const a=["commentsGiven","commentsReceived","uniquePRsApproved","totalPRs"],o=s?t:t.sort(Ne(a)).slice(0,6),r=[{area:"Comments received",dataKey:"commentsReceived"},{area:"Comments given",dataKey:"commentsGiven"},{area:"Approved PRs",dataKey:"uniquePRsApproved"},{area:"PR count",dataKey:"totalPRs"},{area:"PR size",dataKey:"prSize"}];return o.map(c=>{const i=r.map(({area:u,dataKey:m})=>{const d=c[m]||0,g=e[m]||0;return{area:u,value:d&&g?d/g*100:0,valueOriginal:d}});return{title:c.author,data:i,keys:["value"]}})},Zn=()=>{const e=D(h=>h.usersData),{userIds:t=[],usersInfo:s={}}=k(_(h=>h)),{theme:a}=G(),{togglePvPPage:o,setUserPage:r}=He(),l=V[a].secondary,c=V[a].primary,{showNames:i}=be(),u=jl(e),m=Nl(u,t.length>0),d=t.length>0,g=d?"Team members":"Top contributors";return m.length>0&&n.jsxs(J,{className:"flex flex-wrap flex-row justify-center",children:[n.jsx(de,{title:g}),m.map((h,p)=>{var v;const f=h.title,x=((v=s[f])==null?void 0:v.name)||f;return n.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[n.jsx(bl,{showTitle:!1,height:240,colors:[(p+1)%2===0?l:c],...h}),n.jsx(O,{variant:(p+1)%2===0?"secondary":void 0,onClick:b=>{b.preventDefault(),r(f),window&&window.scrollTo(0,0)},children:i?x:"Spartacus"})]},p)}),d&&n.jsx(O,{className:"w-full mb-4",color:"primary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"PvP arena"})]})},Pl=()=>{const e=D(o=>o.usersData),{showNames:t}=be(),{togglePvPPage:s,setUserPage:a}=He();return e.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{className:"justify-between",children:[n.jsx(O,{className:"w-full mb-4",color:"primary",onClick:o=>{o.preventDefault(),s(),window&&window.scrollTo(0,0)},children:"PvP arena"}),n.jsx("h3",{className:"w-full",children:"User pages"}),n.jsx("div",{className:"flex flex-wrap justify-between gap-2",children:e.map(({author:o,user:r},l)=>n.jsx(O,{className:"flex-grow",variant:"secondary",onClick:c=>{c.preventDefault(),a(r),window&&window.scrollTo(0,0)},children:t?o:"Spartacus"},`${l}`))})]})})},Rl=()=>{const e=D(s=>s.pullRequests),t=Te(e);return n.jsxs(n.Fragment,{children:[n.jsx(wt,{}),n.jsx(Yt,{pullRequests:e,chunkyData:t}),n.jsx(yt,{pullRequests:e,chunkyData:t,tableOpenedByDefault:!0}),n.jsx(yl,{pullRequests:e,chunkyData:t}),n.jsx(Xn,{pullRequests:e,chunkyData:t}),n.jsx(Jt,{}),n.jsx(Zn,{}),n.jsx(Pl,{})]})},Ds=({player:e="",className:t="",otherPlayer:s,setPlayerId:a,players:o=[]})=>n.jsxs(Be,{value:e,onValueChange:r=>a(r),children:[n.jsx(Ce,{className:`text-3xl w-auto ${t}`,children:n.jsx(Le,{children:e})}),n.jsx(Ae,{children:n.jsx(Fe,{children:o.filter(({author:r})=>r!==s).map(({author:r,name:l})=>n.jsx(te,{value:r,children:l},r))})})]}),ea=({player1:e,player2:t,setPlayer1Id:s=()=>({}),setPlayer2Id:a=()=>({}),players:o=[]})=>{const{theme:r}=G(),l=V[r].secondary,c=V[r].primary,u=[{title:"Total Merged",id:"totalPRs"},{title:"Total approved",id:"uniquePRsApproved"},{title:"Comments given",id:"commentsGiven"},{title:"Comments received",id:"commentsReceived"},{title:"Average positive sentiment",id:"sentimentAveragePositiveScore"},{title:"Average negative sentiment",id:"sentimentAverageNegativeScore"},{title:"Average size",id:"prSize"},{title:"Total additions",id:"prTotalAdditions"},{title:"Total deletions",id:"prTotalDeletions"},{title:"Average days open",id:"age"},{title:"Orgs contributed to",id:"orgCount"},{title:"Repos contributed to",id:"repoCount"}].filter(({id:m})=>Number.isInteger(e[m])&&Number.isInteger(t[m])&&(!["orgCount","repoCount"].includes(m)||["orgCount","repoCount"].includes(m)&&e[m]!==1&&t[m]!==1)).map(m=>{const d=m.id,g=e[d],h=t[d],p=l,f=c,x=Math.ceil(100*g/(g+h)),v=100-x;return{...m,lValue:g,lColor:p,lPercent:x,rValue:h,rColor:f,rPercent:v}});return n.jsxs("div",{className:"w-full flex flex-col items-center basis-full",children:[n.jsx("div",{className:"w-full flex flex-nowrap justify-between mb-4 max-w-mw",children:o.length>0?n.jsxs(n.Fragment,{children:[n.jsx(Ds,{player:e.author,className:"text-secondary",otherPlayer:t.author,setPlayerId:s,players:o}),n.jsx(Ds,{player:t.author,className:"text-primary",otherPlayer:e.author,setPlayerId:a,players:o})]}):n.jsxs(n.Fragment,{children:[n.jsx("h3",{style:{color:l,margin:0},children:e.name}),n.jsx("h3",{style:{color:c,margin:0},children:t.name})]})}),u.map((m,d)=>n.jsxs("div",{className:"w-full relative max-w-mw mb-2",children:[n.jsx("p",{className:"z-[1] absolute w-full top-2 text-center m-0",children:m.title}),n.jsxs("div",{className:"w-full flex flex-nowrap content-stretch justify-between",children:[n.jsx("div",{className:"relative h-9",style:{width:`${m.lPercent}%`,backgroundColor:`${m.lColor}`},children:n.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 left-2 text-left m-0",children:m.lValue})}),n.jsx("div",{className:"relative h-9",style:{width:`${m.rPercent}%`,backgroundColor:`${m.rColor}`},children:n.jsx("p",{className:"z-[1] min-w-3 w-full absolute top-2 right-2 text-right m-0",children:m.rValue})})]},m.id)]},`${m.id}${d}`))]})},Dl=(e,t)=>{const s={age:0,approvalsGiven:0,approvalsReceived:0,codeCommentsGiven:0,codeCommentsReceived:0,commentsGiven:0,commentsReceived:0,generalCommentsGiven:0,generalCommentsReceived:0,prSize:0,prTotalAdditions:0,prTotalDeletions:0,totalPRs:0,uniquePRsApproved:0,uniquePRsContributedTo:0,sentimentAveragePositiveScore:0,sentimentAverageNegativeScore:0,orgCount:0,repoCount:0},a=["commentsGiven","commentsReceived","approvalsGiven","approvalsReceived"],r=e.filter(h=>{const p=h.author!==t,f=a.some(x=>h[x]>1);return p&&f}).sort(Ne(a)),l=Math.ceil(r.length/100*10),c=l>10?r.slice(0,l):r,i={};c.filter(h=>h.author!==t).forEach(h=>{Object.entries(h).filter(([,p])=>!Array.isArray(p)&&/^\d+$/.test(p)&&p>0).forEach(([p,f])=>{const x=i[p]||0;i[p]=+f+x})});const u=c.length,m={...s};Object.entries(i).forEach(([h,p])=>{m[h]=Math.round(p/u)});const d={...m,user:"Peers",name:"Peers"},g=e.find(h=>h.author===t)||{approvalsGivenByTeam:{}};return[{...g,user:g.author,name:g.name||g.author},d,u]},Sl=(e=[],t=[],s,a,o)=>{const r=[],l=[];e.forEach(i=>{const{author:u}=i;u===s?l.push(i):r.push(i)});const c=Te(l);return[{markers:t,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${s} received`,color:E[2],dataKey:"commentSentimentScore",data:l},{label:`${s} given`,color:E[1],dataKey:"commentAuthorSentimentScore",data:l},{label:"Peer received",color:E[4],dataKey:"commentSentimentScore",data:r},{label:"Peer given",color:E[5],dataKey:"commentAuthorSentimentScore",data:r}],xAxis:"left"}],tableKeys:["commentSentimentScore","commentAuthorSentimentScore"],tableData:c},{markers:t,data:[{lines:[{label:"User PR size",color:a,dataKey:"prSize",data:l},{label:"Peer PR size",color:o,dataKey:"prSize",data:r}],xAxis:"left"}],tableKeys:["prSize"],tableData:c},{markers:t,data:[{lines:[{label:"User PR age",color:a,dataKey:"age",data:l},{label:"Peer PR age",color:o,dataKey:"age",data:r}],xAxis:"left"}],tableKeys:["age"],tableData:c}]},Cl=()=>{const e=D(h=>h.pullRequests),t=D(h=>h.releases),s=D(h=>h.usersData),{userPage:a,clearUserPage:o}=He(),{theme:r}=G(),l=V[r].secondary,c=V[r].primary,i=Sl(e,t,a,l,c),[u,m,d]=Dl(s,a),g=u.name||a;return n.jsxs(J,{children:[n.jsx(O,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"Back to main view"}),n.jsxs("p",{className:"w-full text-center",children:["A collection metrics showing ",g,"'s data and average data from the top ",d," peers"]}),n.jsx(ea,{player1:u,player2:m}),i.length&&i.map((h,p)=>n.jsx(Q,{...h},`${p}-${a}`)),n.jsx(O,{className:"w-full mb-4",color:"secondary",onClick:h=>{h.preventDefault(),o(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})},Al=I("",["location","search"],window),ta=new URLSearchParams(Al),Tl=(e=[])=>{var t;return ta.get("player1")||((t=e[0])==null?void 0:t.author)},kl=(e=[])=>{var t;return ta.get("player2")||((t=e[1])==null?void 0:t.author)},Il=()=>{const e=D(y=>y.pullRequests),t=D(y=>y.releases),s=D(y=>y.usersData),{events:a=[],usersInfo:o={}}=k(y=>y),{togglePvPPage:r}=He(),{theme:l}=G(),c=V[l].secondary,i=V[l].primary,[u,m]=j.useState(Tl(s)),[d,g]=j.useState(kl(s)),h=s.find(y=>y.author===u),p=s.find(y=>y.author===d),f=[],x=[],v=[];e.forEach(y=>{const P=y.author;P===u?(f.push(y),v.push(y)):P===d&&(x.push(y),v.push(y))});const b=Te(v),w=ke({events:a,releases:t,usersInfo:o});return s.length>0&&n.jsx(n.Fragment,{children:n.jsxs(J,{children:[n.jsx(O,{className:"w-full mr-0 mb-4",color:"secondary",onClick:y=>{y.preventDefault(),r()},children:"Back to main view"}),n.jsx("p",{className:"w-full text-center",children:"This page is just for fun, a bigger or smaller number could be good, bad or not mean much, it depends on context."}),n.jsx(ea,{player1:h,player2:p,setPlayer1Id:m,setPlayer2Id:g,players:s}),n.jsx("p",{className:"w-full text-center",children:"And the winner is.... Both! Thanks for your great work!"}),n.jsxs(je,{children:[n.jsx(Q,{markers:w,showLegends:!0,title:"Sentiments in PR",data:[{lines:[{label:`${h.name} received`,color:E[0],dataKey:"commentSentimentScore",data:f},{label:`${h.name} given`,color:E[2],dataKey:"commentAuthorSentimentScore",data:f},{label:`${p.name} received`,color:E[0],dataKey:"commentSentimentScore",data:x},{label:`${p.name} given`,color:E[2],dataKey:"commentAuthorSentimentScore",data:x}],xAxis:"left"}],tableData:b,tableKeys:["author","commentSentimentScore","commentAuthorSentimentScore"]}),n.jsx(Q,{markers:w,data:[{lines:[{label:`${h.name} PR size`,color:c,dataKey:"prSize",data:f},{label:`${p.name} PR size`,color:i,dataKey:"prSize",data:x}],xAxis:"left"}],tableKeys:["author","prSize"],tableData:b}),n.jsx(Q,{markers:w,data:[{lines:[{label:`${h.name} PR age`,color:c,dataKey:"age",data:f},{label:`${p.name} PR age`,color:i,dataKey:"age",data:x}],xAxis:"left"}],tableKeys:["author","age"],tableData:b})]}),n.jsx(O,{className:"w-full mr-0 mb-4",color:"secondary",onClick:y=>{y.preventDefault(),r(),window&&window.scrollTo(0,0)},children:"Back to main view"})]})})},Ml=({pullRequests:e=[]})=>{const{events:t=[],usersInfo:s={}}=k(i=>i),a=D(i=>i.releases),{theme:o}=G(),r=V[o].secondary,l=V[o].primary,c=ke({events:t,releases:a,usersInfo:s});return e.length>0&&n.jsxs(J,{children:[n.jsxs(de,{title:"Team's contribution spread",expandText:"guidance",children:[n.jsx("p",{children:"Questions worth asking (with team context):"}),n.jsxs("ul",{children:[n.jsx("li",{children:"Is there a healthy percentage spread?"}),n.jsx("li",{children:"Are the Approval and comments spreads similar?"}),n.jsx("li",{children:"Any insights or things you would like to try to impact these metrics?"})]})]}),n.jsx("p",{children:"Y axis is the percentage spread of approvals and comments within the active team*, 100% is an EVEN spread across the team, 0% is contribution from only ONE engineer."}),n.jsx(je,{children:n.jsx(Q,{title:"Percentage spread within team for ",markers:c,data:[{lines:[{label:"Comments given",color:r,dataKey:"comments",groupMath:"teamDistribution",yMax:100,data:e},{label:"Approvals given",color:l,dataKey:"approvals",groupMath:"teamDistribution",yMax:100,data:e}],xAxis:"left"}]})}),n.jsx("p",{children:"*Active team per data point are those who have approved, commented or raised a PR within that time frame."})]})},El=()=>{const e=D(l=>l.pullRequests),t=k(l=>l.userIds),s=l=>{const c={};return t.forEach(i=>{const u=l==null?void 0:l[i];u&&(c[i]=u)}),c},a={},o=e.map(l=>(a[l.repo]=(a[l.repo]||0)+1,Object.assign(l,{teamApprovers:s(l.approvers),teamCommenters:s(l.commenters)}))),r=Te(o);return n.jsxs(n.Fragment,{children:[n.jsx(wt,{}),n.jsx(Ml,{pullRequests:o}),n.jsx(yt,{pullRequests:o,chunkyData:r,tableOpenedByDefault:!0}),n.jsx(Yt,{pullRequests:o,chunkyData:r,allRepos:a}),n.jsx(Jt,{}),n.jsx(Zn,{})]})},$l=()=>{const{usersInfo:e={},userIds:t=[]}=k(w=>w),s=D(w=>w.pullRequests),a=D(w=>w.reviewedPullRequests),[o]=t,{showNames:r}=be(),{theme:l}=G(),c=V[l].secondary,i=V[l].primary,u={},m={},d={};s.forEach(w=>{const y=w.commenters||{};Object.keys(y).forEach(N=>{const T=y[N]||0;d[N]||(d[N]={}),d[N].commentsReceived=(d[N].commentsReceived||0)+T});const P=w.approvers||{};Object.keys(P).forEach(N=>{const T=P[N]||0;d[N]||(d[N]={}),d[N].approvalsReceived=(d[N].approvalsReceived||0)+T}),u[w.repo]=(u[w.repo]||0)+1,m[w.org]=(m[w.org]||0)+1});const g={...e};a.map(w=>{var T,S;const y=w.author;g[y]={userId:y};const P=((T=w==null?void 0:w.commenters)==null?void 0:T[o])||0,N=((S=w==null?void 0:w.approvers)==null?void 0:S[o])||0;d[y]||(d[y]={}),d[y].commentsGiven=(d[y].commentsGiven||0)+P,d[y].approvalsGiven=(d[y].approvalsGiven||0)+N});const h=Object.entries(d).map(([w,y],P)=>{var N;return{...y,author:r?w:`${Array(P).fill(" ").join("")}Spartacus`,name:r?((N=e[w])==null?void 0:N.name)||w:`${Array(P).fill(" ").join("")}Spartacus`}}),p=vt(s.concat(a),g,o),f=["commentsGiven","approvalsGiven"],x=p.sort(Ne(f)),v=Te(s),b=fn("repo",u);return n.jsxs(n.Fragment,{children:[n.jsx(wt,{}),n.jsx(J,{children:n.jsxs(je,{children:[n.jsxs("div",{className:"flex flex-wrap justify-center w-full",children:[n.jsx(ut,{data:h,indexBy:"name",title:"Comments",sortBy:"commentsGiven",bars:[{dataKey:"commentsGiven",color:c,label:"given"},{dataKey:"commentsReceived",color:i,label:"received"}]}),n.jsx(ut,{data:h,indexBy:"name",title:"Approvals",sortBy:"approvalsGiven",bars:[{dataKey:"approvalsGiven",color:c,label:"given"},{dataKey:"approvalsReceived",color:i,label:"received"}]})]}),n.jsxs("div",{className:"w-full flex flex-wrap justify-center gap-4",children:[n.jsx(ht,{data:x,preSorted:!0,dataKey:"commentsByUser",title:"Comment contributions"}),n.jsx(ht,{data:x,preSorted:!0,dataKey:"approvalsByUser",title:"Approval contributions"})]}),b.pieData.length>0&&n.jsx(Bn,{data:b.pieData,title:b.sectionTitle})]})}),n.jsx(yt,{pullRequests:s,chunkyData:v,tableOpenedByDefault:!0}),n.jsx(Jt,{})]})},Ol=()=>{const{showPvP:e,userPage:t}=He(),s=!!(t&&t.length>0),a=e||s,o=k(r=>r.reportType);return n.jsxs("div",{children:[e&&n.jsx(Il,{}),s&&n.jsx(Cl,{}),!a&&o==="team"&&n.jsx(El,{}),!a&&o==="user"&&n.jsx($l,{}),!a&&o==="org"&&n.jsx(xl,{}),!a&&o==="repo"&&n.jsx(Rl,{})]})},Bl=()=>{const{toggleTheme:e}=G();return n.jsxs("div",{className:"grow self-center flex flex-nowrap justify-end gap-x-2 mr-2",children:[n.jsx("a",{className:"hover:text-primary",href:"https://bsky.app/profile/chris-n07734.bsky.social",children:n.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"BlueSkyIcon",children:n.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"})})}),n.jsx("a",{className:"hover:text-primary",href:"https://github.com/n07734/community-health",children:n.jsx("svg",{className:"h-6 w-6 fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"GitHubIcon",children:n.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"})})}),n.jsxs("a",{href:"#theme",onClick:t=>{t.preventDefault(),e()},className:"theme-icon hover:text-primary",children:[n.jsx("svg",{className:"h-6 w-6 sun fill-current dark:display-none",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"SunnyIcon",children:n.jsx("path",{d:"m6.76 4.84-1.8-1.79-1.41 1.41 1.79 1.79zM4 10.5H1v2h3zm9-9.95h-2V3.5h2zm7.45 3.91-1.41-1.41-1.79 1.79 1.41 1.41zm-3.21 13.7 1.79 1.8 1.41-1.41-1.8-1.79zM20 10.5v2h3v-2zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6m-1 16.95h2V19.5h-2zm-7.45-3.91 1.41 1.41 1.79-1.8-1.41-1.41z"})}),n.jsx("svg",{className:"h-6 w-6 moon fill-current",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-qa-id":"MoonIcon",children:n.jsx("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54 0 4.48-2.94 8.27-7 9.54.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2"})})]})]})},sa=Ys,na=Qs,aa=Vt,Fl=Ws,oa=j.forwardRef(({className:e,...t},s)=>n.jsx(gt,{className:C("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));oa.displayName=gt.displayName;const Ll=Lt("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Xt=j.forwardRef(({side:e="right",className:t,children:s,...a},o)=>n.jsxs(Fl,{children:[n.jsx(oa,{}),n.jsxs(ze,{ref:o,className:C(Ll({side:e}),t),...a,children:[s,n.jsxs(Vt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[n.jsx(Za,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Xt.displayName=ze.displayName;const Zt=({className:e,...t})=>n.jsx("div",{className:C("flex flex-col space-y-2 text-center sm:text-left",e),...t});Zt.displayName="SheetHeader";const es=j.forwardRef(({className:e,...t},s)=>n.jsx(pt,{ref:s,className:C("text-lg font-semibold text-foreground",e),...t}));es.displayName=pt.displayName;const ra=j.forwardRef(({className:e,...t},s)=>n.jsx(ft,{ref:s,className:C("text-sm text-muted-foreground",e),...t}));ra.displayName=ft.displayName;const Vl=[["Individual report","user"],["Team report","team"],["Repo report","repo"],["Org report","org"]],Kl=({setNewReportType:e})=>n.jsxs(sa,{children:[n.jsx(na,{asChild:!0,children:n.jsx(O,{variant:"link",className:"normal-case text-report-title hover:text-primary text-base",children:"Make a report"})}),n.jsxs(Xt,{className:"bg-background",children:[n.jsxs(Zt,{children:[n.jsx(es,{children:"Make a report"}),n.jsx(ra,{children:"Choose the type of report you want to make"})]}),n.jsx("div",{children:Vl.map(([t,s],a)=>n.jsx(aa,{asChild:!0,children:n.jsx(O,{className:"text-xl normal-case mr-2 mb-3 w-full",variant:"secondary",onClick:()=>{const o=new URL(window.location.href);o.searchParams.delete("report"),history.pushState(null,"",o),In(),e(s)},children:t})},`${a}`))})]})]}),Ft=[],la=[{name:"React",fileName:"facebook-react"},{name:"NextJS",fileName:"vercel-next.js"},{name:"Remix",fileName:"remix-run-remix"},{name:"Vue",fileName:"vuejs-core"},{name:"Svelte",fileName:"sveltejs-svelte"},{name:"Typescript",fileName:"microsoft-typescript"},{name:"Typescript 10th anniversary",fileName:"microsoft-typescript-10"},{name:"MSW",fileName:"mswjs-msw"},{name:"SWC",fileName:"swc-project-swc"},{name:"vscode",fileName:"microsoft-vscode"},{name:"Node",fileName:"nodejs-node"},{name:"Bluesky",fileName:"bluesky-social-social-app"}],ca=[{name:"Vite",fileName:"vitejs"},{name:"testing-library",fileName:"testing-library"},{name:"TanStack",fileName:"TanStack"}],ia=[{name:"ReactCore",fileName:"ReactCore"},{name:"ViteCore",fileName:"ViteCore"},{name:"TypeScriptCore",fileName:"TypeScriptCore"}],ql=[{name:"Theo",fileName:"t3dotgg"},{name:"Daniel Roe",fileName:"danielroe"},{name:"Kent",fileName:"kentcdodds"},{name:"Hailey",fileName:"haileyok"},{name:"shadcn",fileName:"shadcn"},{name:"Dominik",fileName:"tkdodo"},{name:"Tyler",fileName:"coolsoftwaretyler"}],Gl=[{name:"Vite",fileName:"vitejs"},{name:"Vitest",fileName:"vitest-dev-vitest"},{name:"Playwright",fileName:"microsoft-playwright"},{name:"Astro",fileName:"withastro-astro"},{name:"PNPM",fileName:"pnpm-pnpm"},{name:"esbuild",fileName:"evanw-esbuild"},{name:"Testing Library",fileName:"testing-library"},{name:"SvelteKit",fileName:"sveltejs-kit"}],Ul=({setNewReportType:e})=>{const t=D(_(a=>a.preFetchedName)),s=(a,o=1)=>n.jsx(aa,{asChild:!0,children:n.jsx(O,{className:"mr-2 mb-3","data-qa-id":`prefetch-${a.name}`,variant:t===a.fileName?void 0:"secondary",onClick:()=>{const r=new URL(window.location.href);r.searchParams.set("report",a.fileName),history.pushState(null,"",r),e(""),Ot(a)},children:(a==null?void 0:a.name)||"Report"})},`${o}`);return n.jsxs(sa,{children:[n.jsx(na,{asChild:!0,children:n.jsx(O,{variant:"link",className:"normal-case text-foreground hover:text-primary text-base",children:"Other reports"})}),n.jsxs(Xt,{className:"bg-background overflow-scroll",children:[n.jsx(Zt,{children:n.jsx(es,{children:"See a different report"})}),n.jsxs("div",{className:"mb-4",children:[Ft.map(s),n.jsxs("div",{children:[n.jsxs("p",{children:[n.jsx("a",{className:"text-primary",href:"https://2024.stateofjs.com/en-US/libraries/#tier_list",children:"StateOfJS 24"})," S tier list"]}),Gl.map(s)]}),n.jsx("p",{children:"Other reports"}),n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"Repository reports"}),la.map(s),n.jsx("p",{children:"Org reports"}),ca.map(s),n.jsx("p",{children:"Team reports"}),ia.map(s),n.jsx("p",{children:"Individual reports"}),ql.map(s)]})]})]})]})},zl=()=>{var p,f;const e=D(_(x=>x.preFetchedName)),t=k(x=>x.error),{togglePvPPage:s,setUserPage:a}=He(),o=(p=window==null?void 0:window.location)==null?void 0:p.search,r=new URLSearchParams(o),l=r.get("player1")||"",c=r.get("player2")||"",i=r.get("user")||"",u=[...Ft,...la,...ia,...ca],d=r.get("report")||((f=Ft[0])==null?void 0:f.fileName)||"bluesky-social-social-app",h=u.some(x=>x.fileName===d)?u.find(x=>x.fileName===(e||d)):{fileName:d};return j.useEffect(()=>{Ot(h),l&&c?s():i&&a(i)},[Ot,l,c,i]),n.jsx(n.Fragment,{children:t&&t.message&&n.jsx(Qt,{error:t,className:"col-span-full mb-4"})})},Hl=({reportType:e="repo"})=>{const t=k(b=>b),{fetching:s=!1}=t,o={repo:"Get community data for any repo",team:"Get community data for any Team(list of users)",user:"Get data for an individual",org:"Get community data for any Org"}[e],c={sortDirection:"DESC",amountOfData:1,token:"",excludeIds:"",enterpriseAPI:"",events:"",...{repo:{reportType:"repo",org:"",repo:""},org:{reportType:"org",org:""},team:{reportType:"team",usersInfo:{},teamName:""},user:{reportType:"user",userId:"",name:""}}[e]},[i,u]=j.useState({}),[m,d]=j.useState(c),g=(b={})=>{const w={...m,...b};d(w)};j.useEffect(()=>{d(c)},[e,d]);const h=(b,w)=>d({...m,[b]:w}),p={inputError:i,setInputError:u,formInfo:m,setValue:h},f=b=>{b.preventDefault();const{isValid:w,validationErrors:y}=Un(m);if(u(y),!s&&w){const P=$n(m);kn({...t,...P})}},v={repo:[{type:"org"},{type:"repo"}],org:[{type:"org",className:"col-span-full"}],team:[{type:"teamName",className:"col-span-full"}],user:[{type:"userId"},{type:"name"}]}[e];return n.jsxs("div",{className:"mb-3",children:[n.jsx("h3",{children:o}),n.jsxs("form",{onSubmit:f,children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-start",children:[v.map(b=>n.jsx(Y,{className:b.className,type:b.type,...p},b.type)),m.reportType==="team"&&n.jsx(Qn,{usersInfo:m.usersInfo,setParentValues:g}),n.jsx(Y,{className:"col-span-full",type:"events",...p}),n.jsx("p",{className:"col-span-full",children:"Key events can give context when viewing the data e.g. started using copilot, launched a feature. These events can help give more context while viewing the data. e.g.  Copilot adopted=2024-02-01,Feature A=2024-04-10."}),n.jsx(Y,{type:"token",...p}),n.jsx(Vn,{className:"mb-3 max-mm:mb-0 self-end",setValue:h,amountOfData:m.amountOfData}),n.jsxs("p",{className:"col-span-full",children:["To create a token go to your GitHub ",n.jsx("a",{className:"text-primary",href:"https://github.com/settings/tokens",children:"tokens"})," page, click on 'generate new token', choose the settings 'repo' (all), 'read:org' and 'user' then click 'Generate token'."]})]}),n.jsx(de,{className:"mb-0 col-span-full",expandText:"show",intro:"Advanced options",children:n.jsxs("div",{className:"grid grid-cols-2 gap-2 max-mm:grid-cols-1 items-end",children:[n.jsx(Y,{type:"excludeIds",...p}),n.jsx(Y,{type:"enterpriseAPI",...p})]})}),n.jsx(Ln,{})]}),n.jsx(_n,{})]})},Wl=()=>{const[e,t]=j.useState("");return n.jsxs("div",{className:"p-0 overflow-auto",children:[n.jsxs("header",{children:[n.jsxs("nav",{className:"w-full flex flex-wrap",children:[n.jsx(Ul,{setNewReportType:t}),n.jsx(Kl,{setNewReportType:t}),n.jsx(Bl,{})]}),"  ",n.jsx(J,{children:n.jsxs(de,{title:"Code Health",hLevel:1,expandText:"more",children:[n.jsx("p",{children:"Coding is a team activity, healthy collaboration produces better code. This tool gives in depth collaboration and contribution metrics for teams to analyze their code health."}),n.jsx("p",{children:"You can create your own reports for individuals, teams, repos and orgs from public or enterprise GitHub."})]})})]}),n.jsx(zl,{}),e!==""&&n.jsx(J,{className:"block",children:n.jsx(Hl,{reportType:e})}),n.jsx(Ol,{})]})},bt=j.forwardRef(({className:e,value:t,...s},a)=>n.jsx(Js,{ref:a,className:C("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:n.jsx(eo,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));bt.displayName=Js.displayName;const Yl=({userIds:e,user:t})=>{const s=t?e.findIndex(l=>l===t):0,a=s>0?e.slice(0,s):[],o=100/(e.length||10),r=s*o;return n.jsxs(n.Fragment,{children:[n.jsxs(We,{className:"text-6xl font-extralight mb-08",children:["Fetching ",s+1," of ",e.length," ",e.length===1?"user":"users"]}),n.jsx(bt,{value:r}),a.length>0&&n.jsxs("p",{children:["Fetched users: ",a.join(", ")]})]})},Ql=({repo:e,repos:t,loadedPercent:s,prCount:a,issueCount:o})=>{const r=e?t.findIndex(c=>c===e):0,l=r>0?t.slice(0,r):[];return n.jsxs(n.Fragment,{children:[n.jsxs(We,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e})]}),n.jsx(bt,{value:s}),n.jsxs("h3",{children:[a," Pull Requests"]}),n.jsxs("h3",{children:[o," Issues"]}),l.length>0&&n.jsxs("p",{children:["Fetched repos: ",l.join(", ")]})]})},Ss=({user:e,repo:t,loadedPercent:s,prCount:a,issueCount:o})=>n.jsxs(n.Fragment,{children:[n.jsxs(We,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e||t})]}),n.jsx(bt,{value:s}),n.jsxs("h3",{children:[a," Pull Requests"]}),n.jsxs("h3",{children:[o," Issues"]})]}),_l=({savedReportName:e})=>n.jsxs(We,{className:"text-6xl font-extralight mb-08",children:["Fetching ",n.jsx("span",{className:"text-primary",children:e})]}),Jl={team:Yl,user:Ss,repo:Ss,org:Ql,saved:_l},Xl=()=>{const{fetching:e=!1,fetchStatus:t={},userIds:s=[],sortDirection:a="",formUntilDate:o=""}=k(B=>B),r=D(B=>B.pullRequests),{user:l="",repo:c="",repos:i=[],savedReportName:u="",prCount:m=0,latestItemDate:d="",issueCount:g=0,paused:h=!1}=t,p=u&&"saved"||s.length>1&&"team"||s.length===1&&"user"||i.length>1&&"org"||"repo",f=(B,H)=>a==="DESC"?he(B,H):he(H,B),x=a==="DESC"?0:-1,v=r.length>0?new Date(r.at(x).mergedAt):new Date,b=d?new Date(d):v,w=new Date(o),y=f(v,w),P=f(v,b),N=100/(y||10),T=P*N,S=Jl[p];return e&&n.jsx(zn,{open:!0,children:n.jsxs(Yn,{"aria-describedby":void 0,"data-qa-id":"loader",className:"overflow-scroll max-h-full w-4/5",children:[h&&n.jsx("p",{children:" Fetching paused briefly due to Github api throttling."}),n.jsx(S,{userIds:s,user:l,repo:c,repos:i,prCount:m,issueCount:g,savedReportName:u,loadedPercent:T})]})})};class Zl extends j.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,s){console.error("Uncaught error:",t,s)}render(){return this.state.hasError?n.jsx("h1",{className:"text-center mt-4",children:"Something went wrong."}):this.props.children}}const ec=()=>n.jsx(Zl,{children:n.jsxs(lo,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[n.jsx(Xl,{}),n.jsx(Wl,{})]})});to.createRoot(document.getElementById("root")).render(n.jsx(so.StrictMode,{children:n.jsx(no,{children:n.jsx(ao,{children:n.jsx(oo,{children:n.jsx(ec,{})})})})}));
